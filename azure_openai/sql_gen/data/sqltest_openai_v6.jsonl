{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount applied to orders each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(orders.OrderDate, '%Y-%m') AS month, AVG([Order Details].Discount) AS avg_discount FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY month"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city had the highest number of orders placed?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipCity ORDER BY OrderCount DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Who are the top 5 employees in terms of total sales revenue?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID ORDER BY TotalSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers have products with zero stock available?"}, {"role": "assistant", "content": "SELECT s.SupplierID, s.CompanyName FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID WHERE p.UnitsInStock = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of sales per city?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS TotalSales FROM orders GROUP BY ShipCity;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers have received the largest discounts?"}, {"role": "assistant", "content": "SELECT c.CustomerID, MAX(od.Discount) AS MaxDiscount FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID ORDER BY MaxDiscount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers have placed more than ten orders?"}, {"role": "assistant", "content": "SELECT CustomerID FROM orders GROUP BY CustomerID HAVING COUNT(OrderID) > 10;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the customer lifetime value of each customer?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average number of products ordered per order?"}, {"role": "assistant", "content": "SELECT AVG(OrderQuantity) AS AvgProductsPerOrder FROM (SELECT OrderID, COUNT(ProductID) AS OrderQuantity FROM [Order Details] GROUP BY OrderID) AS OrderCounts;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the top 5 products with the highest sales revenue."}, {"role": "assistant", "content": "SELECT [Order Details].ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS product_sales FROM [Order Details] GROUP BY [Order Details].ProductID ORDER BY product_sales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were not shipped at all?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM orders WHERE ShippedDate IS NULL"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify orders that were shipped late and the shipping method used."}, {"role": "assistant", "content": "SELECT OrderID, ShipVia FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product category generates the most revenue?"}, {"role": "assistant", "content": "SELECT od.ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS Revenue FROM [Order Details] od GROUP BY od.ProductID ORDER BY Revenue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers have delivered discontinued products?"}, {"role": "assistant", "content": "SELECT DISTINCT suppliers.CompanyName FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID WHERE products.Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the revenue generated from each product?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, SUM(od.Quantity * od.UnitPrice) AS Revenue FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many products are currently being discontinued?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM products WHERE Discontinued = 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average shipping cost per order for each shipper?"}, {"role": "assistant", "content": "SELECT shippers.CompanyName, AVG(orders.Freight) AS avg_shipping_cost FROM orders JOIN shippers ON orders.ShipVia = shippers.ShipperID GROUP BY shippers.CompanyName"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which category has the longest list of discontinued products?"}, {"role": "assistant", "content": "SELECT c.CategoryID, COUNT(p.ProductID) AS DiscontinuedCount FROM products p JOIN categories c ON p.CategoryID = c.CategoryID WHERE p.Discontinued = 1 GROUP BY c.CategoryID ORDER BY DiscontinuedCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average unit price of all products?"}, {"role": "assistant", "content": "SELECT AVG(UnitPrice) FROM products"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers have placed orders with the highest discounts?"}, {"role": "assistant", "content": "SELECT o.CustomerID, MAX(od.Discount) AS MaxDiscount FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.CustomerID ORDER BY MaxDiscount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have sales exceeding $5000?"}, {"role": "assistant", "content": "SELECT ProductName FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY ProductName HAVING SUM([Order Details].Quantity * [Order Details].UnitPrice) > 5000;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total discount given on products sold in the last month."}, {"role": "assistant", "content": "SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice * [Order Details].Discount) AS TotalDiscount FROM [Order Details] WHERE OrderID IN (SELECT OrderID FROM orders WHERE OrderDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND CURDATE());"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which company name appears most frequently in the customer database?"}, {"role": "assistant", "content": "SELECT CompanyName, COUNT(*) AS Frequency FROM customers GROUP BY CompanyName ORDER BY Frequency DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 5 cities by number of shipments?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS Shipments FROM orders GROUP BY ShipCity ORDER BY Shipments DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the stock-to-sale ratio for each product?"}, {"role": "assistant", "content": "SELECT ProductName, UnitsInStock * 1.0 / SUM([Order Details].Quantity) AS StockToSaleRatio FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify products with the highest discount offered historically."}, {"role": "assistant", "content": "SELECT ProductID, MAX(Discount) AS MaxDiscount FROM [Order Details] GROUP BY ProductID ORDER BY MaxDiscount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Evaluate the impact of hiring date on the sales performance."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, YEAR(employees.HireDate) AS HireYear, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID, YEAR(employees.HireDate)"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the average unit price of products supplied by each supplier."}, {"role": "assistant", "content": "SELECT s.SupplierID, AVG(p.UnitPrice) AS AvgUnitPrice FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID GROUP BY s.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the top 5 suppliers by total sales revenue generated."}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, CompanyName, SUM([Order Details].UnitPrice * Quantity * (1 - Discount)) AS TotalSales FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY suppliers.SupplierID, CompanyName ORDER BY TotalSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped via each shipping company?"}, {"role": "assistant", "content": "SELECT shippers.CompanyName, COUNT(orders.OrderID) AS order_count FROM orders JOIN shippers ON orders.ShipVia = shippers.ShipperID GROUP BY shippers.CompanyName"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the top 5 products with the highest sales performance based on quantity sold."}, {"role": "assistant", "content": "SELECT p.ProductID, SUM(od.Quantity) AS TotalQuantitySold FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductID ORDER BY TotalQuantitySold DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the most common discount rates used."}, {"role": "assistant", "content": "SELECT Discount, COUNT(*) AS Count FROM [Order Details] GROUP BY Discount ORDER BY Count DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping company has the highest average delay in delivery?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(DATEDIFF(ShippedDate, RequiredDate)) AS AverageDelay FROM orders WHERE ShippedDate > RequiredDate GROUP BY ShipVia ORDER BY AverageDelay DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have been discontinued but still have stock available?"}, {"role": "assistant", "content": "SELECT ProductName, UnitsInStock FROM products WHERE Discontinued = 1 AND UnitsInStock > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total freight cost for all orders shipped to the USA."}, {"role": "assistant", "content": "SELECT SUM(Freight) AS TotalFreightCost FROM orders WHERE ShipCountry = 'USA';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product has the highest number of units on order?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.UnitsOnOrder FROM products p ORDER BY p.UnitsOnOrder DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping method is used the most?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(*) AS UsageCount FROM orders GROUP BY ShipVia ORDER BY UsageCount DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have the highest quantities on order?"}, {"role": "assistant", "content": "SELECT ProductName, UnitsOnOrder FROM products ORDER BY UnitsOnOrder DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have the highest sales quantity this month?"}, {"role": "assistant", "content": "SELECT products.ProductID, products.ProductName, SUM([Order Details].Quantity) AS TotalQuantity FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID WHERE DATE_FORMAT(OrderDate, '%Y-%m') = DATE_FORMAT(CURDATE(), '%Y-%m') GROUP BY products.ProductID, products.ProductName ORDER BY TotalQuantity DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the product-wise breakdown of Total Sales for this year?"}, {"role": "assistant", "content": "SELECT od.ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS ProductSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE YEAR(o.OrderDate) = YEAR(CURRENT_DATE) GROUP BY od.ProductID ORDER BY ProductSales DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which region has the highest number of orders?"}, {"role": "assistant", "content": "SELECT ShipRegion, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipRegion ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List the suppliers with products that are consistently ordered."}, {"role": "assistant", "content": "SELECT suppliers.CompanyName FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY suppliers.CompanyName HAVING COUNT(DISTINCT [Order Details].OrderID) > 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the products that are provided by multiple suppliers."}, {"role": "assistant", "content": "SELECT P.ProductName FROM products P JOIN (SELECT ProductID FROM products GROUP BY ProductID HAVING COUNT(DISTINCT SupplierID) > 1) AS MultiSupplier ON P.ProductID = MultiSupplier.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the average sales per order for each employee?"}, {"role": "assistant", "content": "SELECT E.EmployeeID, AVG(OD.UnitPrice * OD.Quantity * (1 - OD.Discount)) AS AverageSalesPerOrder FROM employees E JOIN orders O ON E.EmployeeID = O.EmployeeID JOIN [Order Details] OD ON O.OrderID = OD.OrderID GROUP BY E.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the total number of customers who have never placed an order."}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) AS NeverOrdered FROM customers WHERE CustomerID NOT IN (SELECT DISTINCT CustomerID FROM orders);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders include a discount greater than 20%?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT [Order Details].OrderID) AS HighDiscountOrders FROM [Order Details] WHERE [Order Details].Discount > 0.2;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have less than 10 units in stock and need reordering?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock < 10 AND UnitsInStock <= ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average shipping cost per order in 2023?"}, {"role": "assistant", "content": "SELECT AVG(orders.Freight) AS avg_shipping_cost_per_order FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find any correlation between the employees' hire date and their performance in sales."}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.HireDate, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, e.HireDate ORDER BY TotalSales DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the average unit price of all products per supplier."}, {"role": "assistant", "content": "SELECT s.CompanyName, AVG(p.UnitPrice) AS AvgUnitPrice FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID GROUP BY s.CompanyName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the correlation between employee hire date and total sales."}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales, YEAR(CURDATE()) - YEAR(e.HireDate) AS YearsSinceHire FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of orders were delivered on time this month?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) FILTER (WHERE ShippedDate <= RequiredDate) * 100.0 / COUNT(OrderID) FROM orders WHERE OrderDate >= DATE_TRUNC('month', CURRENT_DATE);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers are located in 'USA' and how many products do they supply?"}, {"role": "assistant", "content": "SELECT CompanyName, COUNT(ProductID) FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID WHERE Country = 'USA' GROUP BY CompanyName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee has the most orders shipped on time?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, COUNT(orders.OrderID) AS OnTimeOrders FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID WHERE orders.ShippedDate <= orders.RequiredDate GROUP BY employees.EmployeeID ORDER BY OnTimeOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which are the top 5 products by sales revenue?"}, {"role": "assistant", "content": "SELECT [Order Details].ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS ProductSales FROM [Order Details] GROUP BY [Order Details].ProductID ORDER BY ProductSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the average fulfillment time for shipped orders."}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_fulfillment_time FROM orders WHERE orders.ShippedDate IS NOT NULL"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What was the most common order month for new customers?"}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM o.OrderDate) AS OrderMonth, COUNT(o.CustomerID) AS NewCustomerCount FROM orders o JOIN customers c ON o.CustomerID = c.CustomerID WHERE o.OrderDate = c.RegisterDate GROUP BY OrderMonth ORDER BY NewCustomerCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the customer lifetime value for customers in the USA?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID WHERE customers.Country = 'USA' GROUP BY customers.CustomerID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product has the highest total sales revenue?"}, {"role": "assistant", "content": "SELECT ProductName FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY ProductName ORDER BY SUM([Order Details].Quantity * [Order Details].UnitPrice) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of orders have a shipping address in the 'California' region?"}, {"role": "assistant", "content": "SELECT (COUNT(OrderID) FILTER (WHERE ShipRegion = 'California') * 100.0 / COUNT(OrderID)) AS PercentageInCalifornia FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers provide products that have been ordered more than 100 times?"}, {"role": "assistant", "content": "SELECT SupplierID FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY SupplierID HAVING COUNT(od.ProductID) > 100;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping method had the highest number of delays in the last quarter?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(*) AS Delays FROM orders WHERE ShippedDate > RequiredDate AND TO_CHAR(OrderDate, 'YYYY-Q') = TO_CHAR(DATE_TRUNC('quarter', CURRENT_DATE) - INTERVAL '3 months', 'YYYY-Q') GROUP BY ShipVia ORDER BY Delays DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Analyze the impact of employee birth month on sales performance."}, {"role": "assistant", "content": "SELECT e.EmployeeID, MONTH(e.BirthDate) AS BirthMonth, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, MONTH(e.BirthDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost for each shipping country?"}, {"role": "assistant", "content": "SELECT orders.ShipCountry, SUM(orders.Freight) AS TotalFreight FROM orders GROUP BY orders.ShipCountry"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What was the average order value each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', orders.OrderDate) AS Month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS AverageOrderValue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY DATE_TRUNC('month', orders.OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average shipping cost per order for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(Freight) AS AvgShippingCost FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the top 5 customers by order count."}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(*) AS OrderCount FROM orders GROUP BY CustomerID ORDER BY OrderCount DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average time taken from order placement to shipment for each employee?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS AverageShippingTime FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID GROUP BY employees.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers deliver products to the most diverse set of countries?"}, {"role": "assistant", "content": "SELECT s.SupplierID, COUNT(DISTINCT o.ShipCountry) AS CountryCount FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY s.SupplierID ORDER BY CountryCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has the highest number of supplier contacts?"}, {"role": "assistant", "content": "SELECT City, COUNT(ContactName) AS ContactCount FROM suppliers GROUP BY City ORDER BY ContactCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many products have a stock higher than their reorder level?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM products WHERE UnitsInStock > ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders has each employee processed?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, COUNT(orders.OrderID) AS OrderCount FROM employees LEFT JOIN orders ON employees.EmployeeID = orders.EmployeeID GROUP BY employees.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Discover products sold in quantities exceeding 1000 units per month."}, {"role": "assistant", "content": "SELECT p.ProductName FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductName HAVING SUM(od.Quantity) > 1000;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which country had the highest average order value last year?"}, {"role": "assistant", "content": "SELECT Country, AVG(TotalOrderValue) AS AverageOrderValue FROM (SELECT orders.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalOrderValue, customers.Country FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID JOIN customers ON orders.CustomerID = customers.CustomerID WHERE OrderDate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY orders.OrderID, customers.Country) AS CountryOrderAverages GROUP BY Country ORDER BY AverageOrderValue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales revenue for each product?"}, {"role": "assistant", "content": "SELECT P.ProductName, SUM(OD.Quantity * OD.UnitPrice) AS TotalRevenue FROM [Order Details] OD JOIN products P ON OD.ProductID = P.ProductID GROUP BY P.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has the highest number of unique customers?"}, {"role": "assistant", "content": "SELECT City, COUNT(DISTINCT CustomerID) AS UniqueCustomers FROM customers GROUP BY City ORDER BY UniqueCustomers DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many distinct products are ordered in each country?"}, {"role": "assistant", "content": "SELECT Country, COUNT(DISTINCT [Order Details].ProductID) AS DistinctProducts FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY Country;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify employees who have never handled an order in a specific region."}, {"role": "assistant", "content": "SELECT employees.EmployeeID FROM employees WHERE NOT EXISTS (SELECT 1 FROM orders WHERE orders.EmployeeID = employees.EmployeeID AND orders.ShipRegion = 'SpecificRegion')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average fulfillment time for orders shipped in the last month?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders WHERE ShippedDate BETWEEN DATEADD(MONTH, -1, CURRENT_DATE) AND CURRENT_DATE"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers provide the most products by quantity?"}, {"role": "assistant", "content": "SELECT s.SupplierID, SUM(od.Quantity) AS TotalQuantity FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.SupplierID ORDER BY TotalQuantity DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the sales trend over the last 6 months for each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) as TotalSales, EXTRACT(MONTH FROM o.OrderDate) as SalesMonth FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATEADD(MONTH, -6, CURRENT_DATE) GROUP BY e.EmployeeID, SalesMonth ORDER BY e.EmployeeID, SalesMonth;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount given on orders?"}, {"role": "assistant", "content": "SELECT AVG(Discount) AS AverageDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product has the most units on order?"}, {"role": "assistant", "content": "SELECT products.ProductID, products.ProductName, products.UnitsOnOrder FROM products ORDER BY products.UnitsOnOrder DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Are there any suppliers with discontinued products only?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID GROUP BY suppliers.SupplierID HAVING COUNT(products.ProductID) = COUNT(CASE WHEN products.Discontinued = 1 THEN 1 END);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the percentage of orders that were shipped late?"}, {"role": "assistant", "content": "SELECT (COUNT(*) FILTER (WHERE ShippedDate > RequiredDate)::FLOAT / COUNT(*)) * 100 AS LateShipmentPercentage FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the average shipping time for orders handled by each employee."}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AvgShippingTime FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.ShippedDate IS NOT NULL GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which orders have a discount greater than 20% and who manages them?"}, {"role": "assistant", "content": "SELECT o.OrderID, e.FirstName, e.LastName FROM orders o JOIN employees e ON o.EmployeeID = e.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE od.Discount > 0.2;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city received the most shipments?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS Shipments FROM orders GROUP BY ShipCity ORDER BY Shipments DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of different products sold to date?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT ProductID) AS UniqueProductsSold FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which month had the highest total sales revenue this year?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', o.OrderDate) AS Month, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE EXTRACT(YEAR FROM o.OrderDate) = EXTRACT(YEAR FROM CURRENT_DATE) GROUP BY Month ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the top 5 customers with the highest spending."}, {"role": "assistant", "content": "SELECT o.CustomerID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSpent FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.CustomerID ORDER BY TotalSpent DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city receives the most shipments?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(*) AS Shipments FROM orders GROUP BY ShipCity ORDER BY Shipments DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many products have never been ordered?"}, {"role": "assistant", "content": "SELECT COUNT(products.ProductName) FROM products LEFT JOIN [Order Details] ON products.ProductID = [Order Details].ProductID WHERE [Order Details].ProductID IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the total number of products that are overstocked."}, {"role": "assistant", "content": "SELECT COUNT(*) AS OverstockedCount FROM products WHERE UnitsInStock > (ReorderLevel + UnitsOnOrder);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total sales for each product."}, {"role": "assistant", "content": "SELECT ProductID, SUM(UnitPrice * Quantity * (1 - Discount)) AS TotalSales FROM [Order Details] GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Analyze the correlation between unit price and units ordered for the products."}, {"role": "assistant", "content": "SELECT p.ProductName, CORR(p.UnitPrice, od.Quantity) AS PriceQuantityCorrelation FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers have shipped orders on time this year?"}, {"role": "assistant", "content": "SELECT DISTINCT suppliers.CompanyName FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.ShippedDate) = YEAR(CURRENT_DATE) AND orders.RequiredDate >= orders.ShippedDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order fulfillment time for each employee?"}, {"role": "assistant", "content": "SELECT EmployeeID, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AverageFulfillmentTime FROM orders GROUP BY EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find out the monthly average units in stock for each product."}, {"role": "assistant", "content": "SELECT p.ProductName, EXTRACT(YEAR FROM o.OrderDate) AS Year, EXTRACT(MONTH FROM o.OrderDate) AS Month, AVG(p.UnitsInStock) AS AverageMonthlyStock FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY p.ProductName, Year, Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many late shipments were there each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS OrderMonth, COUNT(OrderID) AS LateShipments FROM orders WHERE ShippedDate > RequiredDate GROUP BY OrderMonth;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What's the average discount applied to product orders?"}, {"role": "assistant", "content": "SELECT AVG(Discount) FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost by region over the last year?"}, {"role": "assistant", "content": "SELECT ShipRegion, SUM(Freight) AS TotalFreight FROM orders WHERE OrderDate >= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year' GROUP BY ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most common shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS NumberOfOrders FROM orders GROUP BY ShipVia ORDER BY NumberOfOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List the orders that were fulfilled late."}, {"role": "assistant", "content": "SELECT OrderID FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of orders were delivered on time in the last quarter?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN orders.ShippedDate <= orders.RequiredDate THEN 1 ELSE 0 END) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders WHERE QUARTER(orders.OrderDate) = (QUARTER(CURDATE()) - 1) AND YEAR(orders.OrderDate) = YEAR(CURDATE())"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost incurred in each country?"}, {"role": "assistant", "content": "SELECT ShipCountry, SUM(Freight) AS TotalFreight FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of unique products ordered?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT ProductID) FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the distribution of orders shipped per region each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', ShippedDate) AS Month, ShipRegion, COUNT(OrderID) AS OrdersShipped FROM orders GROUP BY Month, ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were placed each month?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS OrderCount, EXTRACT(YEAR FROM OrderDate) AS Year, EXTRACT(MONTH FROM OrderDate) AS Month FROM orders GROUP BY Year, Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the on-time delivery rate for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, ROUND(100.0 * SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) / COUNT(OrderID), 2) AS OnTimeDeliveryRate FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which category of products has generated the most revenue?"}, {"role": "assistant", "content": "SELECT CategoryID, SUM(od.Quantity * od.UnitPrice) AS TotalRevenue FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY CategoryID ORDER BY TotalRevenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the total sales for each product over the last year?"}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].Quantity * (1 - [Order Details].Discount) * [Order Details].UnitPrice) AS TotalSales FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which orders had the highest freight costs?"}, {"role": "assistant", "content": "SELECT o.OrderID, o.Freight FROM orders o ORDER BY o.Freight DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee made the highest sales in July 2023?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID WHERE orders.OrderDate BETWEEN '2023-07-01' AND '2023-07-31' GROUP BY employees.EmployeeID ORDER BY total_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify products due for reorder based on their reorder level and current stock."}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE UnitsInStock <= ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping company has the highest average cost per shipment?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(Freight) AS AverageCost FROM orders GROUP BY ShipVia ORDER BY AverageCost DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the percentage of total sales contributed by each supplier?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, (SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / (SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID)) * 100 AS supplier_sales_percentage FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN suppliers ON products.SupplierID = suppliers.SupplierID GROUP BY suppliers.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the retention rate for January 2023?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT CASE WHEN orders.OrderDate BETWEEN '2023-01-01' AND '2023-01-31' THEN orders.CustomerID END) * 1.0) / (NULLIF(COUNT(DISTINCT CASE WHEN orders.OrderDate < '2023-01-01' THEN orders.CustomerID END), 0)) AS RetentionRate FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the lifetime value of each customer?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS LifetimeValue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify suppliers whose lead time is reducing over the last six months."}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS AvgLeadTime FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN CURRENT_DATE - INTERVAL '6 MONTH' AND CURRENT_DATE GROUP BY suppliers.SupplierID HAVING AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) < (SELECT AVG(DATEDIFF(o2.ShippedDate, o2.OrderDate)) FROM orders o2 JOIN [Order Details] od2 ON o2.OrderID = od2.OrderID JOIN products p2 ON od2.ProductID = p2.ProductID WHERE p2.SupplierID = suppliers.SupplierID AND o2.OrderDate BETWEEN CURRENT_DATE - INTERVAL '1 YEAR' AND CURRENT_DATE - INTERVAL '6 MONTH');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Who are the top 5 employees generating the most sales this year?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, employees.FirstName, employees.LastName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY employees.EmployeeID, employees.FirstName, employees.LastName ORDER BY sales DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which orders have a fulfillment time greater than 30 days?"}, {"role": "assistant", "content": "SELECT o.OrderID FROM orders o WHERE DATEDIFF(o.ShippedDate, o.OrderDate) > 30;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee managed the most orders last month?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS OrderCount FROM orders WHERE DATE_FORMAT(OrderDate, '%Y-%m') = DATE_FORMAT(CURDATE() - INTERVAL 1 MONTH, '%Y-%m') GROUP BY EmployeeID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products are most frequently ordered with a discount?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(OrderID) AS TimesOrdered FROM [Order Details] WHERE Discount > 0 GROUP BY ProductID ORDER BY TimesOrdered DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most shipped product in terms of quantity?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS TotalQuantity FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName ORDER BY TotalQuantity DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product had the most orders, and how many were ordered?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(Quantity) AS TotalQuantity FROM [Order Details] GROUP BY ProductID ORDER BY TotalQuantity DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have been discontinued?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee has handled the highest number of orders?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS TotalOrders FROM orders GROUP BY EmployeeID ORDER BY TotalOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost per shipping method this month?"}, {"role": "assistant", "content": "SELECT o.ShipVia, SUM(o.Freight) AS TotalFreightCost FROM orders o WHERE o.OrderDate >= DATE_TRUNC('month', CURRENT_DATE) GROUP BY o.ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total revenue for each product category?"}, {"role": "assistant", "content": "SELECT p.CategoryID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the total quantity of products on order for each supplier."}, {"role": "assistant", "content": "SELECT s.SupplierName, SUM(p.UnitsOnOrder) FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID WHERE p.UnitsOnOrder > 0 GROUP BY s.SupplierName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which orders had the highest total discount applied?"}, {"role": "assistant", "content": "SELECT OrderID, SUM(Discount * UnitPrice * Quantity) AS TotalDiscount FROM [Order Details] GROUP BY OrderID ORDER BY TotalDiscount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products need to be reordered based on current levels?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock <= ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee handles the most valuable products by unit price?"}, {"role": "assistant", "content": "SELECT e.FirstName, e.LastName FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID JOIN products p ON od.ProductID = p.ProductID ORDER BY od.UnitPrice DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product generated the most revenue this quarter?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS ProductRevenue FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID WHERE QUARTER(o.OrderDate) = QUARTER(CURRENT_DATE) AND YEAR(o.OrderDate) = YEAR(CURRENT_DATE) GROUP BY ProductID ORDER BY ProductRevenue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping company handled the most orders in USD value in Q2 2023?"}, {"role": "assistant", "content": "SELECT shippers.CompanyName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_shipping_value FROM orders JOIN shippers ON orders.ShipVia = shippers.ShipperID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE orders.OrderDate BETWEEN '2023-04-01' AND '2023-06-30' GROUP BY shippers.CompanyName ORDER BY total_shipping_value DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average age of employees at the time of hire?"}, {"role": "assistant", "content": "SELECT AVG((CAST(JULIANDAY(employees.HireDate) - JULIANDAY(employees.BirthDate)) / 365.25 AS DECIMAL(5, 2))) AS AverageAgeAtHire FROM employees"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of units sold by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.Quantity) AS TotalUnits FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of units in stock for each product category?"}, {"role": "assistant", "content": "SELECT CategoryID, SUM(UnitsInStock) AS TotalUnitsInStock FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of products sold to each country?"}, {"role": "assistant", "content": "SELECT orders.ShipCountry, SUM([Order Details].Quantity) AS TotalProductsSold FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY orders.ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List the top 5 products by sales revenue."}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].Quantity * [Order Details].UnitPrice) AS SalesRevenue FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductName ORDER BY SalesRevenue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost by shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, SUM(Freight) AS TotalFreight FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales value for each product?"}, {"role": "assistant", "content": "SELECT products.ProductID, ProductName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID, ProductName ORDER BY TotalSales DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee's orders have the highest average discount applied?"}, {"role": "assistant", "content": "SELECT E.EmployeeID, AVG(OD.Discount) AS AverageDiscount FROM employees E JOIN orders O ON E.EmployeeID = O.EmployeeID JOIN [Order Details] OD ON O.OrderID = OD.OrderID GROUP BY E.EmployeeID ORDER BY AverageDiscount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the average discount applied to orders in the last 3 months."}, {"role": "assistant", "content": "SELECT AVG([Order Details].Discount) AS avg_discount FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 3 MONTH)"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier has the most units in stock across all their products?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID GROUP BY suppliers.SupplierID ORDER BY SUM(products.UnitsInStock) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the inventory turnover ratio for February 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-02-01' AND '2023-02-28'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the total sales for each product in the current month?"}, {"role": "assistant", "content": "SELECT P.ProductName, SUM(OD.Quantity * OD.UnitPrice) AS TotalSales FROM products P JOIN [Order Details] OD ON P.ProductID = OD.ProductID WHERE DATE_FORMAT(CURDATE(), '%Y-%m') = DATE_FORMAT(CURRENT_DATE(), '%Y-%m') GROUP BY P.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have the highest inventory turnover ratio?"}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductName ORDER BY turnover_ratio DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping company handled the most deliveries in 2023?"}, {"role": "assistant", "content": "SELECT shippers.CompanyName, COUNT(orders.OrderID) AS num_deliveries FROM orders JOIN shippers ON orders.ShipVia = shippers.ShipperID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY shippers.CompanyName ORDER BY num_deliveries DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the busiest month for orders."}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM OrderDate) AS OrderMonth, COUNT(OrderID) AS MonthlyOrders FROM orders GROUP BY OrderMonth ORDER BY MonthlyOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which cities do the top three suppliers operate from?"}, {"role": "assistant", "content": "SELECT suppliers.City FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID GROUP BY suppliers.City ORDER BY COUNT(DISTINCT products.SupplierID) DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the longest time taken to fulfill an order?"}, {"role": "assistant", "content": "SELECT MAX(DATEDIFF(ShippedDate, OrderDate)) AS LongestFulfillmentTime FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost incurred for orders handled by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(o.Freight) AS TotalFreight FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average monthly sales growth for each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, AVG(CASE WHEN LAG(SUM(od.Quantity), 1) OVER (PARTITION BY p.ProductID ORDER BY EXTRACT(YEAR FROM o.OrderDate), EXTRACT(MONTH FROM o.OrderDate)) = 0 THEN NULL ELSE (SUM(od.Quantity) - LAG(SUM(od.Quantity), 1) OVER (PARTITION BY p.ProductID ORDER BY EXTRACT(YEAR FROM o.OrderDate), EXTRACT(MONTH FROM o.OrderDate))) / LAG(SUM(od.Quantity), 1) OVER (PARTITION BY p.ProductID ORDER BY EXTRACT(YEAR FROM o.OrderDate), EXTRACT(MONTH FROM o.OrderDate)) END) AS AvgSalesGrowth FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY p.ProductID, p.ProductName, EXTRACT(YEAR FROM o.OrderDate), EXTRACT(MONTH FROM o.OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How does the sales quantity of each product compare month over month?"}, {"role": "assistant", "content": "SELECT ProductName, EXTRACT(MONTH FROM OrderDate) AS Month, SUM([Order Details].Quantity) AS MonthlyQuantity FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY ProductName, EXTRACT(MONTH FROM OrderDate) ORDER BY ProductName, EXTRACT(MONTH FROM OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total discount given for each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, SUM([Order Details].UnitPrice * [Order Details].Quantity * [Order Details].Discount) AS TotalDiscount FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount applied per order this year?"}, {"role": "assistant", "content": "SELECT AVG([Order Details].Discount) AS avg_discount FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = YEAR(CURRENT_DATE)"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average lead time for each supplier over the past year?"}, {"role": "assistant", "content": "SELECT s.SupplierID, AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AverageLeadTime FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN orders o ON p.ProductID IN (SELECT od.ProductID FROM [Order Details] od WHERE od.OrderID = o.OrderID) WHERE o.OrderDate BETWEEN CURDATE() - INTERVAL 1 YEAR AND CURDATE() GROUP BY s.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee has the most orders completed in a given month?"}, {"role": "assistant", "content": "SELECT orders.EmployeeID, COUNT(orders.OrderID) AS OrderCount FROM orders WHERE MONTH(orders.OrderDate) = 6 AND YEAR(orders.OrderDate) = 2023 GROUP BY orders.EmployeeID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the maximum reorder level for products from each supplier."}, {"role": "assistant", "content": "SELECT SupplierID, MAX(ReorderLevel) AS MaxReorderLevel FROM products GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping company was used the most in the previous quarter?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS UsageCount FROM orders WHERE QUARTER(OrderDate) = QUARTER(CURDATE()) - 1 AND YEAR(OrderDate) = YEAR(CURDATE()) OR (QUARTER(CURDATE()) = 1 AND YEAR(OrderDate) = YEAR(CURDATE()) - 1) GROUP BY ShipVia ORDER BY UsageCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee handled the most on-time deliveries in the last year?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS OnTimeDeliveries FROM orders WHERE ShippedDate <= RequiredDate AND YEAR(OrderDate) = YEAR(CURDATE()) - 1 GROUP BY EmployeeID ORDER BY OnTimeDeliveries DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many employees were hired before 2000?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM employees WHERE HireDate < '2000-01-01';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees have a higher average order value than their direct manager?"}, {"role": "assistant", "content": "SELECT a.EmployeeID FROM employees a JOIN orders b ON a.EmployeeID = b.EmployeeID JOIN [Order Details] c ON b.OrderID = c.OrderID JOIN employees d ON a.ReportsTo = d.EmployeeID GROUP BY a.EmployeeID, d.EmployeeID HAVING AVG(c.UnitPrice * c.Quantity * (1 - c.Discount)) > (SELECT AVG(od.UnitPrice * od.Quantity * (1 - od.Discount)) FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.EmployeeID = d.EmployeeID);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average units in stock per product category?"}, {"role": "assistant", "content": "SELECT CategoryID, AVG(UnitsInStock) AS AvgUnitsInStock FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping methods are most frequently used?"}, {"role": "assistant", "content": "SELECT o.ShipVia, COUNT(o.OrderID) AS UseCount FROM orders o GROUP BY o.ShipVia ORDER BY UseCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the supplier with the largest revenue from sales."}, {"role": "assistant", "content": "SELECT products.SupplierID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.SupplierID ORDER BY TotalRevenue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the products that have not been sold at all."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName FROM products p LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE od.ProductID IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the percentage of orders delivered on time each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, 100.0 * COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END) / COUNT(OrderID) AS OnTimeDeliveryRate FROM orders GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of units on order for each product category?"}, {"role": "assistant", "content": "SELECT CategoryID, SUM(UnitsOnOrder) AS TotalUnitsOnOrder FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, SUM(Freight) AS TotalFreightCost FROM orders GROUP BY ShipVia"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount provided across all products?"}, {"role": "assistant", "content": "SELECT AVG(Discount) FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers have not been used in any orders?"}, {"role": "assistant", "content": "SELECT s.SupplierID FROM suppliers s LEFT JOIN products p ON s.SupplierID = p.SupplierID LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE od.OrderID IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total sales revenue per supplier for the last fiscal year."}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS SupplierRevenue FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = YEAR(CURRENT_DATE) - 1 GROUP BY suppliers.CompanyName ORDER BY SupplierRevenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top five customers based on order volume?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS OrderVolume FROM orders GROUP BY CustomerID ORDER BY OrderVolume DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 5 cities with the most supplier companies?"}, {"role": "assistant", "content": "SELECT City, COUNT(DISTINCT SupplierID) AS SupplierCount FROM suppliers GROUP BY City ORDER BY SupplierCount DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most common region suppliers are from?"}, {"role": "assistant", "content": "SELECT Region, COUNT(*) FROM suppliers GROUP BY Region ORDER BY COUNT(*) DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find employees who have worked for more than 10 years and their number of orders handled."}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE YEAR(CURRENT_DATE) - YEAR(e.HireDate) > 10 GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost by country?"}, {"role": "assistant", "content": "SELECT ShipCountry, SUM(Freight) AS TotalFreightCost FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the top 5 customers by lifetime value."}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS LifetimeValue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID ORDER BY LifetimeValue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the regions with the highest order volumes."}, {"role": "assistant", "content": "SELECT ShipRegion, COUNT(OrderID) AS OrderVolume FROM orders GROUP BY ShipRegion ORDER BY OrderVolume DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee generated the highest sales in Q2 2023?"}, {"role": "assistant", "content": "SELECT employees.FirstName, employees.LastName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID WHERE orders.OrderDate BETWEEN '2023-04-01' AND '2023-06-30' GROUP BY employees.EmployeeID ORDER BY total_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were placed and not yet shipped?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS UnshippedOrders FROM orders WHERE ShippedDate IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost incurred for each shipping country?"}, {"role": "assistant", "content": "SELECT o.ShipCountry, SUM(o.Freight) AS TotalFreight FROM orders o GROUP BY o.ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products are below their reorder level?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees have not recorded any sales this year?"}, {"role": "assistant", "content": "SELECT e.EmployeeID FROM employees e LEFT JOIN orders o ON e.EmployeeID = o.EmployeeID AND YEAR(o.OrderDate) = YEAR(CURDATE()) WHERE o.OrderID IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products are below their reorder level and need to be restocked?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee handled the most orders that were shipped late?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, COUNT(orders.OrderID) AS LateOrders FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID WHERE ShippedDate > RequiredDate GROUP BY employees.EmployeeID ORDER BY LateOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List all products that have never been ordered."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the percentage of orders delivered on or before the required date each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, 100.0 * COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END) / COUNT(OrderID) AS OnTimeDeliveryRate FROM orders GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has the highest average shipping cost?"}, {"role": "assistant", "content": "SELECT ShipCity, AVG(Freight) AS AvgShippingCost FROM orders GROUP BY ShipCity ORDER BY AvgShippingCost DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine which products have had discounts applied most frequently."}, {"role": "assistant", "content": "SELECT p.ProductName, COUNT(od.Discount) AS DiscountCount FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID WHERE od.Discount > 0 GROUP BY p.ProductName ORDER BY DiscountCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the countries with the most unique suppliers."}, {"role": "assistant", "content": "SELECT Country, COUNT(DISTINCT SupplierID) AS UniqueSuppliers FROM suppliers GROUP BY Country ORDER BY UniqueSuppliers DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees are linked to the most orders?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS OrderCount FROM orders GROUP BY EmployeeID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has the highest number of orders placed in 2023?"}, {"role": "assistant", "content": "SELECT orders.ShipCity, COUNT(orders.OrderID) AS num_orders FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY orders.ShipCity ORDER BY num_orders DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many products have zero units in stock?"}, {"role": "assistant", "content": "SELECT COUNT(ProductID) AS NumberOfProductsWithZeroStock FROM products WHERE UnitsInStock = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Analyze the correlation between employee job title and sales performance."}, {"role": "assistant", "content": "SELECT employees.Title, AVG(TotalSales) AS AverageSales FROM (SELECT employees.Title, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID, employees.Title) AS EmployeeSales GROUP BY employees.Title;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order fulfillment time for each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify orders with a shipping delay greater than 7 days."}, {"role": "assistant", "content": "SELECT OrderID FROM orders WHERE ShippedDate > RequiredDate + INTERVAL '7' DAY;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many products are currently at or above their reorder level?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS AtOrAboveReOrder FROM products WHERE UnitsInStock >= ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the current inventory turnover ratio?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the correlation between employee sales and years of service?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, (YEAR(CURDATE()) - YEAR(employees.HireDate)) AS years_of_service, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has received the highest number of shipments?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS Shipments FROM orders GROUP BY ShipCity ORDER BY Shipments DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the percentage of orders shipped on time."}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END) * 100.0 / COUNT(OrderID)) AS OnTimePercentage FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List all orders with their shipment region and corresponding total order value."}, {"role": "assistant", "content": "SELECT o.OrderID, o.ShipRegion, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS OrderValue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.OrderID, o.ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the employee with the highest average order value."}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS AvgOrderValue FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID ORDER BY AvgOrderValue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average age of employees who have made a sale in the last year?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(CURRENT_DATE, e.BirthDate) / 365) AS AverageAge FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.OrderDate >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the sum of all discounts given on 'Order Details'?"}, {"role": "assistant", "content": "SELECT SUM(od.Discount * od.Quantity * od.UnitPrice) AS TotalDiscounts FROM [Order Details] od;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped late last month?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) FROM orders WHERE ShippedDate > RequiredDate AND DATE_TRUNC('month', ShippedDate) = DATE_TRUNC('month', CURRENT_DATE - INTERVAL '1 month');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many customers were retained from Q1 to Q2 in 2023?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT o.CustomerID) AS retained_customers FROM orders o WHERE o.CustomerID IN (SELECT CustomerID FROM orders WHERE OrderDate BETWEEN '2023-01-01' AND '2023-03-31') AND o.OrderDate BETWEEN '2023-04-01' AND '2023-06-30'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of units sold by supplier?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, SUM([Order Details].Quantity) AS total_units_sold FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN suppliers ON products.SupplierID = suppliers.SupplierID GROUP BY suppliers.CompanyName ORDER BY total_units_sold DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers are from a specific country and have placed orders?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, customers.CompanyName FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID WHERE customers.Country = 'Specific Country';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier has the longest average lead time?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS AvgLeadTime FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY suppliers.SupplierID, suppliers.CompanyName ORDER BY AvgLeadTime DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 5 products by sales volume?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS SalesVolume FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductName ORDER BY SalesVolume DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products are currently at or below their reorder level?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock <= ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders have a discount applied?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT o.OrderID) FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE od.Discount > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers have the shortest average lead time for deliveries?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_lead_time FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN products ON [Order Details].ProductID = products.ProductID JOIN suppliers ON products.SupplierID = suppliers.SupplierID GROUP BY suppliers.SupplierID ORDER BY avg_lead_time ASC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the monthly growth rate in sales for each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, YEAR(o.OrderDate) AS Year, MONTH(o.OrderDate) AS Month, (SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) - LAG(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))) OVER (PARTITION BY e.EmployeeID ORDER BY YEAR(o.OrderDate), MONTH(o.OrderDate))) / LAG(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))) OVER (PARTITION BY e.EmployeeID ORDER BY YEAR(o.OrderDate), MONTH(o.OrderDate)) AS MonthlyGrowth FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, YEAR(o.OrderDate), MONTH(o.OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the monthly trend of new customers acquired?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, COUNT(DISTINCT CustomerID) AS NewCustomers FROM orders GROUP BY Month ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total quantity of products ordered by each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, SUM(od.Quantity) AS TotalQuantity FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales value in the last quarter?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-10-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the monthly customer retention rate for 2023?"}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM OrderDate) AS Month, COUNT(DISTINCT o1.CustomerID) * 1.0 / NULLIF((SELECT COUNT(DISTINCT o2.CustomerID) FROM orders o2 WHERE o2.OrderDate < '2023-01-01'), 0) AS RetentionRate FROM orders o1 WHERE OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY EXTRACT(MONTH FROM OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount applied to orders per supplier?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, suppliers.SupplierName, AVG([Order Details].Discount) AS AverageDiscount FROM suppliers INNER JOIN products ON suppliers.SupplierID = products.SupplierID INNER JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY suppliers.SupplierID, suppliers.SupplierName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total revenue generated from each product?"}, {"role": "assistant", "content": "SELECT ProductName, SUM(Quantity * UnitPrice * (1 - Discount)) AS TotalRevenue FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier has the most diverse product range?"}, {"role": "assistant", "content": "SELECT SupplierID, COUNT(DISTINCT CategoryID) AS ProductRange FROM products GROUP BY SupplierID ORDER BY ProductRange DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Get the supplier details for products with the lowest units in stock."}, {"role": "assistant", "content": "SELECT p.ProductName, s.SupplierID FROM products p JOIN suppliers s ON p.SupplierID = s.SupplierID WHERE p.UnitsInStock = (SELECT MIN(UnitsInStock) FROM products);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the distribution of employees across different cities?"}, {"role": "assistant", "content": "SELECT City, COUNT(EmployeeID) AS EmployeeCount FROM employees GROUP BY City;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders are shipped using more than one shipping method?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM (SELECT OrderID, COUNT(DISTINCT ShipVia) AS MethodCount FROM orders GROUP BY OrderID HAVING MethodCount > 1) AS MultiMethodOrders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total revenue attributed to each supplier?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY suppliers.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which month had the highest average order value?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS AvgOrderValue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY DATE_TRUNC('month', OrderDate) ORDER BY AvgOrderValue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the inventory turnover ratio for each product category last quarter?"}, {"role": "assistant", "content": "SELECT c.CategoryName, SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(p.UnitsInStock) AS turnover_ratio FROM [Order Details] JOIN products p ON [Order Details].ProductID = p.ProductID JOIN categories c ON p.CategoryID = c.CategoryID WHERE [Order Details].OrderDate BETWEEN '2023-01-01' AND '2023-03-31' GROUP BY c.CategoryName"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List all products and their respective stock and order quantities."}, {"role": "assistant", "content": "SELECT ProductName, UnitsInStock, UnitsOnOrder FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier has delivered the highest total number of product units?"}, {"role": "assistant", "content": "SELECT s.SupplierID, SUM(od.Quantity) AS TotalUnits FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.SupplierID ORDER BY TotalUnits DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipper has the highest on-time delivery rate in 2023?"}, {"role": "assistant", "content": "SELECT shippers.CompanyName, (COUNT(CASE WHEN orders.ShippedDate <= orders.RequiredDate THEN 1 END) / CAST(COUNT(orders.OrderID) AS FLOAT) * 100) AS on_time_delivery_rate FROM orders JOIN shippers ON orders.ShipVia = shippers.ShipperID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY shippers.CompanyName ORDER BY on_time_delivery_rate DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products should be considered for discontinuation based on sales?"}, {"role": "assistant", "content": "SELECT ProductName FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY ProductName HAVING SUM([Order Details].Quantity) < MIN(ReorderLevel);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the month with the highest total product sales value."}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM o.OrderDate) AS SalesMonth, SUM(od.Quantity * od.UnitPrice) AS TotalSales FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID GROUP BY SalesMonth ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 5 cities with the highest number of orders?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS order_count FROM orders GROUP BY ShipCity ORDER BY order_count DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product generated the highest sales revenue in March 2023?"}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS sales_revenue FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-03-01' AND '2023-03-31' GROUP BY products.ProductName ORDER BY sales_revenue DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order fulfillment time each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AverageFulfillmentTime FROM orders GROUP BY DATE_TRUNC('month', OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the percentage of orders delivered before the required date for the last three months?"}, {"role": "assistant", "content": "SELECT 100 * COUNT(CASE WHEN orders.ShippedDate <= orders.RequiredDate THEN orders.OrderID END) / COUNT(orders.OrderID) AS on_time_rate FROM orders WHERE orders.OrderDate BETWEEN DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '2 months' AND CURRENT_DATE"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have the highest reorder level?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE ReorderLevel = (SELECT MAX(ReorderLevel) FROM products);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier contributed the most to our total sales?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS supplier_sales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN suppliers ON products.SupplierID = suppliers.SupplierID GROUP BY suppliers.SupplierID ORDER BY supplier_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount for each order?"}, {"role": "assistant", "content": "SELECT OrderID, AVG(Discount) AS AverageDiscount FROM [Order Details] GROUP BY OrderID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How often are products reordered compared to their reorder level?"}, {"role": "assistant", "content": "SELECT ProductName, (UnitsOnOrder - ReorderLevel) AS ReorderDifference FROM products WHERE (UnitsOnOrder - ReorderLevel) > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders are shipped to each city?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(*) AS OrderCount FROM orders GROUP BY ShipCity;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped late in each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, COUNT(*) AS LateOrders FROM orders WHERE ShippedDate > RequiredDate GROUP BY DATE_TRUNC('month', OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping method is used most frequently?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipVia ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the reorder levels for products nearing zero stock."}, {"role": "assistant", "content": "SELECT products.ProductName, products.ReorderLevel FROM products WHERE products.UnitsInStock < products.ReorderLevel"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee territories are underperforming in terms of sales?"}, {"role": "assistant", "content": "SELECT territories.TerritoryDescription, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS territory_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID JOIN employeeTerritories ON employees.EmployeeID = employeeTerritories.EmployeeID JOIN territories ON employeeTerritories.TerritoryID = territories.TerritoryID GROUP BY territories.TerritoryID, territories.TerritoryDescription ORDER BY territory_sales"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the employee with the most orders shipped late."}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) AS LateOrders FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.RequiredDate < o.ShippedDate GROUP BY e.EmployeeID ORDER BY LateOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have not been ordered at all?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has the lowest on-time delivery rate?"}, {"role": "assistant", "content": "SELECT ShipCity, (COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END) * 1.0) / COUNT(*) AS OnTimeDeliveryRate FROM orders GROUP BY ShipCity ORDER BY OnTimeDeliveryRate ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find employees living in the same city as their manager."}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName FROM employees e JOIN employees m ON e.ReportsTo = m.EmployeeID WHERE e.City = m.City;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the difference in sales between the current and previous year for each employee."}, {"role": "assistant", "content": "SELECT e.EmployeeID, (SUM(CASE WHEN YEAR(o.OrderDate) = YEAR(CURRENT_DATE) THEN od.UnitPrice * od.Quantity * (1 - od.Discount) ELSE 0 END) - SUM(CASE WHEN YEAR(o.OrderDate) = YEAR(CURRENT_DATE) - 1 THEN od.UnitPrice * od.Quantity * (1 - od.Discount) ELSE 0 END)) AS SalesDifference FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which specific products need to be reordered immediately?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock <= ReorderLevel AND Discontinued = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top three countries by total sales?"}, {"role": "assistant", "content": "SELECT o.ShipCountry, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS CountrySales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.ShipCountry ORDER BY CountrySales DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the suppliers with late shipments on orders."}, {"role": "assistant", "content": "SELECT suppliers.CompanyName FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.RequiredDate < orders.ShippedDate GROUP BY suppliers.CompanyName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average shipping cost per order by shipping company?"}, {"role": "assistant", "content": "SELECT shippers.CompanyName, AVG(orders.Freight) AS avg_shipping_cost FROM orders JOIN shippers ON orders.ShipVia = shippers.ShipperID GROUP BY shippers.CompanyName"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List suppliers located in the same city."}, {"role": "assistant", "content": "SELECT DISTINCT s1.CompanyName, s2.CompanyName FROM suppliers s1 JOIN suppliers s2 ON s1.City = s2.City AND s1.SupplierID < s2.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many customers have been retained from 2022 to 2023?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT retained.CustomerID) FROM (SELECT CustomerID FROM orders WHERE OrderDate BETWEEN '2022-01-01' AND '2022-12-31') AS previous INNER JOIN (SELECT CustomerID FROM orders WHERE OrderDate BETWEEN '2023-01-01' AND '2023-12-31') AS current ON previous.CustomerID = current.CustomerID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customer placed the most orders in the last year?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS OrderCount FROM orders WHERE OrderDate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY CustomerID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which region has the most orders?"}, {"role": "assistant", "content": "SELECT ShipRegion, COUNT(OrderID) AS NumOrders FROM orders GROUP BY ShipRegion ORDER BY NumOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped more than a week after the order date?"}, {"role": "assistant", "content": "SELECT COUNT(o.OrderID) AS DelayedOrders FROM orders o WHERE DATEDIFF(o.ShippedDate, o.OrderDate) > 7;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee has the highest sales in the last month?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATEADD(MONTH, -1, CURRENT_DATE) GROUP BY e.EmployeeID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the total number of products in each category."}, {"role": "assistant", "content": "SELECT CategoryID, COUNT(ProductID) AS TotalProducts FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the inventory turnover ratio for each product in 2023?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY products.ProductID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many products have stock levels below their reorder level?"}, {"role": "assistant", "content": "SELECT COUNT(products.ProductID) AS low_stock_products FROM products WHERE products.UnitsInStock < products.ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total value of unshipped orders?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS UnshippedValue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE ShippedDate IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers received shipments to multiple countries?"}, {"role": "assistant", "content": "SELECT c.CustomerID FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID GROUP BY c.CustomerID HAVING COUNT(DISTINCT o.ShipCountry) > 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers provide the most products?"}, {"role": "assistant", "content": "SELECT s.SupplierName, COUNT(*) AS ProductCount FROM products p JOIN suppliers s ON p.SupplierID = s.SupplierID GROUP BY s.SupplierName ORDER BY ProductCount DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have the highest unit prices in each category?"}, {"role": "assistant", "content": "SELECT p.CategoryID, p.ProductName, p.UnitPrice FROM products p JOIN (SELECT CategoryID, MAX(UnitPrice) AS MaxPrice FROM products GROUP BY CategoryID) pm ON p.CategoryID = pm.CategoryID AND p.UnitPrice = pm.MaxPrice;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the distribution of employee salaries?"}, {"role": "assistant", "content": "SELECT Salary, COUNT(EmployeeID) AS EmployeeCount FROM employees GROUP BY Salary;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount given on each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, AVG(od.Discount) AS AverageDiscount FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount given on all orders?"}, {"role": "assistant", "content": "SELECT AVG(Discount) FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the inventory turnover ratio for all products."}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS InventoryTurnoverRatio FROM products INNER JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales revenue generated by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many discontinued products are still listed?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which region has the highest number of orders in 2023?"}, {"role": "assistant", "content": "SELECT region.RegionDescription, COUNT(orders.OrderID) AS order_count FROM orders JOIN territories ON orders.ShipRegion = territories.TerritoryID JOIN region ON territories.RegionID = region.RegionID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY region.RegionDescription ORDER BY order_count DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average shipping cost per order for each customer country?"}, {"role": "assistant", "content": "SELECT customers.Country, AVG(orders.Freight) AS avg_shipping_cost FROM orders JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.Country"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount applied to products in each order?"}, {"role": "assistant", "content": "SELECT OrderID, AVG(Discount) AS AvgDiscount FROM [Order Details] GROUP BY OrderID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the details of orders where a discount was applied?"}, {"role": "assistant", "content": "SELECT * FROM [Order Details] WHERE Discount > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products are most frequently ordered?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(ProductID) AS Frequency FROM [Order Details] GROUP BY ProductID ORDER BY Frequency DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total discount offered across all orders this month?"}, {"role": "assistant", "content": "SELECT SUM(od.Discount) AS TotalDiscount FROM [Order Details] od WHERE DATE_TRUNC('month', CURRENT_DATE) = DATE_TRUNC('month', OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products had the highest discount applied last month?"}, {"role": "assistant", "content": "SELECT p.ProductName, od.Discount FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID WHERE od.OrderDate >= DATEADD(month, -1, CURRENT_DATE) AND od.OrderDate < CURRENT_DATE ORDER BY od.Discount DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the customer retention rate for January 2022."}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT CASE WHEN orders.OrderDate BETWEEN '2022-01-01' AND '2022-01-31' THEN orders.CustomerID END) * 1.0 / COUNT(DISTINCT CASE WHEN orders.OrderDate < '2022-01-01' THEN orders.CustomerID END)) AS RetentionRate FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of customers are repeat buyers in 2023?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT o2023.CustomerID) * 1.0 / NULLIF(COUNT(DISTINCT oBefore2023.CustomerID), 0)) AS repeat_customer_rate FROM orders o2023 JOIN orders oBefore2023 ON o2023.CustomerID = oBefore2023.CustomerID WHERE o2023.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' AND oBefore2023.OrderDate < '2023-01-01'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How much revenue has each customer generated over their lifetime?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total quantity sold for each product this month?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS TotalQuantity FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID WHERE DATE_TRUNC('month', CURRENT_DATE) = DATE_TRUNC('month', od.OrderDate) GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city received the most shipments?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(*) AS Shipments FROM orders GROUP BY ShipCity ORDER BY Shipments DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify suppliers who supply discontinued products."}, {"role": "assistant", "content": "SELECT SupplierID FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee had the most sales in the last quarter?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATEADD(QUARTER, -1, CURRENT_DATE) GROUP BY e.EmployeeID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have orders that significantly exceed their reorder levels?"}, {"role": "assistant", "content": "SELECT p.ProductName FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID HAVING SUM(od.Quantity) > p.ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Analyze the products with higher sales than the average monthly performance."}, {"role": "assistant", "content": "SELECT ProductID FROM (SELECT ProductID, SUM(Quantity) AS TotalQuantity FROM [Order Details] GROUP BY ProductID) AS ProductPerformance WHERE TotalQuantity > (SELECT AVG(TotalQuantity) FROM (SELECT ProductID, SUM(Quantity) AS TotalQuantity FROM [Order Details] GROUP BY ProductID) AS AvgPerformance);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the most common shipping recipient names."}, {"role": "assistant", "content": "SELECT ShipName, COUNT(*) AS Frequency FROM orders GROUP BY ShipName ORDER BY Frequency DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the top 3 cities with the most suppliers."}, {"role": "assistant", "content": "SELECT City, COUNT(*) AS SupplierCount FROM suppliers GROUP BY City ORDER BY SupplierCount DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers have placed the most orders?"}, {"role": "assistant", "content": "SELECT o.CustomerID, COUNT(o.OrderID) AS OrderCount FROM orders o GROUP BY o.CustomerID ORDER BY OrderCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the current stock level for each product?"}, {"role": "assistant", "content": "SELECT ProductID, UnitsInStock FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the overall product performance score using a composite measure of sales and inventory levels."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, (SUM(od.Quantity) * (1 - p.Discontinued)) / (p.UnitsInStock + 1) AS ProductPerformanceScore FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have reached their reorder level as of the current date?"}, {"role": "assistant", "content": "SELECT products.ProductName FROM products WHERE products.UnitsInStock <= products.ReorderLevel"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total discount given for each product?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(UnitPrice * Quantity * Discount) AS TotalDiscount FROM [Order Details] GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many products are currently discontinued?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS DiscontinuedProducts FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the lifetime value of each customer."}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS LifetimeValue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount given by each employee on their orders?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, AVG(od.Discount) AS AverageDiscount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, e.FirstName, e.LastName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the top-performing products based on sales."}, {"role": "assistant", "content": "SELECT ProductName, SUM(Quantity) AS TotalSales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID WHERE products.Discontinued = 0 GROUP BY ProductName ORDER BY TotalSales DESC LIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the variance in shipping costs for each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS OrderMonth, VARIANCE(Freight) AS FreightVariance FROM orders GROUP BY OrderMonth;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost for each shipping country?"}, {"role": "assistant", "content": "SELECT ShipCountry, SUM(Freight) AS TotalFreight FROM orders GROUP BY ShipCountry"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the month-by-month growth in total sales?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(O.OrderDate, '%Y-%m') AS Month, SUM(OD.UnitPrice * OD.Quantity * (1 - OD.Discount)) AS TotalSales FROM orders O JOIN [Order Details] OD ON O.OrderID = OD.OrderID GROUP BY Month ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost for shipped orders?"}, {"role": "assistant", "content": "SELECT SUM(Freight) AS TotalFreightCost FROM orders WHERE ShippedDate IS NOT NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How much revenue is generated from orders with more than 10 units?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity) AS Revenue FROM [Order Details] WHERE Quantity > 10;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped on time each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, COUNT(OrderID) FROM orders WHERE ShippedDate <= RequiredDate GROUP BY DATE_TRUNC('month', OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the variance in shipping costs across different regions?"}, {"role": "assistant", "content": "SELECT ShipRegion, VAR_SAMP(Freight) AS FreightVariance FROM orders GROUP BY ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of orders have a shipping cost greater than $100?"}, {"role": "assistant", "content": "SELECT COUNT(*) * 100.0 / (SELECT COUNT(*) FROM orders) AS Percentage FROM orders WHERE Freight > 100;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most common order quantity?"}, {"role": "assistant", "content": "SELECT od.Quantity, COUNT(od.Quantity) AS Frequency FROM [Order Details] od GROUP BY od.Quantity ORDER BY Frequency DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top-selling products based on total sales in the last month?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity * od.UnitPrice) AS TotalSales FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID WHERE MONTH(OrderDate) = MONTH(CURRENT_DATE) - 1 AND YEAR(OrderDate) = YEAR(CURRENT_DATE) GROUP BY od.ProductID, p.ProductName ORDER BY TotalSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the product with the most significant percentage sales growth month-over-month."}, {"role": "assistant", "content": "SELECT p.ProductID, ((SUM(CASE WHEN EXTRACT(MONTH FROM od.OrderDate) = EXTRACT(MONTH FROM CURRENT_DATE) THEN od.Quantity ELSE 0 END) - SUM(CASE WHEN EXTRACT(MONTH FROM od.OrderDate) = EXTRACT(MONTH FROM DATE_ADD('month', -1, CURRENT_DATE)) THEN od.Quantity ELSE 0 END)) / NULLIF(SUM(CASE WHEN EXTRACT(MONTH FROM od.OrderDate) = EXTRACT(MONTH FROM DATE_ADD('month', -1, CURRENT_DATE)) THEN od.Quantity ELSE 0 END), 0)) * 100 AS SalesGrowth FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductID ORDER BY SalesGrowth DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average number of orders processed per employee each month?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, COUNT(orders.OrderID) / COUNT(DISTINCT EXTRACT(YEAR_MONTH FROM orders.OrderDate)) AS AvgOrdersPerMonth FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID GROUP BY employees.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average fulfillment time for orders in Q1 2023?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_fulfillment_time FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-03-31'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products are most frequently ordered together?"}, {"role": "assistant", "content": "SELECT od1.ProductID, od2.ProductID, COUNT(*) AS OrderedTogetherCount FROM [Order Details] od1 JOIN [Order Details] od2 ON od1.OrderID = od2.OrderID AND od1.ProductID < od2.ProductID GROUP BY od1.ProductID, od2.ProductID ORDER BY OrderedTogetherCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the average order quantity per product."}, {"role": "assistant", "content": "SELECT p.ProductName, AVG(od.Quantity) AS AverageQuantity FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which recipient received the highest number of shipments?"}, {"role": "assistant", "content": "SELECT ShipName, COUNT(OrderID) AS NumShipments FROM orders GROUP BY ShipName ORDER BY NumShipments DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the distribution of order quantities for each employee over the last three months?"}, {"role": "assistant", "content": "SELECT e.FirstName, e.LastName, od.Quantity FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATE_SUB(CURRENT_DATE, INTERVAL 3 MONTH) GROUP BY e.FirstName, e.LastName, od.Quantity ORDER BY od.Quantity;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have an inventory turnover ratio below the average?"}, {"role": "assistant", "content": "SELECT ProductName FROM (SELECT p.ProductName, SUM(od.Quantity * od.UnitPrice) / AVG(p.UnitsInStock) AS TurnoverRatio FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductName) AS Turnover WHERE TurnoverRatio < (SELECT AVG(TurnoverRatio) FROM (SELECT SUM(od.Quantity * od.UnitPrice) / AVG(p.UnitsInStock) AS TurnoverRatio FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductID) AS AvgTurnover);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many active products have stock quantities between their reorder level and maximum?"}, {"role": "assistant", "content": "SELECT COUNT(ProductID) FROM products WHERE UnitsInStock > ReorderLevel AND Discontinued = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the top 5 customers by total revenue."}, {"role": "assistant", "content": "SELECT c.CustomerID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID ORDER BY TotalRevenue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most popular product by quantity ordered?"}, {"role": "assistant", "content": "SELECT p.ProductName FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductName ORDER BY SUM(od.Quantity) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Who are the top 5 customers by lifetime value?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID ORDER BY customer_lifetime_value DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the products with the most stock variability (highest fluctuation)."}, {"role": "assistant", "content": "SELECT ProductName, MAX(UnitsInStock) - MIN(UnitsInStock) AS StockVariance FROM products GROUP BY ProductName ORDER BY StockVariance DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees have earned a salary above the average?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID FROM employees WHERE Salary > (SELECT AVG(Salary) FROM employees);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees have more than five years of employment?"}, {"role": "assistant", "content": "SELECT EmployeeID FROM employees WHERE DATEDIFF(CURRENT_DATE, HireDate) / 365 > 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top three regions with the highest on-time delivery rate?"}, {"role": "assistant", "content": "SELECT ShipRegion, 100.0 * COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END) / COUNT(OrderID) AS OnTimeDeliveryRate FROM orders GROUP BY ShipRegion ORDER BY OnTimeDeliveryRate DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have the highest orders on discount?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, SUM(od.Quantity * od.UnitPrice * od.Discount) AS DiscountedRevenue FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE od.Discount > 0 GROUP BY p.ProductID, p.ProductName ORDER BY DiscountedRevenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 5 products with the highest revenue?"}, {"role": "assistant", "content": "SELECT od.ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM [Order Details] od GROUP BY od.ProductID ORDER BY TotalRevenue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average inventory level for each supplier?"}, {"role": "assistant", "content": "SELECT SupplierID, AVG(UnitsInStock) AS AvgInventory FROM products GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 3 regions with the highest order volumes?"}, {"role": "assistant", "content": "SELECT territories.TerritoryDescription, COUNT(orders.OrderID) AS order_count FROM orders JOIN employees ON orders.EmployeeID = employees.EmployeeID JOIN employeeTerritories ON employees.EmployeeID = employeeTerritories.EmployeeID JOIN territories ON employeeTerritories.TerritoryID = territories.TerritoryID GROUP BY territories.TerritoryDescription ORDER BY order_count DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount applied to each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, AVG(od.Discount) AS AverageDiscount FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many sales were made by employees hired in the last year?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) AS RecentSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE e.HireDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many units of each product are on order?"}, {"role": "assistant", "content": "SELECT ProductID, UnitsOnOrder FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which orders were shipped after the required date?"}, {"role": "assistant", "content": "SELECT OrderID FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product has the highest sales revenue?"}, {"role": "assistant", "content": "SELECT products.ProductID, products.ProductName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID, products.ProductName ORDER BY TotalRevenue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most frequently ordered product?"}, {"role": "assistant", "content": "SELECT ProductName, COUNT([Order Details].OrderID) AS OrderCount FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY ProductName ORDER BY OrderCount DESC FETCH FIRST 1 ROW ONLY;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total discount provided by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.Discount * od.Quantity * od.UnitPrice) AS TotalDiscount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average shipping cost per order for the last month?"}, {"role": "assistant", "content": "SELECT AVG(Freight) FROM orders WHERE OrderDate >= DATEADD(MONTH, -1, CURRENT_DATE);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales revenue for each category?"}, {"role": "assistant", "content": "SELECT categories.CategoryName, SUM([Order Details].Quantity * [Order Details].UnitPrice) AS TotalSales FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN categories ON products.CategoryID = categories.CategoryID GROUP BY categories.CategoryName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers placed orders in January that were shipped by a specific shipping method?"}, {"role": "assistant", "content": "SELECT DISTINCT customers.CompanyName FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID WHERE EXTRACT(MONTH FROM orders.OrderDate) = 1 AND orders.ShipVia = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total potential revenue for products in stock."}, {"role": "assistant", "content": "SELECT SUM(products.UnitPrice * products.UnitsInStock) AS TotalPotentialRevenue FROM products WHERE products.Discontinued = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many returning customers were there in 2023?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT o1.CustomerID) AS returning_customers FROM orders o1 WHERE o1.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' AND o1.CustomerID IN (SELECT DISTINCT o2.CustomerID FROM orders o2 WHERE o2.OrderDate < '2023-01-01')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee has generated the highest total sales?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the Customer Lifetime Value for each customer."}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average lead time for each supplier's deliveries?"}, {"role": "assistant", "content": "SELECT s.CompanyName, AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AverageLeadTime FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY s.CompanyName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total discount given per month in 2023?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, SUM(UnitPrice * Quantity * Discount) AS TotalDiscount FROM orders O JOIN [Order Details] OD ON O.OrderID = OD.OrderID WHERE YEAR(OrderDate) = 2023 GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the product with the highest inventory turnover ratio?"}, {"role": "assistant", "content": "SELECT p.ProductName FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName ORDER BY SUM(od.Quantity * od.UnitPrice) / NULLIF(AVG(p.UnitsInStock), 0) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many units of each product are on order?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName, UnitsOnOrder FROM products WHERE UnitsOnOrder > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were fulfilled on time this month?"}, {"role": "assistant", "content": "SELECT COUNT(orders.OrderID) AS on_time_orders FROM orders WHERE orders.ShippedDate <= orders.RequiredDate AND MONTH(orders.ShippedDate) = MONTH(CURRENT_DATE) AND YEAR(orders.ShippedDate) = YEAR(CURRENT_DATE)"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the trend in the number of orders over time?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, COUNT(OrderID) AS OrderCount FROM orders GROUP BY Month ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find products with a sales decline over the past three months."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE od.OrderID IN (SELECT OrderID FROM orders WHERE OrderDate BETWEEN DATEADD(MONTH, -3, CURRENT_DATE) AND CURRENT_DATE) GROUP BY p.ProductID, p.ProductName HAVING SUM(CASE WHEN OrderDate >= DATEADD(MONTH, -1, CURRENT_DATE) THEN od.Quantity ELSE 0 END) < SUM(CASE WHEN OrderDate < DATEADD(MONTH, -1, CURRENT_DATE) THEN od.Quantity ELSE 0 END) ORDER BY SUM(od.Quantity) DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average time taken to fulfill orders each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY Month ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of orders were placed by returning customers?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT o.CustomerID) * 100.0 / (SELECT COUNT(DISTINCT CustomerID) FROM orders WHERE OrderDate < DATE_SUB(CURDATE(), INTERVAL 1 YEAR)) AS ReturningCustomerPercentage FROM orders o WHERE YEAR(o.OrderDate) = YEAR(CURDATE()) AND o.CustomerID IN (SELECT CustomerID FROM orders WHERE OrderDate < DATE_SUB(CURDATE(), INTERVAL 1 YEAR));"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How much revenue did each region generate?"}, {"role": "assistant", "content": "SELECT ShipRegion, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS Revenue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee has the highest total sales so far this year?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE YEAR(o.OrderDate) = YEAR(CURRENT_DATE) GROUP BY e.EmployeeID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 3 employees by sales amount?"}, {"role": "assistant", "content": "SELECT EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS SalesAmount FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY EmployeeID ORDER BY SalesAmount DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee had the highest sales last month?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE MONTH(orders.OrderDate) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH) AND YEAR(orders.OrderDate) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH) GROUP BY employees.EmployeeID ORDER BY TotalSales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the shipping cost per order for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(Freight) AS avg_shipping_cost FROM orders GROUP BY ShipVia"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the products with below-average sales but above-average stock levels?"}, {"role": "assistant", "content": "SELECT ProductName FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY ProductName HAVING SUM(Quantity) < (SELECT AVG(total_quantity) FROM (SELECT SUM(Quantity) AS total_quantity FROM [Order Details] GROUP BY ProductID) AS subquery) AND AVG(products.UnitsInStock) > (SELECT AVG(UnitsInStock) FROM products)"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product had the highest sales volume last quarter?"}, {"role": "assistant", "content": "SELECT od.ProductID, SUM(od.Quantity) AS TotalQuantity FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID WHERE QUARTER(o.OrderDate) = QUARTER(CURDATE() - INTERVAL 3 MONTH) AND YEAR(o.OrderDate) = YEAR(CURDATE() - INTERVAL 3 MONTH) GROUP BY od.ProductID ORDER BY TotalQuantity DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the total sales for each shipping country?"}, {"role": "assistant", "content": "SELECT ShipCountry, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the rate of orders with a fulfillment time under 5 days?"}, {"role": "assistant", "content": "SELECT (CAST(COUNT(CASE WHEN DATEDIFF(ShippedDate, OrderDate) < 5 THEN OrderID END) AS FLOAT) / COUNT(OrderID)) * 100 AS QuickFulfillmentRate FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Who are the top 5 sales employees based on total sales?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID ORDER BY TotalSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average age of employees?"}, {"role": "assistant", "content": "SELECT AVG(TIMESTAMPDIFF(YEAR, BirthDate, CURDATE())) AS AvgAge FROM employees;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders have been shipped late?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM orders WHERE orders.ShippedDate > orders.RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have the highest average monthly sales growth?"}, {"role": "assistant", "content": "SELECT ProductID, (SUM([Order Details].Quantity) / COUNT(DISTINCT EXTRACT(YEAR_MONTH FROM order_date))) AS AvgMonthlySalesGrowth FROM [Order Details] GROUP BY ProductID ORDER BY AvgMonthlySalesGrowth DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the month with the highest sales volume."}, {"role": "assistant", "content": "SELECT EXTRACT(YEAR FROM orders.order_date) AS Year, EXTRACT(MONTH FROM orders.order_date) AS Month, SUM([Order Details].Quantity) AS TotalSalesVolume FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY Year, Month ORDER BY TotalSalesVolume DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees have not processed any orders?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID FROM employees LEFT JOIN orders ON employees.EmployeeID = orders.EmployeeID WHERE orders.OrderID IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders have been delivered on time?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) FROM orders WHERE ShippedDate <= RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find products with the highest unit price and lowest quantity in stock."}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE UnitsInStock = (SELECT MIN(UnitsInStock) FROM products) ORDER BY UnitPrice DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many unique customers placed orders each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, COUNT(DISTINCT CustomerID) AS UniqueCustomers FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of orders are completed without any discount?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT OrderID) * 1.0 / NULLIF((SELECT COUNT(DISTINCT OrderID) FROM [Order Details]), 0) AS NoDiscountRate FROM [Order Details] WHERE Discount = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier has the shortest average lead time?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_lead_time FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID JOIN products ON [Order Details].ProductID = products.ProductID JOIN suppliers ON products.SupplierID = suppliers.SupplierID GROUP BY suppliers.SupplierID ORDER BY avg_lead_time ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify suppliers with more than five discontinued products."}, {"role": "assistant", "content": "SELECT s.SupplierID FROM products p JOIN suppliers s ON p.SupplierID = s.SupplierID WHERE p.Discontinued = 1 GROUP BY s.SupplierID HAVING COUNT(p.ProductID) > 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify cities with the highest average order fulfillment time."}, {"role": "assistant", "content": "SELECT ShipCity, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY ShipCity ORDER BY AvgFulfillmentTime DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average freight cost for orders shipped in December?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AverageFreightCost FROM orders WHERE EXTRACT(MONTH FROM ShippedDate) = 12"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total revenue generated from orders in the last month?"}, {"role": "assistant", "content": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATE_TRUNC('month', CURRENT_DATE - INTERVAL '1 month') AND o.OrderDate < DATE_TRUNC('month', CURRENT_DATE);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the inventory turnover ratio for the electronics category in 2023?"}, {"role": "assistant", "content": "SELECT SUM(od.Quantity * od.UnitPrice) / AVG(p.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID JOIN categories c ON p.CategoryID = c.CategoryID JOIN orders o ON od.OrderID = o.OrderID WHERE c.CategoryName = 'Electronics' AND YEAR(o.OrderDate) = 2023"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 5 countries in terms of supplier presence?"}, {"role": "assistant", "content": "SELECT Country, COUNT(DISTINCT SupplierID) AS SupplierCount FROM suppliers GROUP BY Country ORDER BY SupplierCount DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which categories have the highest number of discontinued products?"}, {"role": "assistant", "content": "SELECT CategoryID, COUNT(*) AS DiscontinuedCount FROM products WHERE Discontinued = 1 GROUP BY CategoryID ORDER BY DiscontinuedCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product has generated the highest revenue?"}, {"role": "assistant", "content": "SELECT ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM [Order Details] GROUP BY ProductID ORDER BY TotalRevenue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product generated the highest revenue last quarter?"}, {"role": "assistant", "content": "SELECT od.ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS Revenue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE QUARTER(o.OrderDate) = QUARTER(CURRENT_DATE) - 1 AND YEAR(o.OrderDate) = YEAR(CURRENT_DATE) GROUP BY od.ProductID ORDER BY Revenue DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product categories generate the most revenue?"}, {"role": "assistant", "content": "SELECT p.CategoryID, SUM(od.Quantity * od.UnitPrice * (1 - od.Discount)) AS Revenue FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.CategoryID ORDER BY Revenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the monthly sales performance for each product?"}, {"role": "assistant", "content": "SELECT ProductName, SUM([Order Details].Quantity) AS MonthlySales, EXTRACT(MONTH FROM OrderDate) AS Month FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY ProductName, Month ORDER BY ProductName, Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How does the sales quantity for a product change each month?"}, {"role": "assistant", "content": "SELECT P.ProductID, EXTRACT(MONTH FROM O.OrderDate) AS Month, SUM(OD.Quantity) AS MonthlyQuantity FROM [Order Details] OD JOIN products P ON OD.ProductID = P.ProductID JOIN orders O ON OD.OrderID = O.OrderID GROUP BY P.ProductID, EXTRACT(MONTH FROM O.OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify trends in product sales over the last year using monthly data."}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM OrderDate) AS Month, ProductID, SUM(Quantity) AS TotalSold FROM [Order Details] WHERE OrderDate >= DATEADD(YEAR, -1, CURRENT_DATE) GROUP BY EXTRACT(MONTH FROM OrderDate), ProductID ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the growth rate of sales for each employee over the past year?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, (SUM(CASE WHEN YEAR(o.OrderDate) = YEAR(CURRENT_DATE) THEN od.UnitPrice * od.Quantity * (1 - od.Discount) ELSE 0 END) - SUM(CASE WHEN YEAR(o.OrderDate) = YEAR(CURRENT_DATE) - 1 THEN od.UnitPrice * od.Quantity * (1 - od.Discount) ELSE 0 END)) / NULLIF(SUM(CASE WHEN YEAR(o.OrderDate) = YEAR(CURRENT_DATE) - 1 THEN od.UnitPrice * od.Quantity * (1 - od.Discount) ELSE 0 END), 0) AS GrowthRate FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the orders shipped with discount greater than 10%."}, {"role": "assistant", "content": "SELECT OrderID FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE [Order Details].Discount > 0.10;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the monthly trend of order values for the top 3 customers by sales?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, DATE_TRUNC('month', orders.OrderDate) AS month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID, month ORDER BY order_value DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total quantity ordered for discontinued products?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS TotalQuantity FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE p.Discontinued = 1 GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many distinct customers made a purchase in Q1 2023 versus Q2 2023?"}, {"role": "assistant", "content": "SELECT (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-03-31') AS Q1_customers, (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-04-01' AND '2023-06-30') AS Q2_customers"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average shipping time for orders shipped to each region?"}, {"role": "assistant", "content": "SELECT ShipRegion, AVG(DATE_PART('day', ShippedDate - OrderDate)) AS AvgShipTime FROM orders GROUP BY ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total discount given on all orders each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(o.OrderDate, '%Y-%m') AS Month, SUM(od.UnitPrice * od.Quantity * od.Discount) AS TotalDiscount FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top five cities with the highest sales revenue?"}, {"role": "assistant", "content": "SELECT ShipCity, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS CitySales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY ShipCity ORDER BY CitySales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount offered on products?"}, {"role": "assistant", "content": "SELECT AVG(Discount) FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of products that are out of stock?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM products WHERE UnitsInStock = 0"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customer generated the most revenue last year?"}, {"role": "assistant", "content": "SELECT c.CustomerID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= '2022-01-01' AND o.OrderDate <= '2022-12-31' GROUP BY c.CustomerID ORDER BY TotalRevenue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many distinct products have been sold?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT ProductID) FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average time taken to fulfill orders per month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(orders.OrderDate, '%Y-%m') AS month, AVG(DATE_DIFF(orders.ShippedDate, orders.OrderDate)) AS avg_fulfillment_time FROM orders GROUP BY month"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total order quantity for each product?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].Quantity) AS TotalQuantity FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales for each product?"}, {"role": "assistant", "content": "SELECT [Order Details].ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM [Order Details] GROUP BY [Order Details].ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product generates the highest revenue?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(UnitPrice * Quantity * (1 - Discount)) AS TotalRevenue FROM [Order Details] GROUP BY ProductID ORDER BY TotalRevenue DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average fulfillment time for orders in 2023?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_fulfillment_time FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which category of products generated the most sales in 2023?"}, {"role": "assistant", "content": "SELECT categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS sales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN categories ON products.CategoryID = categories.CategoryID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY categories.CategoryName ORDER BY sales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the trend of total sales revenue over the past year?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY DATE_FORMAT(OrderDate, '%Y-%m') ORDER BY DATE_FORMAT(OrderDate, '%Y-%m') DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the products with the largest discrepancies between units on order and units in stock."}, {"role": "assistant", "content": "SELECT ProductID, ProductName, UnitsOnOrder - UnitsInStock AS Discrepancy FROM products ORDER BY Discrepancy DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers have the lowest average lead time for delivery?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_lead_time FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN products ON [Order Details].ProductID = products.ProductID JOIN suppliers ON products.SupplierID = suppliers.SupplierID GROUP BY suppliers.CompanyName ORDER BY avg_lead_time ASC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the growth rate in customer orders year over year?"}, {"role": "assistant", "content": "SELECT EXTRACT(YEAR FROM o.OrderDate) AS Year, COUNT(o.OrderID) AS OrderCount, COUNT(o.OrderID) - LAG(COUNT(o.OrderID)) OVER (ORDER BY EXTRACT(YEAR FROM o.OrderDate)) AS OrderGrowth FROM orders o GROUP BY EXTRACT(YEAR FROM o.OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales generated by employees hired in the last five years?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE employees.HireDate >= DATE_SUB(CURRENT_DATE, INTERVAL 5 YEAR) GROUP BY employees.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total quantity ordered for products with discontinued status?"}, {"role": "assistant", "content": "SELECT SUM(Quantity) FROM [Order Details] INNER JOIN products ON [Order Details].ProductID = products.ProductID WHERE products.Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order fulfillment time for the last 6 months?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders WHERE orders.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 6 MONTH)"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List orders with a required date earlier than the order date."}, {"role": "assistant", "content": "SELECT OrderID FROM orders WHERE RequiredDate < OrderDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of orders shipped by each shipping method per employee?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, ShipVia, COUNT(orders.OrderID) AS ShippedOrders FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID GROUP BY employees.EmployeeID, ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have received the highest total discount amounts?"}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].UnitPrice * [Order Details].Discount * [Order Details].Quantity) AS Total_Discount FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductName ORDER BY Total_Discount DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the difference in total revenue between 2021 and 2022?"}, {"role": "assistant", "content": "SELECT (SUM(CASE WHEN YEAR(OrderDate) = 2022 THEN od.UnitPrice * od.Quantity * (1 - od.Discount) ELSE 0 END) - SUM(CASE WHEN YEAR(OrderDate) = 2021 THEN od.UnitPrice * od.Quantity * (1 - od.Discount) ELSE 0 END)) AS RevenueDifference FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers have placed more than 10 orders?"}, {"role": "assistant", "content": "SELECT CustomerID FROM orders GROUP BY CustomerID HAVING COUNT(OrderID) > 10;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify employees who report to a specific manager."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, employees.FirstName, employees.LastName FROM employees WHERE employees.ReportsTo = ?;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have the highest inventory turnover ratio?"}, {"role": "assistant", "content": "SELECT products.ProductID, (SUM([Order Details].Quantity * [Order Details].UnitPrice) / NULLIF(AVG(products.UnitsInStock), 0)) AS InventoryTurnoverRatio FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductID ORDER BY InventoryTurnoverRatio DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount applied per unit across all orders?"}, {"role": "assistant", "content": "SELECT AVG(od.Discount) AS AverageDiscount FROM [Order Details] od;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many products have more units on order than in stock?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM products WHERE UnitsOnOrder > UnitsInStock;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount given per order item?"}, {"role": "assistant", "content": "SELECT AVG([Order Details].Discount) AS avg_discount_given FROM [Order Details]"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has the highest average shipping cost per order?"}, {"role": "assistant", "content": "SELECT ShipCity, AVG(Freight) AS AverageFreight FROM orders GROUP BY ShipCity ORDER BY AverageFreight DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What proportion of customers are from a specific demographic type?"}, {"role": "assistant", "content": "SELECT customerDemographics.CustomerDesc, COUNT(customers.CustomerID) AS customer_count, COUNT(customers.CustomerID) * 1.0 / (SELECT COUNT(*) FROM customers) AS proportion FROM customerCustomerDemo JOIN customers ON customerCustomerDemo.CustomerID = customers.CustomerID JOIN customerDemographics ON customerCustomerDemo.CustomerTypeID = customerDemographics.CustomerTypeID GROUP BY customerDemographics.CustomerDesc"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the correlation between employee sales and order fulfillment time?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_fulfillment_time, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID ORDER BY employee_sales DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Name suppliers who have never been involved in any orders."}, {"role": "assistant", "content": "SELECT suppliers.CompanyName FROM suppliers WHERE suppliers.SupplierID NOT IN (SELECT DISTINCT products.SupplierID FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 5 products by units sold?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS TotalSold FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductName ORDER BY TotalSold DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders require shipping but have not yet been shipped per employee?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, COUNT(orders.OrderID) AS UnshippedOrders FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID WHERE orders.ShippedDate IS NULL AND orders.RequiredDate IS NOT NULL GROUP BY employees.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product categories are generating the most revenue?"}, {"role": "assistant", "content": "SELECT categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS revenue FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN categories ON products.CategoryID = categories.CategoryID GROUP BY categories.CategoryName ORDER BY revenue DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify products that have never been ordered."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which month had the highest total sales revenue in 2023?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(OrderDate) = 2023 GROUP BY DATE_FORMAT(OrderDate, '%Y-%m') ORDER BY total_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have a high sales volume due to specific employees?"}, {"role": "assistant", "content": "SELECT [Order Details].ProductID, employees.EmployeeID, SUM([Order Details].Quantity) AS TotalQuantity FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY [Order Details].ProductID, employees.EmployeeID HAVING SUM([Order Details].Quantity) > 1000;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees have sales in more than three different countries?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(DISTINCT o.ShipCountry) AS Countries FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID HAVING Countries > 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which region experiences the most delays in shipments?"}, {"role": "assistant", "content": "SELECT ShipRegion, COUNT(OrderID) AS DelayedShipments FROM orders WHERE ShippedDate > RequiredDate GROUP BY ShipRegion ORDER BY DelayedShipments DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which category of products has the highest number of units sold?"}, {"role": "assistant", "content": "SELECT CategoryID, SUM([Order Details].Quantity) AS TotalSold FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY CategoryID ORDER BY TotalSold DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify products below their reorder levels."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product category has the highest average unit price?"}, {"role": "assistant", "content": "SELECT categories.CategoryName, AVG(products.UnitPrice) AS avg_unit_price FROM products JOIN categories ON products.CategoryID = categories.CategoryID GROUP BY categories.CategoryName ORDER BY avg_unit_price DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of products are currently discontinued?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN products.Discontinued = 1 THEN 1 END) * 100.0 / COUNT(products.ProductID) AS discontinued_percentage FROM products"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customer has placed the highest number of orders?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS NumberOfOrders FROM orders GROUP BY CustomerID ORDER BY NumberOfOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales generated by each employee in 2023?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the employees who have a higher salary than the average salary."}, {"role": "assistant", "content": "SELECT EmployeeID, CONCAT(FirstName, ' ', LastName) AS EmployeeName FROM employees WHERE Salary > (SELECT AVG(Salary) FROM employees);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of orders handled by each employee?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(*) AS OrdersHandled FROM orders GROUP BY EmployeeID ORDER BY OrdersHandled DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the names and unit prices of all products that are currently in stock?"}, {"role": "assistant", "content": "SELECT ProductName, UnitPrice FROM products WHERE UnitsInStock > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the on-time delivery rate per month?"}, {"role": "assistant", "content": "SELECT TO_CHAR(orders.OrderDate, 'YYYY-MM') AS Month, COUNT(CASE WHEN orders.ShippedDate <= orders.RequiredDate THEN 1 END) * 1.0 / COUNT(orders.OrderID) AS OnTimeDeliveryRate FROM orders GROUP BY TO_CHAR(orders.OrderDate, 'YYYY-MM')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers have the slowest lead times in the last year?"}, {"role": "assistant", "content": "SELECT s.SupplierID, AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS avg_lead_time FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID JOIN products p ON od.ProductID = p.ProductID JOIN suppliers s ON p.SupplierID = s.SupplierID WHERE o.OrderDate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY s.SupplierID ORDER BY avg_lead_time DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What was the average time taken to fulfill orders each month?"}, {"role": "assistant", "content": "SELECT EXTRACT(YEAR FROM OrderDate) AS Year, EXTRACT(MONTH FROM OrderDate) AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY Year, Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total revenue generated by each product."}, {"role": "assistant", "content": "SELECT ProductName, SUM([Order Details].Quantity * [Order Details].UnitPrice) AS TotalRevenue FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the customer retention rate for Q2 2023?"}, {"role": "assistant", "content": "SELECT (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-04-01' AND '2023-06-30')::FLOAT / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-04-01') AS retention_rate"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have never been ordered?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName FROM products p LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE od.OrderID IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify customers with orders shipped within 7 days of the order date."}, {"role": "assistant", "content": "SELECT c.CustomerID, o.OrderID FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID WHERE DATEDIFF(o.ShippedDate, o.OrderDate) <= 7;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 3 shipping addresses based on frequency of deliveries?"}, {"role": "assistant", "content": "SELECT ShipAddress, COUNT(*) AS DeliveryCount FROM orders GROUP BY ShipAddress ORDER BY DeliveryCount DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many products from each supplier are on order?"}, {"role": "assistant", "content": "SELECT p.SupplierID, COUNT(*) AS ProductsOnOrder FROM products p WHERE p.UnitsOnOrder > 0 GROUP BY p.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the top 5 best-selling products based on order quantity."}, {"role": "assistant", "content": "SELECT ProductID, ProductName, SUM(Quantity) AS TotalQuantity FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY ProductID, ProductName ORDER BY TotalQuantity DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the least sold product and the number of units sold."}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS TotalSold FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY TotalSold ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee generated the most sales revenue in 2023?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY employees.EmployeeID ORDER BY employee_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the average discount given to products per month."}, {"role": "assistant", "content": "SELECT MONTH(OrderDate) AS Month, AVG(Discount) AS AvgDiscount FROM [Order Details] GROUP BY MONTH(OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total value of current inventory for each supplier?"}, {"role": "assistant", "content": "SELECT SupplierID, SUM(UnitsInStock * UnitPrice) AS InventoryValue FROM products GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List all customers who placed orders in the first quarter of 2023."}, {"role": "assistant", "content": "SELECT DISTINCT customers.CustomerID FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-03-31';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average freight cost of all orders?"}, {"role": "assistant", "content": "SELECT AVG(o.Freight) AS AvgFreightCost FROM orders o;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost for orders handled by each employee?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM(orders.Freight) AS TotalFreight FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the monthly trend of quantities sold for each product."}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, p.ProductName, SUM(od.Quantity) AS MonthlyQuantity FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY DATE_TRUNC('month', OrderDate), p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many units of each product were sold monthly?"}, {"role": "assistant", "content": "SELECT products.ProductID, DATE_TRUNC('month', orders.OrderDate) AS order_month, SUM([Order Details].Quantity) AS units_sold FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY products.ProductID, order_month"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total potential revenue from products not yet ordered?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * UnitsInStock) AS PotentialRevenue FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the top 3 countries by total supplier revenue."}, {"role": "assistant", "content": "SELECT suppliers.Country, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS CountryRevenue FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY suppliers.Country ORDER BY CountryRevenue DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee has generated the highest sales revenue?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, CONCAT(employees.FirstName, ' ', employees.LastName) AS EmployeeName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order fulfillment time in days for each month?"}, {"role": "assistant", "content": "SELECT EXTRACT(YEAR FROM OrderDate) AS Year, EXTRACT(MONTH FROM OrderDate) AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY Year, Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How does the on-time delivery rate vary by region?"}, {"role": "assistant", "content": "SELECT ShipRegion, (COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END) * 1.0 / COUNT(OrderID)) * 100 AS on_time_delivery_rate FROM orders GROUP BY ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How does the average order value change per region?"}, {"role": "assistant", "content": "SELECT c.Region, AVG(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS AvgOrderValue FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.Region"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of orders shipped on time by each employee?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, COUNT(orders.OrderID) AS OnTimeOrders FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID WHERE orders.ShippedDate <= orders.RequiredDate GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How much total revenue did each product category generate in 2023?"}, {"role": "assistant", "content": "SELECT c.CategoryName, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS total_revenue FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID JOIN categories c ON p.CategoryID = c.CategoryID JOIN orders o ON od.OrderID = o.OrderID WHERE YEAR(o.OrderDate) = 2023 GROUP BY c.CategoryName"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the top 5 products with the highest sales revenue."}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity * od.UnitPrice) AS SalesRevenue FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName ORDER BY SalesRevenue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier provides the maximum number of products?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, COUNT(products.ProductID) AS TotalProducts FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID GROUP BY suppliers.CompanyName ORDER BY TotalProducts DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which month has the highest on-time delivery rate?"}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM OrderDate) AS Month, (COUNT(CASE WHEN ShippedDate <= RequiredDate THEN OrderID END) * 100.0 / COUNT(OrderID)) AS OnTimeRate FROM orders GROUP BY Month ORDER BY OnTimeRate DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total sales and total discount for each product."}, {"role": "assistant", "content": "SELECT ProductID, SUM(UnitPrice * Quantity * (1 - Discount)) AS TotalSales, SUM(UnitPrice * Quantity * Discount) AS TotalDiscount FROM [Order Details] GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the average unit price of products supplied by each supplier."}, {"role": "assistant", "content": "SELECT SupplierID, AVG(UnitPrice) AS AverageUnitPrice FROM products GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which region has the highest total sales?"}, {"role": "assistant", "content": "SELECT Region, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY Region ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping method tends to have the fastest fulfillment time?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY ShipVia ORDER BY AvgFulfillmentTime ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales revenue generated monthly?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(orders.OrderDate, '%Y-%m') AS month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY month"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify suppliers whose products have the lowest average inventory."}, {"role": "assistant", "content": "SELECT SupplierID, AVG(UnitsInStock) AS AverageInventory FROM products GROUP BY SupplierID ORDER BY AverageInventory ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has the largest number of employees based on their address?"}, {"role": "assistant", "content": "SELECT City, COUNT(EmployeeID) AS EmployeeCount FROM employees GROUP BY City ORDER BY EmployeeCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which orders include products that are currently out of stock?"}, {"role": "assistant", "content": "SELECT DISTINCT OrderID FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID WHERE products.UnitsInStock = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped with each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(*) AS OrdersShipped FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which orders were delivered on time in 2023?"}, {"role": "assistant", "content": "SELECT orders.OrderID FROM orders WHERE orders.ShippedDate <= orders.RequiredDate AND orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were placed by each customer in the last year?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS OrderCount FROM orders WHERE OrderDate >= DATEADD(year, -1, CURRENT_DATE) GROUP BY CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average unit price for products from each supplier?"}, {"role": "assistant", "content": "SELECT s.SupplierID, AVG(p.UnitPrice) AS AverageUnitPrice FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID GROUP BY s.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many units of each product have been ordered so far?"}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].Quantity) AS TotalOrdered FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the current stock level of each product?"}, {"role": "assistant", "content": "SELECT ProductName, UnitsInStock FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify products that need to be reordered based on their reorder level."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock <= ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customer placed the most orders?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS OrderCount FROM orders GROUP BY CustomerID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List all products that are currently out of stock."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order fulfillment time by region?"}, {"role": "assistant", "content": "SELECT ShipRegion, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has the highest number of returning customers?"}, {"role": "assistant", "content": "SELECT customers.City, COUNT(DISTINCT orders.CustomerID) AS returning_customers FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID WHERE orders.CustomerID IN (SELECT o.CustomerID FROM orders o WHERE o.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') AND orders.OrderDate < '2023-01-01' GROUP BY customers.City ORDER BY returning_customers DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average number of days late for orders shipped past the required date?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, RequiredDate)) AS AvgDaysLate FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee has generated the highest sales revenue this year?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE YEAR(o.OrderDate) = YEAR(CURRENT_DATE) GROUP BY e.EmployeeID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List all orders where the freight cost exceeded $100."}, {"role": "assistant", "content": "SELECT * FROM orders WHERE Freight > 100;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which month had the highest number of late deliveries?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', ShippedDate) AS Month, COUNT(CASE WHEN ShippedDate > RequiredDate THEN 1 END) AS LateDeliveries FROM orders GROUP BY Month ORDER BY LateDeliveries DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier has the highest total revenue from product sales?"}, {"role": "assistant", "content": "SELECT s.CompanyName, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.CompanyName ORDER BY TotalRevenue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the top 3 employees by total sales in 2023."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, employees.FirstName, employees.LastName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY employees.EmployeeID, employees.FirstName, employees.LastName ORDER BY total_sales DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipper was used the most last year?"}, {"role": "assistant", "content": "SELECT o.ShipVia, COUNT(o.OrderID) AS ShipCount FROM orders o WHERE o.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY o.ShipVia ORDER BY ShipCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Who are the top five customers by total ordered quantity?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].Quantity) AS TotalQuantity FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID ORDER BY TotalQuantity DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Compare shipping costs across different shipping companies."}, {"role": "assistant", "content": "SELECT shippers.CompanyName, AVG(orders.Freight) AS avg_shipping_cost FROM shippers JOIN orders ON shippers.ShipperID = orders.ShipVia GROUP BY shippers.CompanyName"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many units of discontinued products are still in stock?"}, {"role": "assistant", "content": "SELECT SUM(UnitsInStock) FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the most recent order details for a specific customer."}, {"role": "assistant", "content": "SELECT customers.CustomerID, orders.OrderID, orders.OrderDate FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID WHERE customers.CustomerID = 'specific_customer_id' ORDER BY orders.OrderDate DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the product with the largest discrepancy between units in stock and on order."}, {"role": "assistant", "content": "SELECT ProductName FROM products ORDER BY ABS(UnitsInStock - UnitsOnOrder) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the monthly shipping costs across different shipping methods?"}, {"role": "assistant", "content": "SELECT EXTRACT(YEAR FROM orders.OrderDate) AS year, EXTRACT(MONTH FROM orders.OrderDate) AS month, orders.ShipVia, AVG(orders.Freight) AS avg_shipping_cost FROM orders GROUP BY year, month, orders.ShipVia"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the customers with the highest order frequency in the last year."}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS OrderFrequency FROM orders WHERE OrderDate > CURRENT_DATE - INTERVAL '1 year' GROUP BY CustomerID ORDER BY OrderFrequency DESC LIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total revenue contribution from each supplier?"}, {"role": "assistant", "content": "SELECT s.SupplierID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the average reorder level for each category."}, {"role": "assistant", "content": "SELECT c.CategoryName, AVG(p.ReorderLevel) AS AverageReorderLevel FROM products p JOIN categories c ON p.CategoryID = c.CategoryID GROUP BY c.CategoryName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the product performance metric for the last six months?"}, {"role": "assistant", "content": "SELECT p.ProductID, SUM(od.Quantity) AS PerformanceMetric FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE od.OrderDate >= DATEADD(month, -6, CURRENT_DATE) GROUP BY p.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the trend of average order value over the past year?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(orders.OrderDate, '%Y-%m') AS month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS average_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE() GROUP BY month ORDER BY month"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the total number of orders for each product."}, {"role": "assistant", "content": "SELECT products.ProductName, COUNT(DISTINCT [Order Details].OrderID) AS TotalOrders FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductName"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping company has the highest average freight cost?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(Freight) AS avg_freight FROM orders GROUP BY ShipVia ORDER BY avg_freight DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the employee with the most orders shipped before the required date."}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, COUNT(o.OrderID) as EarlyShipments FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.ShippedDate < o.RequiredDate GROUP BY e.EmployeeID, e.FirstName, e.LastName ORDER BY EarlyShipments DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the average discount given per order."}, {"role": "assistant", "content": "SELECT AVG(od.Discount) AS AvgDiscount FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many unique products have been ordered in the last year?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT ProductID) FROM [Order Details] o JOIN orders ON o.OrderID = orders.OrderID WHERE EXTRACT(YEAR FROM orders.OrderDate) = EXTRACT(YEAR FROM CURRENT_DATE) - 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost for orders shipped in the last quarter?"}, {"role": "assistant", "content": "SELECT SUM(Freight) AS TotalFreightCost FROM orders WHERE ShippedDate >= DATE_TRUNC('quarter', CURRENT_DATE) - INTERVAL '3 months';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List products with the highest total sales value."}, {"role": "assistant", "content": "SELECT ProductName, SUM(od.Quantity * od.UnitPrice) AS TotalSales FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY ProductName ORDER BY TotalSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped after the required date?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the monthly trend in sales quantity for each product?"}, {"role": "assistant", "content": "SELECT ProductID, EXTRACT(MONTH FROM OrderDate) AS Month, SUM(Quantity) AS MonthlySales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY ProductID, Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average supplier lead time for each supplier?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS AvgLeadTime FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID JOIN products ON [Order Details].ProductID = products.ProductID JOIN suppliers ON products.SupplierID = suppliers.SupplierID GROUP BY suppliers.SupplierID, suppliers.CompanyName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many unique customers placed orders with discounts greater than 20%?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT orders.CustomerID) FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE [Order Details].Discount > 0.2"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have the highest units on order but are still in stock?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsOnOrder > 0 AND UnitsInStock > 0 ORDER BY UnitsOnOrder DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List the employee sales on each day of a specific month."}, {"role": "assistant", "content": "SELECT e.EmployeeID, o.OrderDate, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS DailySales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE MONTH(o.OrderDate) = %s AND YEAR(o.OrderDate) = %s GROUP BY e.EmployeeID, o.OrderDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify products whose sales volume exceeds 100 units in the past month."}, {"role": "assistant", "content": "SELECT products.ProductName FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID WHERE [Order Details].OrderDate >= DATEADD(month, -1, CURRENT_DATE) GROUP BY products.ProductName HAVING SUM([Order Details].Quantity) > 100;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total revenue for each shipping country."}, {"role": "assistant", "content": "SELECT ShipCountry, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average lead time for each supplier in delivering their products?"}, {"role": "assistant", "content": "SELECT s.SupplierID, AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AverageLeadTime FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY s.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee was hired most recently?"}, {"role": "assistant", "content": "SELECT FirstName, LastName, HireDate FROM employees ORDER BY HireDate DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the total quantity sold for each supplier."}, {"role": "assistant", "content": "SELECT p.SupplierID, SUM(od.Quantity) AS TotalQuantity FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify employees who have processed orders only within a specific country."}, {"role": "assistant", "content": "SELECT e.EmployeeID FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID HAVING COUNT(DISTINCT o.ShipCountry) = 1 AND MAX(o.ShipCountry) = 'Specific Country';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total sales revenue for each supplier for the last quarter."}, {"role": "assistant", "content": "SELECT SupplierID, SUM([Order Details].Quantity * [Order Details].UnitPrice) AS TotalRevenue FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID WHERE QUARTER(OrderDate) = QUARTER(CURDATE()) - 1 GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average shipping cost for each shipping company?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(Freight) AS AvgShippingCost FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average hiring duration of employees in correlation to their sales?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(CURDATE(), e.HireDate)) AS AvgHireDuration, AVG(sales.TotalSales) AS AvgSales FROM employees e JOIN (SELECT o.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.EmployeeID) sales ON e.EmployeeID = sales.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of products were shipped via each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(orders.OrderID) * 100.0 / (SELECT COUNT(*) FROM orders) AS shipping_method_percentage FROM orders GROUP BY ShipVia"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total discount value given for each order?"}, {"role": "assistant", "content": "SELECT od.OrderID, SUM(od.Quantity * od.UnitPrice * od.Discount) AS TotalDiscount FROM [Order Details] od GROUP BY od.OrderID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the correlation between unit price and quantity ordered for each product?"}, {"role": "assistant", "content": "SELECT ProductID, CORR(UnitPrice, Quantity) AS PriceQuantityCorrelation FROM [Order Details] GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most common ship region for orders?"}, {"role": "assistant", "content": "SELECT orders.ShipRegion, COUNT(orders.OrderID) AS RegionCount FROM orders GROUP BY orders.ShipRegion ORDER BY RegionCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the inventory turnover ratio for each product category in June 2023?"}, {"role": "assistant", "content": "SELECT categories.CategoryName, SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN categories ON products.CategoryID = categories.CategoryID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE DATE_FORMAT(orders.OrderDate, '%Y-%m') = '2023-06' GROUP BY categories.CategoryName"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Are there any orders with zero freight costs, and if so, how many?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) FROM orders WHERE Freight = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee has the highest sales in the western region?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, employees.FirstName, employees.LastName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID JOIN employeeTerritories ON employees.EmployeeID = employeeTerritories.EmployeeID JOIN territories ON employeeTerritories.TerritoryID = territories.TerritoryID WHERE territories.RegionID = (SELECT RegionID FROM region WHERE RegionDescription = 'Western') GROUP BY employees.EmployeeID ORDER BY total_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the trend of order fulfillment time over the last year."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders WHERE OrderDate >= DATE_SUB(CURRENT_DATE, INTERVAL 1 YEAR) GROUP BY DATE_FORMAT(OrderDate, '%Y-%m') ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the top 5 customers by lifetime value."}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS LifetimeValue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID ORDER BY LifetimeValue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which month had the highest number of orders?"}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM OrderDate) AS Month, COUNT(OrderID) AS OrderCount FROM orders GROUP BY EXTRACT(MONTH FROM OrderDate) ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of customers are returning customers within the last month?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT CASE WHEN orders.OrderDate BETWEEN CURRENT_DATE - INTERVAL '1 month' AND CURRENT_DATE THEN orders.CustomerID END) / COUNT(DISTINCT orders.CustomerID)) * 100 AS RetentionRate FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID WHERE orders.OrderDate < CURRENT_DATE - INTERVAL '1 month';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of orders placed per month?"}, {"role": "assistant", "content": "SELECT TO_CHAR(o.OrderDate, 'YYYY-MM') AS Month, COUNT(o.OrderID) AS NumberOfOrders FROM orders o GROUP BY TO_CHAR(o.OrderDate, 'YYYY-MM');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the frequency distribution of order quantities?"}, {"role": "assistant", "content": "SELECT Quantity, COUNT(*) AS Frequency FROM [Order Details] GROUP BY Quantity ORDER BY Frequency DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most common shipping method used?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipVia ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average shipping cost per order each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, AVG(Freight) AS AvgShippingCost FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the product with the highest inventory turnover ratio."}, {"role": "assistant", "content": "SELECT p.ProductID, (SUM(od.Quantity * od.UnitPrice) / NULLIF(AVG(p.UnitsInStock), 0)) AS InventoryTurnoverRatio FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY InventoryTurnoverRatio DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the trend of total sales revenue over the quarters?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('quarter', o.OrderDate) AS Quarter, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY Quarter ORDER BY Quarter;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Compute the total inventory value grouped by supplier."}, {"role": "assistant", "content": "SELECT SupplierID, SUM(UnitPrice * UnitsInStock) as InventoryValue FROM products GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify customers who have never received a discount."}, {"role": "assistant", "content": "SELECT CustomerID FROM customers WHERE NOT EXISTS (SELECT 1 FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE customers.CustomerID = o.CustomerID AND od.Discount > 0);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 5 products by sales revenue, and which suppliers provide them?"}, {"role": "assistant", "content": "SELECT od.ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue, p.SupplierID FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY od.ProductID, p.SupplierID ORDER BY TotalRevenue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customer generated the highest revenue in the last year?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE YEAR(orders.OrderDate) = YEAR(CURRENT_DATE) - 1 GROUP BY customers.CustomerID ORDER BY TotalRevenue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average customer rating per order (assuming ratings are stored)?"}, {"role": "assistant", "content": "SELECT OrderID, AVG(Rating) AS AvgRating FROM RatingsTable GROUP BY OrderID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of products are currently discontinued?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN Discontinued = 1 THEN ProductID END) * 1.0 / COUNT(ProductID) * 100) AS PercentageDiscontinued FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of orders were delivered on time in June 2023?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN orders.ShippedDate <= orders.RequiredDate THEN 1 END) * 100.0 / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders WHERE orders.OrderDate BETWEEN '2023-06-01' AND '2023-06-30'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most common discount given on products?"}, {"role": "assistant", "content": "SELECT [Order Details].Discount, COUNT(*) AS count FROM [Order Details] GROUP BY [Order Details].Discount ORDER BY count DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers have placed orders totaling more than $10,000?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSpent FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID HAVING TotalSpent > 10000;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How does the shipping cost vary by region?"}, {"role": "assistant", "content": "SELECT ShipRegion, AVG(Freight) AS AvgShippingCost FROM orders GROUP BY ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product has the highest sales volume this quarter?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].Quantity) AS sales_volume FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE QUARTER(orders.OrderDate) = QUARTER(CURDATE()) AND YEAR(orders.OrderDate) = YEAR(CURDATE()) GROUP BY products.ProductID ORDER BY sales_volume DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total discount amount applied by each employee?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].Discount * [Order Details].UnitPrice * [Order Details].Quantity) AS TotalDiscount FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the sales growth percentage for each employee from the previous month."}, {"role": "assistant", "content": "SELECT e.EmployeeID, ((SUM(CASE WHEN MONTH(o.OrderDate) = 6 THEN [Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount) ELSE 0 END) - SUM(CASE WHEN MONTH(o.OrderDate) = 5 THEN [Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount) ELSE 0 END)) / NULLIF(SUM(CASE WHEN MONTH(o.OrderDate) = 5 THEN [Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount) ELSE 0 END), 0)) * 100 AS GrowthPercentage FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] ON o.OrderID = [Order Details].OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales revenue generated by each supplier?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, suppliers.CompanyName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN suppliers ON products.SupplierID = suppliers.SupplierID GROUP BY suppliers.SupplierID, suppliers.CompanyName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How do discount rates impact the average order value?"}, {"role": "assistant", "content": "SELECT AVG(([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))) AS avg_order_value, [Order Details].Discount FROM [Order Details] GROUP BY [Order Details].Discount"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the maximum, minimum, and average shipping cost for orders shipped within Europe?"}, {"role": "assistant", "content": "SELECT MAX(Freight) AS MaxCost, MIN(Freight) AS MinCost, AVG(Freight) AS AvgCost FROM orders WHERE ShipCountry IN ('France', 'Germany', 'Italy');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List the top 5 products with the highest inventory levels."}, {"role": "assistant", "content": "SELECT ProductName FROM products ORDER BY UnitsInStock DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify employees with a salary above the average and who have generated above-average sales."}, {"role": "assistant", "content": "WITH AvgSalary AS (SELECT AVG(Salary) AS AvgSal FROM employees), AvgSales AS (SELECT AVG(TotalSales) AS AvgEmpSales FROM (SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID) Sub) SELECT e.EmployeeID, e.FirstName, e.LastName FROM employees e JOIN AvgSalary a ON e.Salary > a.AvgSal JOIN (SELECT e2.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS EmpSales FROM employees e2 JOIN orders o2 ON e2.EmployeeID = o2.EmployeeID JOIN [Order Details] od ON o2.OrderID = od.OrderID GROUP BY e2.EmployeeID) s ON e.EmployeeID = s.EmployeeID JOIN AvgSales av ON s.EmpSales > av.AvgEmpSales;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many different customers placed orders in January 2022?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT CustomerID) FROM orders WHERE OrderDate BETWEEN '2022-01-01' AND '2022-01-31';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find products with below-average unit prices."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitPrice < (SELECT AVG(UnitPrice) FROM products);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the most frequently ordered product."}, {"role": "assistant", "content": "SELECT ProductID, COUNT(ProductID) AS OrderFrequency FROM [Order Details] GROUP BY ProductID ORDER BY OrderFrequency DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the products with the highest discount rate."}, {"role": "assistant", "content": "SELECT od.ProductID, MAX(od.Discount) AS MaxDiscount FROM [Order Details] od GROUP BY od.ProductID ORDER BY MaxDiscount DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total value of products currently in stock?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * UnitsInStock) AS TotalStockValue FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average fulfillment time for orders shipped by each method?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AverageFulfillmentTime FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the distribution of employee sales across different regions."}, {"role": "assistant", "content": "SELECT e.EmployeeID, o.ShipRegion, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, o.ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Compare the sales performance of all products per quarter."}, {"role": "assistant", "content": "SELECT p.ProductName, DATE_TRUNC('quarter', o.OrderDate) AS Quarter, SUM(od.Quantity) AS TotalSales FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON o.OrderID = od.OrderID GROUP BY p.ProductName, Quarter;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find orders that were shipped after the required date and provide their details."}, {"role": "assistant", "content": "SELECT * FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order fulfillment time for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(DATEDIFF(ShippedDate, OrderDate)) AS average_fulfillment_time FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales revenue for the current year?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = YEAR(CURRENT_DATE)"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many customers have ordered more than 10 times?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM (SELECT customers.CustomerID FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID GROUP BY customers.CustomerID HAVING COUNT(orders.OrderID) > 10) AS subquery;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales revenue generated by each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity * od.UnitPrice) AS TotalRevenue FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales value generated by each employee in the last month?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND o.OrderDate < CURDATE() GROUP BY e.EmployeeID, e.FirstName, e.LastName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the average order size in terms of total items."}, {"role": "assistant", "content": "SELECT AVG(TotalItems) AS AverageOrderSize FROM (SELECT OrderID, SUM(Quantity) AS TotalItems FROM [Order Details] GROUP BY OrderID) AS OrderSizes;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find employees whose most common shipment destination is outside their country of residence."}, {"role": "assistant", "content": "SELECT e.FirstName, e.LastName, most_common.ShipCountry FROM (SELECT o.EmployeeID, o.ShipCountry, COUNT(*) as cnt, RANK() OVER (PARTITION BY o.EmployeeID ORDER BY COUNT(*) DESC) as rnk FROM orders o GROUP BY o.EmployeeID, o.ShipCountry) as most_common JOIN employees e ON e.EmployeeID = most_common.EmployeeID WHERE most_common.rnk = 1 AND most_common.ShipCountry <> e.Country;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost per region?"}, {"role": "assistant", "content": "SELECT ShipRegion, SUM(Freight) AS TotalFreightCost FROM orders GROUP BY ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify employees with no sales in the last month."}, {"role": "assistant", "content": "SELECT e.EmployeeID FROM employees e LEFT JOIN orders o ON e.EmployeeID = o.EmployeeID AND o.OrderDate >= DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 month' AND o.OrderDate < DATE_TRUNC('month', CURRENT_DATE) WHERE o.OrderID IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How much freight cost did we incur last month?"}, {"role": "assistant", "content": "SELECT SUM(o.Freight) AS TotalFreightLastMonth FROM orders o WHERE o.OrderDate >= DATEADD(MONTH, DATEDIFF(MONTH, 0, CURRENT_DATE) - 1, 0) AND o.OrderDate < DATEADD(MONTH, DATEDIFF(MONTH, 0, CURRENT_DATE), 0);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the average shipping time for orders."}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgShippingTime FROM orders WHERE ShippedDate IS NOT NULL"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers provide products that are currently reordered the most?"}, {"role": "assistant", "content": "SELECT SupplierID, SUM(UnitsOnOrder) AS TotalUnitsOnOrder FROM products WHERE UnitsOnOrder > 0 GROUP BY SupplierID ORDER BY TotalUnitsOnOrder DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the product with the lowest unit price that is not discontinued."}, {"role": "assistant", "content": "SELECT ProductName, UnitPrice FROM products WHERE Discontinued = 0 ORDER BY UnitPrice ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which categories have the highest total sales?"}, {"role": "assistant", "content": "SELECT CategoryID, SUM([Order Details].Quantity * [Order Details].UnitPrice) AS TotalSales FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY CategoryID ORDER BY TotalSales DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product has the highest total sales?"}, {"role": "assistant", "content": "SELECT [Order Details].ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS ProductSales FROM [Order Details] GROUP BY [Order Details].ProductID ORDER BY ProductSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of orders shipped last month?"}, {"role": "assistant", "content": "SELECT COUNT(orders.OrderID) AS Shipped_Orders FROM orders WHERE MONTH(orders.ShippedDate) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH) AND YEAR(orders.ShippedDate) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier is used the least for orders based on total sales?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, CompanyName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY suppliers.SupplierID, CompanyName ORDER BY TotalSales ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount given on orders for each supplier?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, AVG([Order Details].Discount) AS AvgDiscount FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY suppliers.CompanyName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the total sales revenue for each supplier."}, {"role": "assistant", "content": "SELECT s.SupplierID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate total sales per month."}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM orders.OrderDate) AS OrderMonth, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY EXTRACT(MONTH FROM orders.OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many customers are there in each region?"}, {"role": "assistant", "content": "SELECT c.Region, COUNT(c.CustomerID) AS CustomerCount FROM customers c GROUP BY c.Region;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount given on orders per month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(Discount) AS AvgDiscount FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier has the highest number of unique products?"}, {"role": "assistant", "content": "SELECT s.CompanyName, COUNT(DISTINCT p.ProductID) AS UniqueProducts FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID GROUP BY s.SupplierID ORDER BY UniqueProducts DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee handles the most orders shipped late?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS LateOrders FROM orders WHERE ShippedDate > RequiredDate GROUP BY EmployeeID ORDER BY LateOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which country has the highest number of orders?"}, {"role": "assistant", "content": "SELECT ShipCountry, COUNT(OrderID) AS TotalOrders FROM orders GROUP BY ShipCountry ORDER BY TotalOrders DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 5 cities where suppliers are located?"}, {"role": "assistant", "content": "SELECT suppliers.City, COUNT(*) AS SupplierCount FROM suppliers GROUP BY suppliers.City ORDER BY SupplierCount DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify products with the highest average discount."}, {"role": "assistant", "content": "SELECT products.ProductID, AVG([Order Details].Discount) AS AverageDiscount FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductID ORDER BY AverageDiscount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Analyze the correlation between product price and the number of orders received."}, {"role": "assistant", "content": "SELECT P.ProductName, P.UnitPrice, COUNT(OD.OrderID) AS OrderCount FROM [Order Details] OD JOIN products P ON OD.ProductID = P.ProductID GROUP BY P.ProductID, P.ProductName, P.UnitPrice ORDER BY OrderCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees handled the most customer orders?"}, {"role": "assistant", "content": "SELECT o.EmployeeID, COUNT(o.OrderID) AS OrdersHandled FROM orders o GROUP BY o.EmployeeID ORDER BY OrdersHandled DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products are on order but currently discontinued?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE Discontinued = 1 AND UnitsOnOrder > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many unique products does each supplier offer?"}, {"role": "assistant", "content": "SELECT p.SupplierID, COUNT(DISTINCT p.ProductID) AS UniqueProducts FROM products p GROUP BY p.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the on-time delivery rate each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END) * 1.0 / COUNT(OrderID) AS OnTimeDeliveryRate FROM orders GROUP BY Month ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers are located in the same city?"}, {"role": "assistant", "content": "SELECT City, STRING_AGG(DISTINCT SupplierID, ', ') AS SupplierIDs FROM suppliers GROUP BY City HAVING COUNT(DISTINCT SupplierID) > 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees are responsible for the majority of orders in a specific territory?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, CONCAT(employees.FirstName, ' ', employees.LastName) AS EmployeeName, COUNT(orders.OrderID) AS OrderCount FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE orders.ShipRegion = 'SpecificTerritory' GROUP BY employees.EmployeeID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier has the most delayed shipments?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, AVG(DATEDIFF(orders.ShippedDate, orders.RequiredDate)) AS AvgDelay FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.ShippedDate > orders.RequiredDate GROUP BY suppliers.SupplierID ORDER BY AvgDelay DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many unique products has each employee sold?"}, {"role": "assistant", "content": "SELECT E.EmployeeID, COUNT(DISTINCT OD.ProductID) AS UniqueProducts FROM employees E JOIN orders O ON E.EmployeeID = O.EmployeeID JOIN [Order Details] OD ON O.OrderID = OD.OrderID GROUP BY E.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total discount given on all orders?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * Quantity * Discount) AS TotalDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 5 countries generating the most revenue from orders?"}, {"role": "assistant", "content": "SELECT customers.Country, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_revenue FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.Country ORDER BY total_revenue DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped by each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS NumOrders FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the effect of discount on product sales?"}, {"role": "assistant", "content": "SELECT Discount, SUM(Quantity) AS TotalSales FROM [Order Details] GROUP BY Discount ORDER BY Discount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping method has the best on-time delivery rate?"}, {"role": "assistant", "content": "SELECT ShipVia, 100.0 * COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END) / COUNT(OrderID) AS OnTimeRate FROM orders GROUP BY ShipVia ORDER BY OnTimeRate DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which region has the highest total sales?"}, {"role": "assistant", "content": "SELECT Region, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY Region ORDER BY TotalSales DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the correlation between order value and shipping delay?"}, {"role": "assistant", "content": "SELECT CORR(SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) OVER (PARTITION BY orders.OrderID), DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS OrderValueShippingDelayCorrelation FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city received the highest number of shipments?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) FROM orders GROUP BY ShipCity ORDER BY COUNT(OrderID) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List employees who have been hired in the last 5 years."}, {"role": "assistant", "content": "SELECT EmployeeID, FirstName, LastName FROM employees WHERE HireDate >= DATE_SUB(CURDATE(), INTERVAL 5 YEAR);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products are often paired together in orders?"}, {"role": "assistant", "content": "SELECT od1.ProductID, od2.ProductID, COUNT(*) AS PairCount FROM [Order Details] od1 JOIN [Order Details] od2 ON od1.OrderID = od2.OrderID AND od1.ProductID < od2.ProductID GROUP BY od1.ProductID, od2.ProductID ORDER BY PairCount DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify employees who have been with the company for over 10 years."}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName FROM employees e WHERE DATEDIFF(CURRENT_DATE, e.HireDate) > 3650;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has the highest number of shipments?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS ShipmentCount FROM orders GROUP BY ShipCity ORDER BY ShipmentCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the highest discount given to a single product?"}, {"role": "assistant", "content": "SELECT ProductName, [Order Details].Discount FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID WHERE [Order Details].Discount = (SELECT MAX(Discount) FROM [Order Details]) LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders did each employee process last quarter?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) AS OrderCount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.OrderDate BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 3 MONTH) AND CURRENT_DATE GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders are pending shipment as of today?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS PendingOrders FROM orders WHERE ShippedDate IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the impact of discontinued products on total inventory."}, {"role": "assistant", "content": "SELECT SUM(UnitsInStock) FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total order quantity for each product over the past year."}, {"role": "assistant", "content": "SELECT ProductID, SUM(Quantity) AS AnnualOrderQuantity FROM [Order Details] WHERE EXTRACT(YEAR FROM OrderDate) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many different shipping methods have been used to ship orders?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT ShipVia) AS ShippingMethods FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the monthly growth rate of returning customers over the last year?"}, {"role": "assistant", "content": "SELECT ((COUNT(DISTINCT CASE WHEN YEAR(o1.OrderDate) = 2022 THEN o1.CustomerID END) - COUNT(DISTINCT CASE WHEN YEAR(o2.OrderDate) = 2021 THEN o2.CustomerID END)) / NULLIF(COUNT(DISTINCT CASE WHEN YEAR(o2.OrderDate) = 2021 THEN o2.CustomerID END), 0)) * 100 AS monthly_growth FROM orders o1, orders o2 WHERE o1.CustomerID = o2.CustomerID AND YEAR(o1.OrderDate) = 2022 AND YEAR(o2.OrderDate) = 2021;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find out the average discount given for each customer."}, {"role": "assistant", "content": "SELECT customers.CustomerID, AVG([Order Details].Discount) AS AverageDiscount FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the total sales for each employee in a specific region."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE orders.ShipRegion = ? GROUP BY employees.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier supplies the most number of different products?"}, {"role": "assistant", "content": "SELECT s.SupplierID, s.CompanyName, COUNT(DISTINCT p.ProductID) AS NumberOfProducts FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID GROUP BY s.SupplierID ORDER BY NumberOfProducts DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the employee with the longest tenure at the company."}, {"role": "assistant", "content": "SELECT FirstName, LastName, DATEDIFF(NOW(), HireDate) AS Tenure FROM employees ORDER BY Tenure DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost by region?"}, {"role": "assistant", "content": "SELECT o.ShipRegion, SUM(o.Freight) AS TotalFreight FROM orders o GROUP BY o.ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average unit price of products supplied by each supplier?"}, {"role": "assistant", "content": "SELECT SupplierID, AVG(UnitPrice) AS AveragePrice FROM products GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers have received the most customer orders?"}, {"role": "assistant", "content": "SELECT s.CompanyName, COUNT(DISTINCT o.OrderID) AS NumberOfOrders FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY s.CompanyName ORDER BY NumberOfOrders DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of units on order for each product category?"}, {"role": "assistant", "content": "SELECT categories.CategoryID, SUM(products.UnitsOnOrder) FROM products JOIN categories ON products.CategoryID = categories.CategoryID GROUP BY categories.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total quantity ordered for each product supplied by a supplier?"}, {"role": "assistant", "content": "SELECT p.ProductName, s.CompanyName, SUM(od.Quantity) AS TotalQuantity FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN suppliers s ON p.SupplierID = s.SupplierID GROUP BY p.ProductName, s.CompanyName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the customer with the highest single order value."}, {"role": "assistant", "content": "SELECT o.CustomerID, od.OrderID, (od.UnitPrice * od.Quantity * (1 - od.Discount)) AS OrderValue FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID ORDER BY OrderValue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the monthly product performance for each product?"}, {"role": "assistant", "content": "SELECT products.ProductName, EXTRACT(MONTH FROM orders.OrderDate) AS Month, SUM([Order Details].Quantity) AS MonthlyPerformance FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY products.ProductName, EXTRACT(MONTH FROM orders.OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many unique products are ordered each month?"}, {"role": "assistant", "content": "SELECT TO_CHAR(OrderDate, 'YYYY-MM') AS Month, COUNT(DISTINCT ProductID) AS UniqueProducts FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY TO_CHAR(OrderDate, 'YYYY-MM')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders have a shipping cost above $50?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS high_freight_orders FROM orders WHERE Freight > 50"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Is there a trend in shipping delays over the past year?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS month, (COUNT(CASE WHEN ShippedDate > RequiredDate THEN 1 END) * 1.0 / COUNT(*)) * 100 AS delay_rate FROM orders WHERE OrderDate >= DATE_ADD(CURRENT_DATE, INTERVAL -1 YEAR) GROUP BY DATE_TRUNC('month', OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order fulfillment time over the past year?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders WHERE OrderDate >= CURRENT_DATE - INTERVAL '1 year';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total quantity sold for each product category?"}, {"role": "assistant", "content": "SELECT categories.CategoryName, SUM([Order Details].Quantity) AS total_quantity_sold FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN categories ON products.CategoryID = categories.CategoryID GROUP BY categories.CategoryName"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the average salary of employees who have generated over $50,000 in sales."}, {"role": "assistant", "content": "SELECT AVG(e.Salary) AS AvgSalary FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID HAVING SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) > 50000;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers have placed orders more than five times?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, COUNT(orders.OrderID) AS OrderCount FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID GROUP BY customers.CustomerID HAVING COUNT(orders.OrderID) > 5"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Rank customers by the number of orders they have placed."}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS NumberOfOrders FROM orders GROUP BY CustomerID ORDER BY NumberOfOrders DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the average time between order and shipment."}, {"role": "assistant", "content": "SELECT AVG(DATE_PART('day', o.ShippedDate - o.OrderDate)) AS AvgShippingTime FROM orders o WHERE o.ShippedDate IS NOT NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of orders were delivered on time each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, ROUND(100.0 * SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) / COUNT(OrderID), 2) AS OnTimeDeliveryRate FROM orders GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the Total Sales revenue for the last month?"}, {"role": "assistant", "content": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE YEAR(o.OrderDate) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH) AND MONTH(o.OrderDate) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH)"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the distribution of orders across different shipping companies?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipVia ORDER BY OrderCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders did each employee handle last year?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, CONCAT(employees.FirstName, ' ', employees.LastName) AS EmployeeName, COUNT(orders.OrderID) AS OrderCount FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID WHERE YEAR(orders.OrderDate) = YEAR(CURRENT_DATE) - 1 GROUP BY employees.EmployeeID, CONCAT(employees.FirstName, ' ', employees.LastName);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What day of the week do most shipments occur?"}, {"role": "assistant", "content": "SELECT TO_CHAR(ShippedDate, 'Day') AS Weekday, COUNT(OrderID) AS OrderCount FROM orders GROUP BY TO_CHAR(ShippedDate, 'Day') ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales generated by each employee for the current month?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, CONCAT(employees.FirstName, ' ', employees.LastName) AS EmployeeName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE MONTH(orders.OrderDate) = MONTH(CURRENT_DATE) AND YEAR(orders.OrderDate) = YEAR(CURRENT_DATE) GROUP BY employees.EmployeeID, employees.FirstName, employees.LastName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the total sales by supplier in a specific month."}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE DATE_FORMAT(orders.OrderDate, '%Y-%m') = 'specific month' GROUP BY suppliers.CompanyName"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How does the average employee salary compare between different regions?"}, {"role": "assistant", "content": "SELECT Region, AVG(Salary) AS AvgSalary FROM employees GROUP BY Region;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total quantity of products ordered in the last year?"}, {"role": "assistant", "content": "SELECT SUM(od.Quantity) AS TotalQuantityOrdered FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped on or before the required date each month?"}, {"role": "assistant", "content": "SELECT TO_CHAR(ShippedDate, 'YYYY-MM') AS Month, COUNT(OrderID) AS OnTimeOrders FROM orders WHERE ShippedDate <= RequiredDate GROUP BY TO_CHAR(ShippedDate, 'YYYY-MM');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List the top 5 products by revenue."}, {"role": "assistant", "content": "SELECT od.ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM [Order Details] od GROUP BY od.ProductID ORDER BY TotalRevenue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the current total inventory value?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * UnitsInStock) AS TotalInventoryValue FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the distribution of employee salaries by region?"}, {"role": "assistant", "content": "SELECT employees.Region, AVG(employees.Salary) AS AvgSalary FROM employees GROUP BY employees.Region;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find all employees who ship to more than three different countries."}, {"role": "assistant", "content": "SELECT e.EmployeeID FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID HAVING COUNT(DISTINCT o.ShipCountry) > 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee has the highest total sales?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which country has the highest number of customers?"}, {"role": "assistant", "content": "SELECT Country, COUNT(*) AS NumCustomers FROM customers GROUP BY Country ORDER BY NumCustomers DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the revenue contribution of each supplier?"}, {"role": "assistant", "content": "SELECT SupplierID, SUM(od.Quantity * od.UnitPrice) AS SupplierRevenue FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What has been the month-over-month growth in the number of orders?"}, {"role": "assistant", "content": "SELECT EXTRACT(YEAR FROM OrderDate) AS Year, EXTRACT(MONTH FROM OrderDate) AS Month, COUNT(*) AS OrderCount FROM orders GROUP BY Year, Month ORDER BY Year, Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost incurred in the past quarter?"}, {"role": "assistant", "content": "SELECT SUM(Freight) FROM orders WHERE OrderDate BETWEEN DATE_TRUNC('quarter', CURRENT_DATE) - INTERVAL '3 months' AND DATE_TRUNC('quarter', CURRENT_DATE);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many products are currently out of stock?"}, {"role": "assistant", "content": "SELECT COUNT(products.ProductID) AS out_of_stock_products FROM products WHERE products.UnitsInStock = 0"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most common customer region?"}, {"role": "assistant", "content": "SELECT Region, COUNT(CustomerID) AS NumberOfCustomers FROM customers GROUP BY Region ORDER BY NumberOfCustomers DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 5 products in terms of revenue generated?"}, {"role": "assistant", "content": "SELECT od.ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS Revenue FROM [Order Details] od GROUP BY od.ProductID ORDER BY Revenue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the highest freight charges for each country."}, {"role": "assistant", "content": "SELECT ShipCountry, MAX(Freight) AS MaxFreight FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most common city among customers with the highest lifetime value?"}, {"role": "assistant", "content": "SELECT customers.City FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.City ORDER BY SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier provides the most expensive products on average?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, AVG(products.UnitPrice) AS AvgPrice FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID GROUP BY suppliers.SupplierID ORDER BY AvgPrice DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped late (after the required date)?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS LateOrders FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the fastest average shipping method based on fulfillment time?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY ShipVia ORDER BY AvgFulfillmentTime ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most common shipping method for orders with late deliveries?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS LateCount FROM orders WHERE ShippedDate > RequiredDate GROUP BY ShipVia ORDER BY LateCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of discontinued products?"}, {"role": "assistant", "content": "SELECT COUNT(ProductID) AS DiscontinuedProducts FROM products WHERE Discontinued = TRUE;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount provided on products in order history?"}, {"role": "assistant", "content": "SELECT AVG(Discount) AS AverageDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List the most frequently ordered products."}, {"role": "assistant", "content": "SELECT od.ProductID, p.ProductName, COUNT(od.OrderID) AS OrderCount FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY od.ProductID, p.ProductName ORDER BY OrderCount DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top selling products and which employees are associated with these sales?"}, {"role": "assistant", "content": "SELECT [Order Details].ProductID, SUM([Order Details].Quantity) AS TotalQuantity, employees.EmployeeID FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY [Order Details].ProductID, employees.EmployeeID ORDER BY TotalQuantity DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost incurred each month?"}, {"role": "assistant", "content": "SELECT EXTRACT(YEAR FROM OrderDate) AS Year, EXTRACT(MONTH FROM OrderDate) AS Month, SUM(Freight) AS TotalFreight FROM orders GROUP BY Year, Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders have a shipping delay longer than 5 days?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS LongDelays FROM orders WHERE DATEDIFF(ShippedDate, OrderDate) > 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the on-time delivery rate for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(CASE WHEN ShippedDate <= RequiredDate THEN OrderID END) * 100.0 / COUNT(OrderID) AS OnTimeDeliveryRate FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the total units ordered for products with stock less than 10?"}, {"role": "assistant", "content": "SELECT p.ProductID, SUM(od.Quantity) AS TotalUnitsOrdered FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE p.UnitsInStock < 10 GROUP BY p.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the top 3 cities with the highest total revenue."}, {"role": "assistant", "content": "SELECT ShipCity, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY ShipCity ORDER BY TotalRevenue DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped after the required date?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the earliest and latest order dates for each customer."}, {"role": "assistant", "content": "SELECT CustomerID, MIN(OrderDate) AS FirstOrder, MAX(OrderDate) AS LastOrder FROM orders GROUP BY CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most ordered product category this year?"}, {"role": "assistant", "content": "SELECT categories.CategoryID, categories.CategoryName, SUM([Order Details].Quantity) AS TotalOrdered FROM categories INNER JOIN products ON categories.CategoryID = products.CategoryID INNER JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY categories.CategoryID, categories.CategoryName ORDER BY TotalOrdered DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Assess the impact of discounts on product performance."}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].Quantity * (1 - [Order Details].Discount)) / SUM([Order Details].Quantity) AS DiscountEffect FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the products with the highest and lowest Unit Prices and their associated stock levels."}, {"role": "assistant", "content": "SELECT ProductName, UnitsInStock FROM products WHERE UnitPrice = (SELECT MAX(UnitPrice) FROM products) UNION SELECT ProductName, UnitsInStock FROM products WHERE UnitPrice = (SELECT MIN(UnitPrice) FROM products);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which countries have the highest number of orders in the last year?"}, {"role": "assistant", "content": "SELECT ShipCountry, COUNT(*) AS OrderCount FROM orders WHERE EXTRACT(YEAR FROM OrderDate) = EXTRACT(YEAR FROM CURRENT_DATE) - 1 GROUP BY ShipCountry ORDER BY OrderCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the customer retention rate for the last quarter?"}, {"role": "assistant", "content": "SELECT (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-10-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-10-01') AS customer_retention_rate"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which region has the most sales by employees?"}, {"role": "assistant", "content": "SELECT o.ShipRegion, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS RegionSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID JOIN employees e ON o.EmployeeID = e.EmployeeID GROUP BY o.ShipRegion ORDER BY RegionSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost for all orders shipped to Germany?"}, {"role": "assistant", "content": "SELECT SUM(Freight) AS TotalFreightCost FROM orders WHERE ShipCountry = 'Germany';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order fulfillment time (in days) per month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which regions have the highest average order quantities?"}, {"role": "assistant", "content": "SELECT ShipRegion, AVG([Order Details].Quantity) AS AvgQuantity FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY ShipRegion ORDER BY AvgQuantity DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers have had all their orders delivered on time?"}, {"role": "assistant", "content": "SELECT CustomerID FROM orders GROUP BY CustomerID HAVING COUNT(OrderID) = COUNT(*) FILTER (WHERE ShippedDate <= RequiredDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine if any product category consistently exceeds its reorder levels."}, {"role": "assistant", "content": "SELECT CategoryID, COUNT(*) AS ExceedCount FROM products WHERE UnitsInStock > ReorderLevel GROUP BY CategoryID HAVING COUNT(*) > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product generated the highest total sales revenue?"}, {"role": "assistant", "content": "SELECT [Order Details].ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM [Order Details] GROUP BY [Order Details].ProductID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the highest freight cost recorded in the database?"}, {"role": "assistant", "content": "SELECT MAX(Freight) FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total discount given on all orders?"}, {"role": "assistant", "content": "SELECT SUM(od.UnitPrice * od.Quantity * od.Discount) AS TotalDiscount FROM [Order Details] od;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which region has the lowest on-time delivery rate this quarter?"}, {"role": "assistant", "content": "SELECT ShipRegion, COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END) * 100.0 / COUNT(OrderID) AS OnTimeRate FROM orders WHERE OrderDate >= DATE_TRUNC('quarter', CURRENT_DATE) GROUP BY ShipRegion ORDER BY OnTimeRate ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers have placed the most orders with a discount?"}, {"role": "assistant", "content": "SELECT o.CustomerID, COUNT(DISTINCT o.OrderID) AS DiscountedOrders FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE od.Discount > 0 GROUP BY o.CustomerID ORDER BY DiscountedOrders DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total sales grouped by country and month."}, {"role": "assistant", "content": "SELECT ShipCountry, TO_CHAR(OrderDate, 'YYYY-MM') AS Month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY ShipCountry, TO_CHAR(OrderDate, 'YYYY-MM')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers have placed orders with a shipping cost exceeding $100?"}, {"role": "assistant", "content": "SELECT DISTINCT customers.CustomerID, CompanyName FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID WHERE orders.Freight > 100;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total revenue generated from orders, including discounts."}, {"role": "assistant", "content": "SELECT SUM(od.Quantity * od.UnitPrice * (1 - od.Discount)) AS TotalRevenue FROM [Order Details] od;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product has the highest total sales in terms of revenue?"}, {"role": "assistant", "content": "SELECT od.ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS ProductSales FROM [Order Details] od GROUP BY od.ProductID ORDER BY ProductSales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List all discontinued products and their stock levels."}, {"role": "assistant", "content": "SELECT ProductName, UnitsInStock FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which five products contribute the most to the total sales of each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, od.ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS ProductSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, od.ProductID ORDER BY e.EmployeeID, ProductSales DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many unique products were sold in the last year?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT ProductID) FROM [Order Details] WHERE OrderID IN (SELECT OrderID FROM orders WHERE OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR));"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping company has the highest on-time delivery rate?"}, {"role": "assistant", "content": "SELECT shippers.CompanyName, CAST(COUNT(CASE WHEN orders.ShippedDate <= orders.RequiredDate THEN 1 END) AS FLOAT) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders JOIN shippers ON orders.ShipVia = shippers.ShipperID GROUP BY shippers.CompanyName ORDER BY on_time_delivery_rate DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were delivered on time each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(orders.OrderDate, '%Y-%m') AS Month, COUNT(*) AS OnTimeOrders FROM orders WHERE orders.ShippedDate <= orders.RequiredDate GROUP BY DATE_FORMAT(orders.OrderDate, '%Y-%m')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the product with the highest discount applied in the last month."}, {"role": "assistant", "content": "SELECT products.ProductName, [Order Details].Discount FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID WHERE OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH) ORDER BY [Order Details].Discount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the top three suppliers with the fastest delivery times."}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS AverageLeadTime FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY suppliers.CompanyName ORDER BY AverageLeadTime ASC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which countries have suppliers who also have fax numbers listed?"}, {"role": "assistant", "content": "SELECT DISTINCT Country FROM suppliers WHERE Fax IS NOT NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has the most suppliers located in it?"}, {"role": "assistant", "content": "SELECT s.City, COUNT(s.SupplierID) AS SupplierCount FROM suppliers s GROUP BY s.City ORDER BY SupplierCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which orders took longer than the required date to be shipped?"}, {"role": "assistant", "content": "SELECT OrderID FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which orders had the largest discount applied?"}, {"role": "assistant", "content": "SELECT od.OrderID, od.Discount FROM [Order Details] od WHERE od.Discount = (SELECT MAX(Discount) FROM [Order Details]) ORDER BY od.OrderID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the customer satisfaction score based on average order frequency."}, {"role": "assistant", "content": "SELECT customers.CustomerID, COUNT(orders.OrderID)/DATEDIFF(MAX(orders.OrderDate), MIN(orders.OrderDate)) AS OrderFrequency FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID GROUP BY customers.CustomerID ORDER BY OrderFrequency DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders did each employee handle in the last quarter?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, COUNT(o.OrderID) AS OrderCount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.OrderDate >= DATE_TRUNC('quarter', CURRENT_DATE) - INTERVAL '3 months' AND o.OrderDate < DATE_TRUNC('quarter', CURRENT_DATE) GROUP BY e.EmployeeID, e.FirstName, e.LastName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers have provided products that are no longer in stock?"}, {"role": "assistant", "content": "SELECT DISTINCT SupplierID FROM products WHERE UnitsInStock = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which region generates the most revenue?"}, {"role": "assistant", "content": "SELECT ShipRegion, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS Revenue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY ShipRegion ORDER BY Revenue DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the order with the maximum freight cost."}, {"role": "assistant", "content": "SELECT OrderID, Freight FROM orders ORDER BY Freight DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the top 5 products based on total quantity sold."}, {"role": "assistant", "content": "SELECT ProductName, SUM([Order Details].Quantity) AS TotalQuantitySold FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY ProductName ORDER BY TotalQuantitySold DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the current stock status of products by category?"}, {"role": "assistant", "content": "SELECT p.CategoryID, p.ProductID, p.ProductName, p.UnitsInStock FROM products p ORDER BY p.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify orders with more than five products that received a discount."}, {"role": "assistant", "content": "SELECT OrderID FROM [Order Details] WHERE Discount > 0 GROUP BY OrderID HAVING COUNT(ProductID) > 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the distribution of order quantities?"}, {"role": "assistant", "content": "SELECT Quantity, COUNT(*) AS Frequency FROM [Order Details] GROUP BY Quantity ORDER BY Frequency DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the average freight cost for orders shipped to each country."}, {"role": "assistant", "content": "SELECT ShipCountry, AVG(Freight) AS AverageFreight FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which region has the lowest average order value?"}, {"role": "assistant", "content": "SELECT o.ShipRegion, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) / COUNT(DISTINCT o.OrderID) AS AvgOrderValue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.ShipRegion ORDER BY AvgOrderValue ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products need to be reordered based on their reorder level?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock <= ReorderLevel AND Discontinued = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List the customers who have never received a discount on their orders."}, {"role": "assistant", "content": "SELECT DISTINCT CustomerID FROM customers WHERE CustomerID NOT IN (SELECT DISTINCT CustomerID FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE Discount > 0);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the month with the highest number of orders shipped."}, {"role": "assistant", "content": "SELECT MONTH(ShippedDate) AS ShipMonth, COUNT(OrderID) AS OrderCount FROM orders WHERE ShippedDate IS NOT NULL GROUP BY ShipMonth ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount given per order each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(orders.OrderDate, '%Y-%m') AS month, AVG([Order Details].Discount) AS average_discount FROM [Order Details] JOIN orders ON orders.OrderID = [Order Details].OrderID GROUP BY month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of products ordered each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, SUM(Quantity) AS TotalProducts FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average freight cost for shipped orders?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AvgFreight FROM orders WHERE ShippedDate IS NOT NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product has the highest sales volume this month?"}, {"role": "assistant", "content": "SELECT p.ProductID FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE EXTRACT(MONTH FROM CURRENT_DATE) = EXTRACT(MONTH FROM CURRENT_DATE) GROUP BY p.ProductID ORDER BY SUM(od.Quantity) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total discount given for each product?"}, {"role": "assistant", "content": "SELECT od.ProductID, SUM(od.Quantity * od.UnitPrice * od.Discount) AS TotalDiscountGiven FROM [Order Details] od GROUP BY od.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total quantity of products sold by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.Quantity) AS TotalQuantity FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have a unit price greater than $50?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitPrice > 50;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the product with the lowest performance in terms of sales in October 2023."}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-10-01' AND '2023-10-31' GROUP BY products.ProductName ORDER BY product_performance ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city had the highest number of orders shipped to?"}, {"role": "assistant", "content": "SELECT orders.ShipCity, COUNT(orders.OrderID) AS NumOrders FROM orders GROUP BY orders.ShipCity ORDER BY NumOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many customers placed more than five orders last year?"}, {"role": "assistant", "content": "SELECT COUNT(customers.CustomerID) AS customer_count FROM orders JOIN customers ON orders.CustomerID = customers.CustomerID WHERE YEAR(orders.OrderDate) = YEAR(CURDATE()) - 1 GROUP BY customers.CustomerID HAVING COUNT(orders.OrderID) > 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total quantity of products sold per category?"}, {"role": "assistant", "content": "SELECT products.CategoryID, SUM([Order Details].Quantity) AS TotalQuantity FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.CategoryID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders include products from multiple suppliers?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM (SELECT OrderID, COUNT(DISTINCT SupplierID) AS SupplierCount FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY OrderID) AS OrderSupplierCount WHERE SupplierCount > 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the percentage of returning customers in Q1 2023?"}, {"role": "assistant", "content": "SELECT (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-03-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS retention_rate"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many products have a reorder level higher than current stock?"}, {"role": "assistant", "content": "SELECT COUNT(ProductID) AS ProductCount FROM products WHERE ReorderLevel > UnitsInStock;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the total number of orders shipped by each method."}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS TotalShippedOrders FROM orders WHERE ShippedDate IS NOT NULL GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products were never ordered?"}, {"role": "assistant", "content": "SELECT ProductID FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city had the highest number of orders shipped to it in the last year?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS NumberOfOrders FROM orders WHERE OrderDate >= (CURRENT_DATE - INTERVAL '1 year') GROUP BY ShipCity ORDER BY NumberOfOrders DESC FETCH FIRST 1 ROW ONLY;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount applied for each product?"}, {"role": "assistant", "content": "SELECT ProductID, AVG(Discount) AS AvgDiscount FROM [Order Details] GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the average discount per customer."}, {"role": "assistant", "content": "SELECT customers.CustomerID, AVG([Order Details].Discount) AS AverageDiscount FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the total sales generated for each product category."}, {"role": "assistant", "content": "SELECT CategoryID, SUM([Order Details].UnitPrice * Quantity * (1 - Discount)) AS TotalSales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How have shipping times changed over the years?"}, {"role": "assistant", "content": "SELECT YEAR(OrderDate) AS Year, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AverageShippingTime FROM orders GROUP BY Year ORDER BY Year;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has the highest number of orders, and who handles them?"}, {"role": "assistant", "content": "SELECT orders.ShipCity, orders.EmployeeID, COUNT(orders.OrderID) AS OrderCount FROM orders GROUP BY orders.ShipCity, orders.EmployeeID ORDER BY OrderCount DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product category generated the most revenue in 2023?"}, {"role": "assistant", "content": "SELECT categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_revenue FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN categories ON products.CategoryID = categories.CategoryID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY categories.CategoryName ORDER BY total_revenue DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify products with decreasing sales trends over months."}, {"role": "assistant", "content": "SELECT ProductName FROM (SELECT ProductName, DATE_FORMAT(OrderDate, '%Y-%m') AS Month, SUM(Quantity) AS QuantitySold FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY ProductName, Month) sub WHERE QuantitySold < LAG(QuantitySold) OVER (PARTITION BY ProductName ORDER BY Month);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order size in terms of quantity?"}, {"role": "assistant", "content": "SELECT AVG([Order Details].Quantity) AS AvgOrderSize FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total revenue generated by each customer."}, {"role": "assistant", "content": "SELECT c.CustomerID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total quantity of products sold each month?"}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM o.OrderDate) AS Month, SUM(od.Quantity) AS TotalQuantity FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY EXTRACT(YEAR FROM o.OrderDate), EXTRACT(MONTH FROM o.OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List all products that have stock levels below their reorder level."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order quantity for each product?"}, {"role": "assistant", "content": "SELECT ProductID, AVG(Quantity) AS AverageQuantity FROM [Order Details] GROUP BY ProductID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees have the highest number of orders processed?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS NumberOfOrders FROM orders GROUP BY EmployeeID ORDER BY NumberOfOrders DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List employees who have handled orders with total discounts over 10%."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].Discount) AS TotalDiscount FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID HAVING TotalDiscount > 0.1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of products sold by each employee?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].Quantity) AS TotalProducts FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List the top 3 products in terms of units sold."}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS UnitsSold FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName ORDER BY UnitsSold DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount given per product?"}, {"role": "assistant", "content": "SELECT ProductName, AVG(Discount) AS AvgDiscount FROM [Order Details] OD JOIN products P ON OD.ProductID = P.ProductID GROUP BY ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total revenue generated by each customer over their lifetime?"}, {"role": "assistant", "content": "SELECT c.CustomerID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS LifetimeValue FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the products that have been discontinued."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products need to be reordered?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock <= ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the cities with the highest number of suppliers."}, {"role": "assistant", "content": "SELECT City, COUNT(SupplierID) AS SupplierCount FROM suppliers GROUP BY City ORDER BY SupplierCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the average unit price of products sold in the last quarter."}, {"role": "assistant", "content": "SELECT AVG([Order Details].UnitPrice) AS AvgUnitPrice FROM [Order Details] WHERE OrderID IN (SELECT OrderID FROM orders WHERE OrderDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 3 MONTH) AND CURDATE());"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List products with a reorder level higher than units in stock."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE ReorderLevel > UnitsInStock;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How much freight cost has been incurred by each employee's orders?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(o.Freight) AS TotalFreight FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were processed by employees in each city?"}, {"role": "assistant", "content": "SELECT employees.City, COUNT(orders.OrderID) AS OrderCount FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID GROUP BY employees.City;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average unit price of products per supplier?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, AVG(products.UnitPrice) AS AvgUnitPrice FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID GROUP BY suppliers.CompanyName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the total sales for each month in 2023?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(orders.OrderDate, '%Y-%m') AS month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY month"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How does employee efficiency vary based on the shipping regions they handle?"}, {"role": "assistant", "content": "SELECT EmployeeID, ShipRegion, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY EmployeeID, ShipRegion ORDER BY EmployeeID, AvgFulfillmentTime ASC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has the highest number of unique customers?"}, {"role": "assistant", "content": "SELECT customers.City, COUNT(DISTINCT customers.CustomerID) AS unique_customers FROM customers GROUP BY customers.City ORDER BY unique_customers DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average time taken to fulfill orders each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY Month ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many employees were hired in 2023?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS hires_count FROM employees WHERE employees.HireDate BETWEEN '2023-01-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers have placed the highest number of orders?"}, {"role": "assistant", "content": "SELECT c.CustomerID, COUNT(o.OrderID) AS OrderCount FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID GROUP BY c.CustomerID ORDER BY OrderCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which month experienced the highest number of late shipments?"}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM ShippedDate) AS Month, COUNT(*) AS LateShipments FROM orders WHERE ShippedDate > RequiredDate GROUP BY EXTRACT(MONTH FROM ShippedDate) ORDER BY LateShipments DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total revenue generated by each product category?"}, {"role": "assistant", "content": "SELECT c.CategoryID, SUM(od.Quantity * od.UnitPrice) AS TotalRevenue FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN categories c ON p.CategoryID = c.CategoryID GROUP BY c.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', ShippedDate) AS Month, COUNT(OrderID) AS OrderCount FROM orders WHERE ShippedDate IS NOT NULL GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost for each shipping country?"}, {"role": "assistant", "content": "SELECT ShipCountry, SUM(Freight) AS TotalFreightCost FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify suppliers with orders that have not been shipped yet."}, {"role": "assistant", "content": "SELECT suppliers.CompanyName FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.ShippedDate IS NULL GROUP BY suppliers.CompanyName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have been ordered more than 100 times?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(OrderID) AS OrderCount FROM [Order Details] GROUP BY ProductID HAVING COUNT(OrderID) > 100;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the percentage of orders requiring delivery within one week?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) * 100.0 / (SELECT COUNT(*) FROM orders) AS Percentage FROM orders WHERE DATEDIFF(RequiredDate, OrderDate) <= 7;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How does sales distribution vary across different regions?"}, {"role": "assistant", "content": "SELECT region.RegionDescription, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID JOIN employeeTerritories ON employees.EmployeeID = employeeTerritories.EmployeeID JOIN territories ON employeeTerritories.TerritoryID = territories.TerritoryID JOIN region ON territories.RegionID = region.RegionID GROUP BY region.RegionDescription"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average value of orders placed in the month of January 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE MONTH(orders.OrderDate) = 1 AND YEAR(orders.OrderDate) = 2023"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales generated by each employee in the last month?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATEADD(MONTH, -1, CURRENT_DATE) GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the Customer Retention Rate for the past quarter."}, {"role": "assistant", "content": "SELECT 100.0 * (SELECT COUNT(DISTINCT CustomerID) FROM orders WHERE OrderDate BETWEEN '2023-07-01' AND '2023-09-30') / (SELECT COUNT(DISTINCT CustomerID) FROM orders WHERE OrderDate < '2023-07-01') AS RetentionRate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the average reorder level across all products."}, {"role": "assistant", "content": "SELECT AVG(ReorderLevel) FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many units on order exist for each supplier?"}, {"role": "assistant", "content": "SELECT SupplierID, SUM(UnitsOnOrder) FROM products GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier provides the most number of different products?"}, {"role": "assistant", "content": "SELECT SupplierID, COUNT(DISTINCT ProductID) AS NumberOfProducts FROM products GROUP BY SupplierID ORDER BY NumberOfProducts DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount offered on products that have been discontinued?"}, {"role": "assistant", "content": "SELECT AVG([Order Details].Discount) AS AverageDiscount FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID WHERE products.Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which cities have the highest number of sales from employees?"}, {"role": "assistant", "content": "SELECT e.City, COUNT(*) AS SalesCount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.City ORDER BY SalesCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have the highest turnover rates?"}, {"role": "assistant", "content": "SELECT ProductID, SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS TurnoverRatio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY ProductID ORDER BY TurnoverRatio DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Who are the top 5 customers by revenue?"}, {"role": "assistant", "content": "SELECT c.CustomerID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID ORDER BY TotalRevenue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many customers placed more than 3 orders in 2023?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS customer_count FROM (SELECT customers.CustomerID FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY customers.CustomerID HAVING COUNT(DISTINCT orders.OrderID) > 3) AS subquery"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the product with the highest current stock level."}, {"role": "assistant", "content": "SELECT ProductName FROM products ORDER BY UnitsInStock DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which category has the highest number of discontinued products?"}, {"role": "assistant", "content": "SELECT CategoryID, COUNT(*) AS DiscontinuedProducts FROM products WHERE Discontinued = 1 GROUP BY CategoryID ORDER BY DiscontinuedProducts DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total revenue contributed by employees in each region?"}, {"role": "assistant", "content": "SELECT Region, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY Region;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total revenue generated from orders last month?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS Total_Revenue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE MONTH(orders.OrderDate) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH) AND YEAR(orders.OrderDate) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order fulfillment time for each product category?"}, {"role": "assistant", "content": "SELECT categories.CategoryName, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_fulfillment_time FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID JOIN products ON [Order Details].ProductID = products.ProductID JOIN categories ON products.CategoryID = categories.CategoryID GROUP BY categories.CategoryName"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping method is used the most frequently?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS UsageCount FROM orders GROUP BY ShipVia ORDER BY UsageCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the monthly inventory turnover ratio?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS InventoryTurnoverRatio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average fulfillment time for orders each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AverageFulfillmentTime FROM orders GROUP BY DATE_TRUNC('month', OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which orders have the highest discount applied?"}, {"role": "assistant", "content": "SELECT OrderID, Discount FROM [Order Details] ORDER BY Discount DESC LIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have a stock level below their reorder level?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find products with unusually high discounts applied to them."}, {"role": "assistant", "content": "SELECT p.ProductName FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID WHERE od.Discount > 0.25;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the supplier that offers the most products at a unit price above $20."}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, CompanyName, COUNT(products.ProductID) AS ProductCount FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID WHERE products.UnitPrice > 20 GROUP BY suppliers.SupplierID, suppliers.CompanyName ORDER BY ProductCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the overall discount given for each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Discount * od.Quantity * od.UnitPrice) AS TotalDiscount FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the median fulfillment time for all orders?"}, {"role": "assistant", "content": "SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY DATEDIFF(ShippedDate, OrderDate)) AS MedianFulfillmentTime FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Who are the top three employees in terms of sales?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID ORDER BY TotalSales DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the total sales generated by country?"}, {"role": "assistant", "content": "SELECT ShipCountry, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have the highest sales performance this year?"}, {"role": "assistant", "content": "SELECT p.ProductID, SUM(od.Quantity) AS TotalSales FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID WHERE YEAR(od.OrderDate) = YEAR(CURDATE()) GROUP BY p.ProductID ORDER BY TotalSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees are responsible for the top 10 largest orders?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, o.OrderID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS OrderValue FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, o.OrderID ORDER BY OrderValue DESC LIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find products with a discount greater than 10% and quantity ordered over 100 units."}, {"role": "assistant", "content": "SELECT p.ProductName FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE od.Discount > 0.10 AND od.Quantity > 100;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many units of each product are currently in stock?"}, {"role": "assistant", "content": "SELECT ProductID, UnitsInStock FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total revenue difference between employees with different titles?"}, {"role": "assistant", "content": "SELECT employees.Title, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.Title;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify orders that were shipped after the required date."}, {"role": "assistant", "content": "SELECT OrderID, OrderDate, RequiredDate, ShippedDate FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many unique products have been ordered in total?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT [Order Details].ProductID) AS UniqueProducts FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the total value of discounts applied over all orders."}, {"role": "assistant", "content": "SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice * [Order Details].Discount) AS TotalDiscountValue FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the average number of orders for each month in 2021."}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM OrderDate) AS Month, COUNT(OrderID) / 12 AS AverageOrders FROM orders WHERE OrderDate BETWEEN '2021-01-01' AND '2021-12-31' GROUP BY EXTRACT(MONTH FROM OrderDate)"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customer received the most orders in the last month?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS OrderCount FROM orders WHERE YEAR(OrderDate) = YEAR(CURRENT_DATE) AND MONTH(OrderDate) = MONTH(CURRENT_DATE) - 1 GROUP BY CustomerID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount given on products?"}, {"role": "assistant", "content": "SELECT AVG(Discount) AS AverageDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most common shipment method used for orders processed by each employee?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, ShipVia, COUNT(orders.OrderID) AS NumShipments FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID GROUP BY employees.EmployeeID, ShipVia ORDER BY NumShipments DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the revenue lost due to discounts for each product."}, {"role": "assistant", "content": "SELECT ProductID, SUM(UnitPrice * Quantity * Discount) AS RevenueLost FROM [Order Details] GROUP BY ProductID ORDER BY RevenueLost DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of orders received a discount?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT [Order Details].OrderID) * 1.0 / (SELECT COUNT(DISTINCT OrderID) FROM orders)) * 100 AS percentage_discounted_orders FROM [Order Details] WHERE Discount > 0"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top-selling products by each category?"}, {"role": "assistant", "content": "SELECT CategoryID, P.ProductName, SUM(OD.Quantity) AS TotalSales FROM products P JOIN [Order Details] OD ON P.ProductID = OD.ProductID GROUP BY CategoryID, P.ProductName ORDER BY CategoryID, TotalSales DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average unit price of products for each category?"}, {"role": "assistant", "content": "SELECT p.CategoryID, AVG(p.UnitPrice) AS AveragePrice FROM products p GROUP BY p.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee has handled the most orders?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS NumberOfOrders FROM orders GROUP BY EmployeeID ORDER BY NumberOfOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine monthly trends in inventory turnover ratios."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(o.OrderDate, '%Y-%m') as OrderMonth, SUM(od.Quantity * od.UnitPrice) / AVG(p.UnitsInStock) as InventoryTurnover FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY OrderMonth ORDER BY OrderMonth;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total freight cost for shipments to each country."}, {"role": "assistant", "content": "SELECT ShipCountry, SUM(Freight) AS TotalFreightCost FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products are sold below their reorder level and need to be prioritized for restocking?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock < ReorderLevel AND Discontinued = 0 ORDER BY UnitsInStock, UnitsOnOrder ASC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product had the highest increase in sales compared to the previous month?"}, {"role": "assistant", "content": "SELECT products.ProductName, product_sales.current_month_sales - COALESCE(previous_month_sales.previous_month_sales, 0) AS sales_increase FROM (SELECT [Order Details].ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS current_month_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE MONTH(orders.OrderDate) = MONTH(CURRENT_DATE()) AND YEAR(orders.OrderDate) = YEAR(CURRENT_DATE()) GROUP BY [Order Details].ProductID) AS product_sales LEFT JOIN (SELECT [Order Details].ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS previous_month_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE MONTH(orders.OrderDate) = MONTH(CURRENT_DATE()) - 1 AND YEAR(orders.OrderDate) = YEAR(CURRENT_DATE()) GROUP BY [Order Details].ProductID) AS previous_month_sales ON product_sales.ProductID = previous_month_sales.ProductID JOIN products ON product_sales.ProductID = products.ProductID ORDER BY sales_increase DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List products that have the highest margin by comparing unit price with discounted price."}, {"role": "assistant", "content": "SELECT ProductName, UnitPrice - MIN(od.UnitPrice * (1 - od.Discount)) AS Margin FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY ProductName ORDER BY Margin DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount percentage given on orders?"}, {"role": "assistant", "content": "SELECT AVG(Discount * 100) AS AverageDiscountPercentage FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify orders with a shipping delay and calculate the average delay days."}, {"role": "assistant", "content": "SELECT o.OrderID, DATEDIFF(o.ShippedDate, o.RequiredDate) AS DelayDays FROM orders o WHERE o.ShippedDate > o.RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total value of all orders placed by customers in the USA?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID WHERE customers.Country = 'USA'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the reorder frequency for each product."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, COUNT(*) AS ReorderCount FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID JOIN products p ON od.ProductID = p.ProductID WHERE od.Quantity >= p.ReorderLevel GROUP BY p.ProductID, p.ProductName ORDER BY ReorderCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees are handling the most territories?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, COUNT(employeeTerritories.TerritoryID) AS territory_count FROM employeeTerritories JOIN employees ON employeeTerritories.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID ORDER BY territory_count DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have a reorder level that is less than the average reorder level?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE ReorderLevel < (SELECT AVG(ReorderLevel) FROM products);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product has the highest sales quantity in the last month?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS total_quantity FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID JOIN products p ON od.ProductID = p.ProductID WHERE o.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND o.OrderDate < CURDATE() GROUP BY p.ProductName ORDER BY total_quantity DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product has the highest reorder level?"}, {"role": "assistant", "content": "SELECT ProductName FROM products ORDER BY ReorderLevel DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the top 5 products with the highest discount given?"}, {"role": "assistant", "content": "SELECT ProductID, Discount FROM [Order Details] ORDER BY Discount DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average unit price of products by category?"}, {"role": "assistant", "content": "SELECT CategoryID, AVG(UnitPrice) AS AveragePrice FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount given on orders?"}, {"role": "assistant", "content": "SELECT AVG(Discount) AS AverageDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What's the total value of the current stock for each product?"}, {"role": "assistant", "content": "SELECT ProductName, UnitsInStock * UnitPrice AS StockValue FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List products that have never been ordered."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees have the highest order fulfillment speed?"}, {"role": "assistant", "content": "SELECT EmployeeID, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY EmployeeID ORDER BY AvgFulfillmentTime ASC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has the highest number of orders shipped in 2023?"}, {"role": "assistant", "content": "SELECT orders.ShipCity, COUNT(orders.OrderID) AS total_orders FROM orders WHERE YEAR(orders.ShippedDate) = 2023 GROUP BY orders.ShipCity ORDER BY total_orders DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the difference in shipment duration for each order (RequiredDate vs ShippedDate)."}, {"role": "assistant", "content": "SELECT OrderID, DATEDIFF(ShippedDate, RequiredDate) AS ShipmentDuration FROM orders WHERE ShippedDate IS NOT NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total revenue generated from each supplier's products?"}, {"role": "assistant", "content": "SELECT s.SupplierID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee has the highest sales in a given year?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) as TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE YEAR(o.OrderDate) = 2022 GROUP BY e.EmployeeID, e.FirstName, e.LastName ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many unique products are ordered by each customer?"}, {"role": "assistant", "content": "SELECT o.CustomerID, COUNT(DISTINCT od.ProductID) AS UniqueProductsOrdered FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have the highest discount on average?"}, {"role": "assistant", "content": "SELECT products.ProductName, AVG([Order Details].Discount) AS AvgDiscount FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductName ORDER BY AvgDiscount DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the average discount provided by each employee."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, AVG([Order Details].Discount) AS AverageDiscount FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total sales for each product."}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].Quantity * [Order Details].UnitPrice) AS TotalSales FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped later than the required date?"}, {"role": "assistant", "content": "SELECT COUNT(orders.OrderID) FROM orders WHERE orders.ShippedDate > orders.RequiredDate"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average shipping cost to each country?"}, {"role": "assistant", "content": "SELECT ShipCountry, AVG(Freight) AS AverageShippingCost FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order value for the current year?"}, {"role": "assistant", "content": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) / COUNT(DISTINCT o.OrderID) AS AverageOrderValue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate BETWEEN DATE_TRUNC('year', CURRENT_DATE) AND CURRENT_DATE;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many discontinued products are still in stock?"}, {"role": "assistant", "content": "SELECT ProductID, UnitsInStock FROM products WHERE Discontinued = 1 AND UnitsInStock > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List products with no units on order but have sales in the last month."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsOnOrder = 0 AND ProductID IN (SELECT DISTINCT od.ProductID FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID WHERE o.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH));"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What products have been ordered most frequently?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(Quantity) AS TotalQuantity FROM [Order Details] GROUP BY ProductID ORDER BY TotalQuantity DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average shipping cost per order in the last year?"}, {"role": "assistant", "content": "SELECT AVG(orders.Freight) AS avg_shipping_cost FROM orders WHERE orders.OrderDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 YEAR) AND CURDATE()"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average shipping cost per order over the last month?"}, {"role": "assistant", "content": "SELECT AVG(Freight) FROM orders WHERE OrderDate >= DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 month';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List the top 5 employees with the highest sales growth over the last year."}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, (SUM(CASE WHEN YEAR(o.OrderDate) = YEAR(CURRENT_DATE) THEN od.UnitPrice * od.Quantity * (1 - od.Discount) ELSE 0 END) - SUM(CASE WHEN YEAR(o.OrderDate) = YEAR(CURRENT_DATE) - 1 THEN od.UnitPrice * od.Quantity * (1 - od.Discount) ELSE 0 END)) AS SalesGrowth FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID ORDER BY SalesGrowth DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total inventory value for each category?"}, {"role": "assistant", "content": "SELECT CategoryID, SUM(UnitPrice * UnitsInStock) AS InventoryValue FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What are the total sales by supplier and month?"}, {"role": "assistant", "content": "SELECT SupplierID, EXTRACT(MONTH FROM o.OrderDate) AS Month, SUM(od.Quantity * od.UnitPrice) AS MonthlySales FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY SupplierID, Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the average discount offered on the products from each supplier."}, {"role": "assistant", "content": "SELECT p.SupplierID, AVG(od.Discount) AS AvgDiscount FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order fulfillment time per month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, AVG(DATEDIFF(day, OrderDate, ShippedDate)) AS AverageFulfillmentTime FROM orders WHERE ShippedDate IS NOT NULL GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Analyze the sales trend for products over the last quarter."}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM OrderDate) AS Month, SUM(Quantity * UnitPrice) AS TotalSales FROM [Order Details] WHERE OrderDate >= DATEADD(MONTH, -3, CURRENT_DATE) GROUP BY EXTRACT(MONTH FROM OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total number of orders for each shipping country."}, {"role": "assistant", "content": "SELECT ShipCountry, COUNT(*) AS NumberOfOrders FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify customers who have placed more than 10 orders."}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS order_count FROM orders GROUP BY CustomerID HAVING COUNT(OrderID) > 10;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the distribution of employee hire dates by year?"}, {"role": "assistant", "content": "SELECT YEAR(HireDate) AS HireYear, COUNT(EmployeeID) AS HireCount FROM employees GROUP BY YEAR(HireDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have more units on order than units currently in stock?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsOnOrder > UnitsInStock;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the most common shipping method used by each employee."}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, o.ShipVia, COUNT(o.OrderID) as ShipMethodCount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID, o.ShipVia ORDER BY ShipMethodCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the top 5 best-selling products last quarter."}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].Quantity) AS total_quantity_sold FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN products ON [Order Details].ProductID = products.ProductID WHERE orders.OrderDate BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 3 MONTH) AND CURRENT_DATE GROUP BY products.ProductID ORDER BY total_quantity_sold DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the breakdown of total sales by shipment countries?"}, {"role": "assistant", "content": "SELECT orders.ShipCountry, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY orders.ShipCountry"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were placed by customers in the United States?"}, {"role": "assistant", "content": "SELECT COUNT(o.OrderID) AS USOrders FROM orders o JOIN customers c ON o.CustomerID = c.CustomerID WHERE c.Country = 'USA';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales revenue by country?"}, {"role": "assistant", "content": "SELECT orders.ShipCountry, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY orders.ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of orders that have not been shipped?"}, {"role": "assistant", "content": "SELECT COUNT(o.OrderID) AS UnshippedOrders FROM orders o WHERE o.ShippedDate IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the product with the highest unit price currently in stock?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName, UnitPrice FROM products WHERE UnitsInStock > 0 ORDER BY UnitPrice DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the top 3 employees with the fastest average fulfillment time."}, {"role": "assistant", "content": "SELECT EmployeeID, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders WHERE ShippedDate IS NOT NULL GROUP BY EmployeeID ORDER BY AvgFulfillmentTime ASC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the percentage of orders delivered on or before the required date each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', orders.OrderDate) AS Month, (COUNT(CASE WHEN orders.ShippedDate <= orders.RequiredDate THEN 1 END) * 100.0 / COUNT(orders.OrderID)) AS OnTimeDeliveryRate FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which region has the highest average order value?"}, {"role": "assistant", "content": "SELECT Region, AVG([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS AverageOrderValue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY Region ORDER BY AverageOrderValue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List all products that have never been included in any order."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How does the product performance vary month by month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, ProductID, SUM(Quantity) AS TotalPerformance FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY Month, ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales revenue generated for each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most popular product in terms of quantity sold in 2023?"}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].Quantity) AS total_sold FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY products.ProductName ORDER BY total_sold DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which shipping method is most frequently used for orders in 2023?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS shipping_count FROM orders WHERE OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY ShipVia ORDER BY shipping_count DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the number of orders processed by each employee by year."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, YEAR(orders.OrderDate) AS OrderYear, COUNT(orders.OrderID) AS OrderCount FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID GROUP BY employees.EmployeeID, YEAR(orders.OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the employee responsible for orders with the highest freight costs."}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, o.OrderID FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.Freight = (SELECT MAX(Freight) FROM orders)"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which product had the best performance in terms of quantity sold for the month of June 2023?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE MONTH(orders.OrderDate) = 6 AND YEAR(orders.OrderDate) = 2023 GROUP BY products.ProductID ORDER BY product_performance DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average shipping cost per country?"}, {"role": "assistant", "content": "SELECT ShipCountry, AVG(Freight) AS AverageCost FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of products shipped in the last month?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].Quantity) FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE orders.ShippedDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND CURDATE();"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the busiest shipping month based on total orders shipped?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', ShippedDate) AS Month, COUNT(OrderID) AS TotalOrders FROM orders WHERE ShippedDate IS NOT NULL GROUP BY Month ORDER BY TotalOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees have shipped orders late and by how many days on average?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, AVG(DATEDIFF(o.ShippedDate, o.RequiredDate)) AS AvgLateDays FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.ShippedDate > o.RequiredDate GROUP BY e.EmployeeID, e.FirstName, e.LastName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find suppliers with a homepage listed in the suppliers table."}, {"role": "assistant", "content": "SELECT CompanyName FROM suppliers WHERE HomePage IS NOT NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers have generated the most revenue lifetime?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID ORDER BY customer_lifetime_value DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most popular shipping destination city?"}, {"role": "assistant", "content": "SELECT o.ShipCity, COUNT(o.OrderID) AS OrderCount FROM orders o GROUP BY o.ShipCity ORDER BY OrderCount DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee handled the most orders?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS NumberOfOrders FROM orders GROUP BY EmployeeID ORDER BY NumberOfOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total freight cost for orders shipped by each method."}, {"role": "assistant", "content": "SELECT o.ShipVia, SUM(o.Freight) AS TotalFreightCost FROM orders o GROUP BY o.ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers have the highest retention rate over the past six months?"}, {"role": "assistant", "content": "SELECT c.CustomerID, COUNT(DISTINCT o.OrderID) * 100.0 / (SELECT COUNT(DISTINCT o2.OrderID) FROM orders o2 WHERE o2.CustomerID = c.CustomerID AND o2.OrderDate < DATEADD(month, -6, CURRENT_DATE)) AS RetentionRate FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID WHERE o.OrderDate >= DATEADD(month, -6, CURRENT_DATE) GROUP BY c.CustomerID ORDER BY RetentionRate DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many products have more units on order than in stock?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS NumberOfProducts FROM products WHERE UnitsOnOrder > UnitsInStock;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average freight cost for orders shipped to 'USA'?"}, {"role": "assistant", "content": "SELECT AVG(Freight) FROM orders WHERE ShipCountry = 'USA';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total sales revenue generated by each employee?"}, {"role": "assistant", "content": "SELECT o.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of products sold this quarter?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].Quantity) FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE OrderDate >= DATE_TRUNC('quarter', CURRENT_DATE);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products are ordered more after being marked as 'discontinued'?"}, {"role": "assistant", "content": "SELECT p.ProductName FROM products p WHERE p.Discontinued = 1 AND p.ProductID IN (SELECT od.ProductID FROM [Order Details] od WHERE od.Quantity > 0) ORDER BY p.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which ship cities have the longest average order fulfillment times?"}, {"role": "assistant", "content": "SELECT ShipCity, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY ShipCity ORDER BY AvgFulfillmentTime DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "List all suppliers who have never had a discontinuation in their products."}, {"role": "assistant", "content": "SELECT SupplierID, CompanyName FROM suppliers WHERE SupplierID NOT IN (SELECT DISTINCT SupplierID FROM products WHERE Discontinued = 1);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total discount amount for each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, SUM(od.UnitPrice * od.Quantity * od.Discount) AS TotalDiscount FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customer has made the most purchases?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS PurchaseCount FROM orders GROUP BY CustomerID ORDER BY PurchaseCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier's products have the lowest average rating based on discounts given?"}, {"role": "assistant", "content": "SELECT products.SupplierID, AVG([Order Details].Discount) AS AverageDiscount FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.SupplierID ORDER BY AverageDiscount ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employee handled the highest number of orders?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS NumOrders FROM orders GROUP BY EmployeeID ORDER BY NumOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Get the top 3 cities with the highest number of suppliers."}, {"role": "assistant", "content": "SELECT City, COUNT(SupplierID) AS NumSuppliers FROM suppliers GROUP BY City ORDER BY NumSuppliers DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the retention rate of customers over the past year?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT CustomerID) WHERE OrderDate BETWEEN '2022-01-01' AND '2022-12-31') / NULLIF(COUNT(DISTINCT CustomerID) WHERE OrderDate < '2022-01-01', 0) * 100 AS RetentionRate FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "In which month did the highest average freight cost occur?"}, {"role": "assistant", "content": "SELECT EXTRACT(YEAR FROM OrderDate) AS Year, EXTRACT(MONTH FROM OrderDate) AS Month, AVG(Freight) AS AvgFreight FROM orders GROUP BY Year, Month ORDER BY AvgFreight DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total revenue for each supplier."}, {"role": "assistant", "content": "SELECT products.SupplierID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average order value per employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS AvgOrderValue FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the total revenue per country."}, {"role": "assistant", "content": "SELECT o.ShipCountry, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which month had the highest total sales and which employee contributed the most to it?"}, {"role": "assistant", "content": "SELECT SalesMonth, EmployeeID, TotalSales FROM (SELECT MONTH(o.OrderDate) AS SalesMonth, e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY SalesMonth, e.EmployeeID) AS MonthlySales ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost assigned to each employee?"}, {"role": "assistant", "content": "SELECT e.FirstName, e.LastName, SUM(o.Freight) AS TotalFreight FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID, e.FirstName, e.LastName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which regions have the highest average order value?"}, {"role": "assistant", "content": "SELECT ShipRegion, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) / COUNT(DISTINCT o.OrderID) AS AvgOrderValue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY ShipRegion"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier has the highest total sales for discontinued products?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID WHERE products.Discontinued = TRUE GROUP BY suppliers.CompanyName ORDER BY total_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customers have the highest lifetime value?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS LifetimeValue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID ORDER BY LifetimeValue DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount given on products in the last month?"}, {"role": "assistant", "content": "SELECT P.ProductName, AVG(OD.Discount) AS AverageDiscount FROM products P JOIN [Order Details] OD ON P.ProductID = OD.ProductID WHERE MONTH(OD.OrderID) = MONTH(CURDATE() - INTERVAL 1 MONTH) AND YEAR(OD.OrderID) = YEAR(CURDATE() - INTERVAL 1 MONTH) GROUP BY P.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify customers with the longest time since their last order."}, {"role": "assistant", "content": "SELECT o.CustomerID, DATEDIFF(CURRENT_DATE, MAX(o.OrderDate)) AS DaysSinceLastOrder FROM orders o GROUP BY o.CustomerID ORDER BY DaysSinceLastOrder DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of products sold in the last quarter?"}, {"role": "assistant", "content": "SELECT SUM(od.Quantity) AS TotalProductsSold FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID WHERE o.OrderDate >= DATEADD(quarter, -1, CURRENT_DATE);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were placed using each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine which employee has the most shipments via the highest-cost freight method."}, {"role": "assistant", "content": "SELECT o.EmployeeID, COUNT(o.OrderID) AS ShipmentCount FROM orders o WHERE o.Freight = (SELECT MAX(Freight) FROM orders) GROUP BY o.EmployeeID ORDER BY ShipmentCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most sold product in terms of quantity?"}, {"role": "assistant", "content": "SELECT ProductName, SUM([Order Details].Quantity) AS TotalQuantity FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY ProductName ORDER BY TotalQuantity DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the product performance ranking for the last month?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS TotalSales FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE MONTH(od.OrderDate) = MONTH(CURRENT_DATE) - 1 AND YEAR(od.OrderDate) = YEAR(CURRENT_DATE) GROUP BY p.ProductID, p.ProductName ORDER BY TotalSales DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total value of the inventory currently in stock?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * UnitsInStock) AS TotalInventoryValue FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the orders that had a discount greater than 20%."}, {"role": "assistant", "content": "SELECT DISTINCT orders.OrderID, [Order Details].Discount FROM [Order Details] INNER JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE [Order Details].Discount > 0.2;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the revenue growth compared to the previous month?"}, {"role": "assistant", "content": "SELECT ((SUM(CASE WHEN MONTH(od.OrderDate) = MONTH(CURRENT_DATE) THEN od.Quantity * od.UnitPrice ELSE 0 END) - SUM(CASE WHEN MONTH(od.OrderDate) = MONTH(CURRENT_DATE) - 1 THEN od.Quantity * od.UnitPrice ELSE 0 END)) / NULLIF(SUM(CASE WHEN MONTH(od.OrderDate) = MONTH(CURRENT_DATE) - 1 THEN od.Quantity * od.UnitPrice ELSE 0 END), 0)) * 100 AS RevenueGrowth FROM [Order Details] od WHERE YEAR(od.OrderDate) = YEAR(CURRENT_DATE);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the percentage of customers who made more than one purchase."}, {"role": "assistant", "content": "SELECT (CAST(COUNT(*) AS FLOAT) / (SELECT COUNT(DISTINCT CustomerID) FROM orders)) * 100 AS ReturningCustomers FROM (SELECT CustomerID FROM orders GROUP BY CustomerID HAVING COUNT(OrderID) > 1) AS MultipleOrders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier contributed the most to total sales this year?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN suppliers ON products.SupplierID = suppliers.SupplierID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = YEAR(CURDATE()) GROUP BY suppliers.SupplierID ORDER BY total_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products are responsible for the majority of sales revenue this month?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS sales_revenue FROM [Order Details] JOIN products p ON [Order Details].ProductID = p.ProductID JOIN orders o ON [Order Details].OrderID = o.OrderID WHERE EXTRACT(MONTH FROM o.OrderDate) = EXTRACT(MONTH FROM CURRENT_DATE) AND EXTRACT(YEAR FROM o.OrderDate) = EXTRACT(YEAR FROM CURRENT_DATE) GROUP BY p.ProductName ORDER BY sales_revenue DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which month has the highest number of orders?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, COUNT(OrderID) AS TotalOrders FROM orders GROUP BY Month ORDER BY TotalOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most frequently ordered product?"}, {"role": "assistant", "content": "SELECT products.ProductName, COUNT(*) AS OrderFrequency FROM [Order Details] INNER JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductName ORDER BY OrderFrequency DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total discount given on all products sold?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * [Order Details].Discount) AS TotalDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify orders that were delivered late compared to the required date."}, {"role": "assistant", "content": "SELECT OrderID FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many distinct shipping recipients are there each month?"}, {"role": "assistant", "content": "SELECT TO_CHAR(OrderDate, 'YYYY-MM') AS Month, COUNT(DISTINCT ShipName) AS DistinctRecipients FROM orders GROUP BY TO_CHAR(OrderDate, 'YYYY-MM');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of orders processed per employee, broken down by year?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, YEAR(o.OrderDate) AS Year, COUNT(o.OrderID) AS OrderCount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID, YEAR(o.OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average lead time for each supplier to deliver products?"}, {"role": "assistant", "content": "SELECT p.SupplierID, AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AvgLeadTime FROM products p JOIN orders o ON p.ProductID = o.OrderID GROUP BY p.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of products are discontinued?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN Discontinued = 1 THEN 1 END) * 100.0 / COUNT(*)) AS DiscontinuedPercentage FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the top 5 customers based on total order quantities."}, {"role": "assistant", "content": "SELECT orders.CustomerID, SUM([Order Details].Quantity) AS total_quantity FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY orders.CustomerID ORDER BY total_quantity DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products are the most frequently ordered per month?"}, {"role": "assistant", "content": "SELECT p.ProductName, COUNT(od.OrderID) AS OrderFrequency, EXTRACT(MONTH FROM o.OrderDate) AS Month FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY p.ProductName, EXTRACT(MONTH FROM o.OrderDate) ORDER BY OrderFrequency DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the on-time delivery rate for each shipping company in Q2 2023."}, {"role": "assistant", "content": "SELECT shippers.CompanyName, SUM(CASE WHEN orders.ShippedDate <= orders.RequiredDate THEN 1 ELSE 0 END) / CAST(COUNT(orders.OrderID) AS DECIMAL) AS on_time_delivery_rate FROM orders JOIN shippers ON orders.ShipVia = shippers.ShipperID WHERE orders.OrderDate BETWEEN '2023-04-01' AND '2023-06-30' GROUP BY shippers.CompanyName"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How does the average shipping cost vary by shipper?"}, {"role": "assistant", "content": "SELECT shippers.CompanyName, AVG(orders.Freight) AS average_cost FROM orders JOIN shippers ON orders.ShipVia = shippers.ShipperID GROUP BY shippers.CompanyName"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the customer retention rate for the last year."}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT o1.CustomerID) * 1.0 / COUNT(DISTINCT o2.CustomerID)) AS RetentionRate FROM orders o1 LEFT JOIN orders o2 ON o1.CustomerID = o2.CustomerID WHERE o1.OrderDate BETWEEN '2022-01-01' AND '2022-12-31';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many products have never been ordered?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the correlation between product price and reorder level."}, {"role": "assistant", "content": "SELECT ProductID, ProductName, (CAST(UnitPrice AS DOUBLE) / ReorderLevel) AS PriceToReorderRatio FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total revenue for each product considering discounts?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity * od.UnitPrice * (1 - od.Discount)) AS TotalRevenue FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify products with the highest unit price that have never been ordered."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details]) ORDER BY UnitPrice DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of orders have been delivered on or before the required date for each month?"}, {"role": "assistant", "content": "SELECT TO_CHAR(OrderDate, 'YYYY-MM') AS OrderMonth, (CAST(SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) AS DECIMAL) / COUNT(*)) * 100 AS OnTimeDeliveryRate FROM orders GROUP BY OrderMonth;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the distribution of orders among different shipping methods?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the distribution of orders across different regions?"}, {"role": "assistant", "content": "SELECT c.Region, COUNT(o.OrderID) AS OrderCount FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID GROUP BY c.Region;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the total sales generated by discontinued products."}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity * od.UnitPrice * (1 - od.Discount)) AS TotalSales FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE p.Discontinued = 1 GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which employees have generated the highest sales in the past year?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY e.EmployeeID, e.FirstName, e.LastName ORDER BY TotalSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which months have the highest on-time delivery rates?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', ShippedDate) AS Month, (COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END) * 100.0 / COUNT(*)) AS OnTimeDeliveryRate FROM orders GROUP BY DATE_TRUNC('month', ShippedDate) ORDER BY OnTimeDeliveryRate DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the percentage of products that are discontinued?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN Discontinued = 1 THEN 1 END) * 100.0 / COUNT(*)) AS DiscontinuedPercentage FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How does the quantity ordered vary by product?"}, {"role": "assistant", "content": "SELECT ProductID, AVG(Quantity) AS AvgQuantity FROM [Order Details] GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average freight cost by shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(Freight) AS AverageFreightCost FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "In which month did we have the highest total sales?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS OrderMonth, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY OrderMonth ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier provides products with the lowest average unit price?"}, {"role": "assistant", "content": "SELECT s.CompanyName, AVG(p.UnitPrice) AS AvgUnitPrice FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID GROUP BY s.CompanyName ORDER BY AvgUnitPrice ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "In which month was the average order fulfillment time the shortest?"}, {"role": "assistant", "content": "SELECT Month, AVG(FulfillmentTime) AS AvgFulfillmentTime FROM (SELECT DATEDIFF(ShippedDate, OrderDate) AS FulfillmentTime, DATE_FORMAT(OrderDate, '%Y-%m') AS Month FROM orders) AS MonthlyFulfillment GROUP BY Month ORDER BY AvgFulfillmentTime ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average time taken to fulfill an order each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders WHERE ShippedDate IS NOT NULL GROUP BY Month ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the top 3 products with the highest sales revenue per unit."}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity * od.UnitPrice) / SUM(od.Quantity) AS SalesRevenuePerUnit FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName ORDER BY SalesRevenuePerUnit DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders have been placed by each customer?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS NumberOfOrders FROM orders GROUP BY CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total freight cost for shipped orders last month?"}, {"role": "assistant", "content": "SELECT SUM(Freight) AS TotalFreight FROM orders WHERE MONTH(ShippedDate) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH) AND YEAR(ShippedDate) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped late every month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(ShippedDate, '%Y-%m') AS Month, COUNT(OrderID) AS LateOrders FROM orders WHERE ShippedDate > RequiredDate GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the distribution of orders by shipping country?"}, {"role": "assistant", "content": "SELECT ShipCountry, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipCountry ORDER BY OrderCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were placed each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, COUNT(OrderID) AS OrderCount FROM orders GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have the highest unit price and are currently discontinued?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE Discontinued = 1 ORDER BY UnitPrice DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What percentage of products are currently on order?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT ProductID) * 100.0 / (SELECT COUNT(ProductID) FROM products) AS PercentageOnOrder FROM [Order Details] WHERE Quantity > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which orders have the highest discount applied?"}, {"role": "assistant", "content": "SELECT OrderID, Discount FROM [Order Details] ORDER BY Discount DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier has the highest total sales revenue?"}, {"role": "assistant", "content": "SELECT p.SupplierID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY p.SupplierID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which suppliers provide the most products that are currently low in stock?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, suppliers.SupplierName, COUNT(products.ProductID) AS LowStockProducts FROM suppliers INNER JOIN products ON suppliers.SupplierID = products.SupplierID WHERE products.UnitsInStock < products.ReorderLevel GROUP BY suppliers.SupplierID, suppliers.SupplierName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the total number of orders shipped each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(ShippedDate, '%Y-%m') AS ShipMonth, COUNT(OrderID) AS OrderCount FROM orders WHERE ShippedDate IS NOT NULL GROUP BY ShipMonth;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the top three customers by the number of orders placed."}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(*) AS OrderCount FROM orders GROUP BY CustomerID ORDER BY OrderCount DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Determine the monthly product performance based on sales."}, {"role": "assistant", "content": "SELECT products.ProductID, DATE_TRUNC('month', orders.OrderDate) AS Month, SUM([Order Details].Quantity) AS TotalQuantity FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY products.ProductID, DATE_TRUNC('month', orders.OrderDate) ORDER BY TotalQuantity DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders have not yet been shipped?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS UnshippedOrders FROM orders WHERE ShippedDate IS NULL"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the most popular product category based on the number of unique customers?"}, {"role": "assistant", "content": "SELECT categories.CategoryName, COUNT(DISTINCT orders.CustomerID) AS unique_customers FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN products ON [Order Details].ProductID = products.ProductID JOIN categories ON products.CategoryID = categories.CategoryID GROUP BY categories.CategoryName ORDER BY unique_customers DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "What is the average discount given per order?"}, {"role": "assistant", "content": "SELECT AVG([Order Details].Discount) AS AverageDiscount FROM [Order Details]"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were fulfilled on time each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, COUNT(*) AS OnTimeOrders FROM orders WHERE ShippedDate <= RequiredDate GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Calculate the Product Performance for each product over the last year."}, {"role": "assistant", "content": "SELECT p.ProductID, SUM(od.Quantity) AS TotalPerformance FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID WHERE od.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY p.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How does the distribution of sales by region compare?"}, {"role": "assistant", "content": "SELECT employees.Region, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS Sales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.Region"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which products have exceeded the reorder level?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the employee with the largest number of orders with discounts."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, COUNT(orders.OrderID) AS DiscountedOrders FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE [Order Details].Discount > 0 GROUP BY employees.EmployeeID ORDER BY DiscountedOrders DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which supplier has the shortest average lead time for deliveries?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_lead_time FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID JOIN products ON [Order Details].ProductID = products.ProductID JOIN suppliers ON products.SupplierID = suppliers.SupplierID GROUP BY suppliers.SupplierID ORDER BY avg_lead_time ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were placed in each month of the year?"}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM OrderDate) AS Month, COUNT(OrderID) FROM orders GROUP BY Month ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which customer placed the most orders in 2022?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS OrderCount FROM orders WHERE EXTRACT(YEAR FROM OrderDate) = 2022 GROUP BY CustomerID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which city has received the highest number of shipments year-to-date?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(*) AS Shipments FROM orders WHERE EXTRACT(YEAR FROM OrderDate) = EXTRACT(YEAR FROM CURRENT_DATE) GROUP BY ShipCity ORDER BY Shipments DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Which month had the highest number of orders shipped?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(ShippedDate, '%Y-%m') AS Month, COUNT(OrderID) AS OrderCount FROM orders WHERE ShippedDate IS NOT NULL GROUP BY Month ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify the peak order day of the week for each month."}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM o.OrderDate) AS OrderMonth, DAYNAME(o.OrderDate) AS OrderDay, COUNT(o.OrderID) AS OrderCount FROM orders o GROUP BY OrderMonth, OrderDay ORDER BY OrderMonth, OrderCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders have zero freight cost?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS FreeShippingOrders FROM orders WHERE Freight = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "How many orders were shipped late each month?"}, {"role": "assistant", "content": "SELECT TO_CHAR(OrderDate, 'YYYY-MM') AS Month, COUNT(OrderID) AS LateShipments FROM orders WHERE ShippedDate > RequiredDate GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Find the products with the highest average order quantity."}, {"role": "assistant", "content": "SELECT p.ProductName, AVG(od.Quantity) AS AvgOrderQuantity FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName ORDER BY AvgOrderQuantity DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "Identify markets (country or region) with the highest average freight cost."}, {"role": "assistant", "content": "SELECT COALESCE(ShipRegion, ShipCountry) AS Market, AVG(Freight) AS AvgFreightCost FROM orders GROUP BY Market ORDER BY AvgFreightCost DESC LIMIT 1;"}]}
