{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How much total revenue was generated last month?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE YEAR(orders.OrderDate) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH) AND MONTH(orders.OrderDate) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Who is the top-performing employee based on total sales within the last quarter?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID WHERE orders.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 3 MONTH) GROUP BY employees.EmployeeID ORDER BY employee_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Evaluate the change in total sales between Q1 and Q2 this year."}, {"role": "assistant", "content": "SELECT QUARTER(o.OrderDate) AS Quarter, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE YEAR(o.OrderDate) = YEAR(CURDATE()) GROUP BY QUARTER(o.OrderDate) ORDER BY QUARTER(o.OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order value for each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS AverageOrderValue FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the distribution of products per supplier in each city?"}, {"role": "assistant", "content": "SELECT City, SupplierID, COUNT(ProductID) AS ProductCount FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID GROUP BY City, SupplierID ORDER BY ProductCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many units of each product are on order?"}, {"role": "assistant", "content": "SELECT ProductName, UnitsOnOrder FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which months see an increase in shipping costs compared to the previous year?"}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM OrderDate) AS Month, AVG(CASE WHEN DATE_PART('year', OrderDate) = DATE_PART('year', CURRENT_DATE) THEN Freight END) AS CurrentYearAverage, AVG(CASE WHEN DATE_PART('year', OrderDate) = DATE_PART('year', CURRENT_DATE) - 1 THEN Freight END) AS PreviousYearAverage FROM orders WHERE DATE_PART('year', OrderDate) IN (DATE_PART('year', CURRENT_DATE), DATE_PART('year', CURRENT_DATE) - 1) GROUP BY EXTRACT(MONTH FROM OrderDate) HAVING AVG(CASE WHEN DATE_PART('year', OrderDate) = DATE_PART('year', CURRENT_DATE) THEN Freight END) > AVG(CASE WHEN DATE_PART('year', OrderDate) = DATE_PART('year', CURRENT_DATE) - 1 THEN Freight END);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine total revenue lost due to discontinued products."}, {"role": "assistant", "content": "SELECT SUM([order details].Quantity * [order details].UnitPrice * (1 - [order details].Discount)) AS RevenueLost FROM products INNER JOIN [order details] ON products.ProductID = [order details].ProductID WHERE products.Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the median shipping cost per order by shipping method."}, {"role": "assistant", "content": "SELECT ShipVia, PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY Freight) AS MedianFreight FROM orders GROUP BY ShipVia"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee has the best on-time delivery record?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS OnTimeOrders FROM orders WHERE ShippedDate <= RequiredDate GROUP BY EmployeeID ORDER BY OnTimeOrders DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify discontinued products with remaining stock."}, {"role": "assistant", "content": "SELECT ProductName, UnitsInStock FROM products WHERE Discontinued = 1 AND UnitsInStock > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the top 3 suppliers with the fastest average shipping time."}, {"role": "assistant", "content": "SELECT s.SupplierID, AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AvgShippingTime FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON o.OrderID = od.OrderID GROUP BY s.SupplierID ORDER BY AvgShippingTime ASC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the top 5 best-selling products."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, SUM(od.Quantity) AS TotalOrders FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName ORDER BY TotalOrders DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the product performance by comparing sales and inventory levels."}, {"role": "assistant", "content": "SELECT p.ProductID, SUM(od.Quantity) AS TotalSold FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales for each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(orders.OrderDate, '%Y-%m') AS OrderMonth, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY OrderMonth;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How does the average order value compare between Q1 and Q2 of 2023?"}, {"role": "assistant", "content": "SELECT 'Q1' AS quarter, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-03-31' UNION ALL SELECT 'Q2', SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-04-01' AND '2023-06-30'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders did each customer place last quarter?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS OrderCount FROM orders WHERE OrderDate >= DATE_SUB(CURRENT_DATE, INTERVAL 3 MONTH) GROUP BY CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which customers have the highest lifetime value?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID ORDER BY lifetime_value DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customers have placed at least three orders?"}, {"role": "assistant", "content": "SELECT CustomerID FROM orders GROUP BY CustomerID HAVING COUNT(OrderID) >= 3"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employees have processed orders above a total of $10,000?"}, {"role": "assistant", "content": "SELECT e.EmployeeID FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID HAVING SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) > 10000;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have been ordered with the highest quantities?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(Quantity) AS TotalQuantity FROM [Order Details] GROUP BY ProductID ORDER BY TotalQuantity DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customer received the most orders last year?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS OrderCount FROM orders WHERE YEAR(OrderDate) = YEAR(CURRENT_DATE) - 1 GROUP BY CustomerID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which suppliers have products with a reorder level greater than 50?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID WHERE products.ReorderLevel > 50;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the total sales revenue for the current year?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = YEAR(CURDATE())"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top 5 products by revenue over the past 3 months?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity * od.UnitPrice) AS TotalRevenue FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID WHERE od.OrderDate >= DATEADD(MONTH, -3, CURRENT_DATE) GROUP BY p.ProductName ORDER BY TotalRevenue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have never been ordered?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Assess the correlation between discounts offered and sales quantities."}, {"role": "assistant", "content": "SELECT CORR(Discount, Quantity) AS DiscountSalesCorrelation FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total freight cost for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, SUM(Freight) AS TotalFreightCost FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List employees and their total sales sorted by the highest sales first."}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID ORDER BY TotalSales DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the impact of employee title on their sales performance."}, {"role": "assistant", "content": "SELECT e.Title, AVG(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS AvgSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.Title;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the relationship between order frequency and customer region."}, {"role": "assistant", "content": "SELECT c.Region, COUNT(o.OrderID) AS OrderFrequency FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID GROUP BY c.Region ORDER BY OrderFrequency DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Calculate the total freight cost by country."}, {"role": "assistant", "content": "SELECT orders.ShipCountry, SUM(orders.Freight) AS total_freight_cost FROM orders GROUP BY orders.ShipCountry"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total number of orders placed each year?"}, {"role": "assistant", "content": "SELECT EXTRACT(YEAR FROM OrderDate) AS Year, COUNT(OrderID) AS TotalOrders FROM orders GROUP BY EXTRACT(YEAR FROM OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the percentage of discontinued products per category."}, {"role": "assistant", "content": "SELECT CategoryID, COUNT(*) * 100.0 / (SELECT COUNT(*) FROM products WHERE CategoryID = p.CategoryID) AS DiscontinuedPercentage FROM products p WHERE p.Discontinued = 1 GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the top 5 products with the highest quantity on order."}, {"role": "assistant", "content": "SELECT ProductName, UnitsOnOrder FROM products WHERE Discontinued = 0 ORDER BY UnitsOnOrder DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify products with a unit price less than the lowest unit price in their category."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitPrice < (SELECT MIN(UnitPrice) FROM products AS p2 WHERE p2.CategoryID = products.CategoryID);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How much revenue has each supplier generated?"}, {"role": "assistant", "content": "SELECT s.SupplierID, SUM(od.Quantity * (od.UnitPrice - (od.UnitPrice * od.Discount))) AS Revenue FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN suppliers s ON p.SupplierID = s.SupplierID GROUP BY s.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the most common shipping country?"}, {"role": "assistant", "content": "SELECT ShipCountry, COUNT(OrderID) AS NumberOfOrders FROM orders GROUP BY ShipCountry ORDER BY NumberOfOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier provides the most products?"}, {"role": "assistant", "content": "SELECT SupplierID, COUNT(ProductID) as ProductCount FROM products GROUP BY SupplierID ORDER BY ProductCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total freight cost managed by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(o.Freight) AS TotalFreight FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which shipping method has the highest total freight cost?"}, {"role": "assistant", "content": "SELECT ShipVia, SUM(Freight) AS TotalFreightCost FROM orders GROUP BY ShipVia ORDER BY TotalFreightCost DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the shipping method with the highest average order fulfillment time."}, {"role": "assistant", "content": "SELECT ShipVia, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY ShipVia ORDER BY AvgFulfillmentTime DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which supplier has the shortest average lead time?"}, {"role": "assistant", "content": "SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY products.SupplierID ORDER BY supplier_lead_time ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average fulfillment time for orders shipped to each country?"}, {"role": "assistant", "content": "SELECT ShipCountry, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY ShipCountry"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many unique products are ordered by each customer?"}, {"role": "assistant", "content": "SELECT o.CustomerID, COUNT(DISTINCT od.ProductID) AS UniqueProducts FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales value for each month in the year 2022?"}, {"role": "assistant", "content": "SELECT TO_CHAR(OrderDate, 'YYYY-MM') AS Month, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN \"Order Details\" od ON o.OrderID = od.OrderID WHERE EXTRACT(YEAR FROM OrderDate) = 2022 GROUP BY TO_CHAR(OrderDate, 'YYYY-MM');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify orders with a discount greater than 20%."}, {"role": "assistant", "content": "SELECT OrderID, Discount FROM [Order Details] WHERE Discount > 0.2;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee has handled the most diverse set of products?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(DISTINCT od.ProductID) AS ProductVariety FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID ORDER BY ProductVariety DESC LIMIT 1;"}]}
