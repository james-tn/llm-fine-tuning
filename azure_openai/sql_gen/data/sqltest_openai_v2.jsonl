{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What was the average order value in Q1 of 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS AvgOrderValue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE OrderDate BETWEEN '2023-01-01' AND '2023-03-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have the lowest units in stock?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName, UnitsInStock FROM products ORDER BY UnitsInStock ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customers placed the highest number of orders last year?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS OrderCount FROM orders WHERE YEAR(OrderDate) = YEAR(CURDATE()) - 1 GROUP BY CustomerID ORDER BY OrderCount DESC"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total revenue generated by each product."}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity * od.UnitPrice) AS TotalRevenue FROM [Order Details] od INNER JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customers are from the United States?"}, {"role": "assistant", "content": "SELECT CustomerID FROM orders WHERE ShipCountry = 'USA'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the products that are being sold at a discount (UnitPrice in orders < UnitPrice in products)."}, {"role": "assistant", "content": "SELECT p.ProductName FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE od.UnitPrice < p.UnitPrice;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which employees generated the highest sales revenue in April 2023?"}, {"role": "assistant", "content": "SELECT employees.FirstName, employees.LastName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID WHERE orders.OrderDate BETWEEN '2023-04-01' AND '2023-04-30' GROUP BY employees.EmployeeID ORDER BY total_sales DESC"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order value handled by each employee?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, AVG([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS AvgOrderValue FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the total revenue generated by each product."}, {"role": "assistant", "content": "SELECT ProductID, SUM(Quantity * UnitPrice) AS TotalRevenue FROM [Order Details] GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the inventory turnover ratio for each month."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') as Month, SUM(od.Quantity * od.UnitPrice) / AVG(p.UnitsInStock) as InventoryTurnoverRatio FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the performance of products based on sales and inventory levels for each month in 2022?"}, {"role": "assistant", "content": "SELECT products.ProductID, MONTH(orders.OrderDate) AS order_month, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY products.ProductID, order_month"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales revenue generated by each customer?"}, {"role": "assistant", "content": "SELECT CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY CustomerID ORDER BY TotalSales DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee has processed the most orders for customers in the USA?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, employees.FirstName, employees.LastName, COUNT(orders.OrderID) AS OrderCount FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID WHERE orders.ShipCountry = 'USA' GROUP BY employees.EmployeeID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which product had the highest sales quantity in the last month?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, SUM(od.Quantity) AS TotalQuantity FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID WHERE od.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH) GROUP BY p.ProductID, p.ProductName ORDER BY TotalQuantity DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: For each employee, what is the average number of orders handled per month in 2023?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, AVG(order_count) AS avg_orders_per_month FROM (SELECT employees.EmployeeID, COUNT(orders.OrderID) AS order_count, MONTH(orders.OrderDate) AS order_month FROM employees LEFT JOIN orders ON employees.EmployeeID = orders.EmployeeID GROUP BY employees.EmployeeID, MONTH(orders.OrderDate)) AS temp GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many discontinued products are still in stock?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS DiscontinuedInStock FROM products WHERE Discontinued = 1 AND UnitsInStock > 0;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the most frequently used shipping method."}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS UseCount FROM orders GROUP BY ShipVia ORDER BY UseCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have not been ordered in the last three months?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details] WHERE OrderID IN (SELECT OrderID FROM orders WHERE OrderDate >= DATE_SUB(CURDATE(), INTERVAL 3 MONTH)));"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average Inventory Turnover Ratio for each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, SUM(od.Quantity * od.UnitPrice) / AVG(p.UnitsInStock) AS InventoryTurnoverRatio FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the top 5 employees with the highest salaries."}, {"role": "assistant", "content": "SELECT EmployeeID, FirstName, LastName, Salary FROM employees ORDER BY Salary DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What's the average discount applied to products?"}, {"role": "assistant", "content": "SELECT AVG(Discount) AS AverageDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total sales revenue generated each month."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(o.OrderDate, '%Y-%m') AS Month, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS MonthlySales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What percentage of orders were shipped after the required date each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, COUNT(CASE WHEN ShippedDate > RequiredDate THEN 1 END) / COUNT(OrderID) AS LateDeliveryRate FROM orders GROUP BY DATE_FORMAT(OrderDate, '%Y-%m')"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which shipping method was used most frequently?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS UsageCount FROM orders GROUP BY ShipVia ORDER BY UsageCount DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the customer retention rate from January 2022 to January 2023?"}, {"role": "assistant", "content": "(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2022-01-01' AND '2023-01-01') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2022-01-01') AS customer_retention_rate"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order value for the year 2021?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS AverageOrderValue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE YEAR(orders.OrderDate) = 2021;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the top 3 products with the most number of orders."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, COUNT(od.OrderID) AS NumberOfOrders FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductID, p.ProductName ORDER BY NumberOfOrders DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What are the average monthly sales generated by each region?"}, {"role": "assistant", "content": "SELECT territories.RegionID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT DATE_TRUNC('month', orders.OrderDate)) AS avg_monthly_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID JOIN employeeTerritories ON employees.EmployeeID = employeeTerritories.EmployeeID JOIN territories ON employeeTerritories.TerritoryID = territories.TerritoryID GROUP BY territories.RegionID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the order with the highest discount applied."}, {"role": "assistant", "content": "SELECT od.OrderID, MAX(od.Discount) FROM [Order Details] od;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the monthly total sales revenue over the last year."}, {"role": "assistant", "content": "SELECT MONTH(o.OrderDate) AS Month, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE YEAR(o.OrderDate) = YEAR(CURRENT_DATE) GROUP BY MONTH(o.OrderDate) ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many units are currently in stock for each product?"}, {"role": "assistant", "content": "SELECT ProductName, UnitsInStock FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List employees who have birthdays in the current month."}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName FROM employees e WHERE MONTH(e.BirthDate) = MONTH(CURRENT_DATE);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales revenue for each product?"}, {"role": "assistant", "content": "SELECT P.ProductID, SUM(OD.Quantity * OD.UnitPrice) AS TotalSalesRevenue FROM [Order Details] OD JOIN products P ON OD.ProductID = P.ProductID GROUP BY P.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Who is the highest paid employee and what is their total sales?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.Salary, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID ORDER BY e.Salary DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount given for each supplier's products?"}, {"role": "assistant", "content": "SELECT p.SupplierID, AVG(od.Discount) AS AvgDiscount FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total sales revenue generated in the last month."}, {"role": "assistant", "content": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales per employee for each month?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, strftime('%Y-%m', o.OrderDate) as OrderMonth, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) as TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, OrderMonth;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How does the total number of units sold compare between discontinued and active products?"}, {"role": "assistant", "content": "SELECT products.Discontinued, SUM([Order Details].Quantity) AS TotalUnitsSold FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.Discontinued"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Count the total number of orders placed by each customer."}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(*) AS total_orders FROM orders GROUP BY CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the product categories with the lowest total sales revenue."}, {"role": "assistant", "content": "SELECT CategoryID, SUM(od.Quantity * od.UnitPrice) AS TotalRevenue FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.CategoryID ORDER BY TotalRevenue ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the product categories with the highest average unit price."}, {"role": "assistant", "content": "SELECT CategoryID, AVG(UnitPrice) AS AverageUnitPrice FROM products GROUP BY CategoryID ORDER BY AverageUnitPrice DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders included products with a discount of more than 10%?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE od.Discount > 0.1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the performance ranking of products based on sales quantity?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, SUM(od.Quantity) AS TotalQuantity FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductID, p.ProductName ORDER BY TotalQuantity DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the orders grouped by required dates and their total freight costs."}, {"role": "assistant", "content": "SELECT RequiredDate, SUM(Freight) AS TotalFreightCost FROM orders GROUP BY RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the month-over-month growth rate of total sales for December 2023."}, {"role": "assistant", "content": "SELECT (SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) - LAG(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))) OVER (ORDER BY DATE_FORMAT(o.OrderDate, '%Y-%m'))) / LAG(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))) OVER (ORDER BY DATE_FORMAT(o.OrderDate, '%Y-%m') ) AS MoM_GrowthRate FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE DATE_FORMAT(o.OrderDate, '%Y-%m') IN ('2023-11', '2023-12');"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How does the average unit price of products vary across categories?"}, {"role": "assistant", "content": "SELECT products.CategoryID, AVG(products.UnitPrice) AS AverageUnitPrice FROM products GROUP BY products.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the most common shipping city for the current year?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(*) AS OrderCount FROM orders WHERE YEAR(OrderDate) = YEAR(CURDATE()) GROUP BY ShipCity ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many products have a reorder level of zero?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS ZeroReorderProducts FROM products WHERE ReorderLevel = 0"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated by each product?"}, {"role": "assistant", "content": "SELECT p.ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM [Order Details] od INNER JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the total quantity sold for each product, excluding discontinued products."}, {"role": "assistant", "content": "SELECT products.ProductID, products.ProductName, SUM([Order Details].Quantity) AS TotalQuantitySold FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID WHERE products.Discontinued = 0 GROUP BY products.ProductID, products.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the average discount applied across all products."}, {"role": "assistant", "content": "SELECT AVG(Discount) AS AverageDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were placed each month in the last year?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, COUNT(OrderID) AS OrderCount FROM orders WHERE OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY Month ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the count of products in each category, supplied by supplier."}, {"role": "assistant", "content": "SELECT s.SupplierID, s.CompanyName, p.CategoryID, COUNT(p.ProductID) AS ProductCount FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID GROUP BY s.SupplierID, s.CompanyName, p.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order fulfillment time for March 2023?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AverageFulfillmentTime FROM orders o WHERE o.OrderDate BETWEEN '2023-03-01' AND '2023-03-31';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the top 3 suppliers based on the total sales value of their products."}, {"role": "assistant", "content": "SELECT SupplierID, SUM([Order Details].UnitPrice * Quantity) AS TotalSalesValue FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY SupplierID ORDER BY TotalSalesValue DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List all products that need reordering."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock <= ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average order fulfillment time by month for 2023?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(orders.OrderDate, '%Y-%m') AS month, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_fulfillment_time FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY month"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have less than 10 units in stock?"}, {"role": "assistant", "content": "SELECT ProductName, UnitsInStock FROM products WHERE UnitsInStock < 10;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee processed the most orders?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS TotalOrders FROM orders GROUP BY EmployeeID ORDER BY TotalOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the customer with the most late shipments."}, {"role": "assistant", "content": "SELECT c.CustomerID, COUNT(o.OrderID) AS LateOrderCount FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID WHERE o.RequiredDate < o.ShippedDate GROUP BY c.CustomerID ORDER BY LateOrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the orders placed in the last 30 days and their total freight cost."}, {"role": "assistant", "content": "SELECT o.OrderID, o.OrderDate, o.ShippedDate, o.Freight FROM orders o WHERE o.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 30 DAY);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the number of discontinued products."}, {"role": "assistant", "content": "SELECT COUNT(*) AS DiscontinuedProducts FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average shipping cost per order per month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(Freight) AS AvgShippingCost FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find out how many orders each employee managed in a specific date range."}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) AS OrderCount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.OrderDate BETWEEN 'start date' AND 'end date' GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have been discontinued?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the monthly inventory turnover ratio?"}, {"role": "assistant", "content": "SELECT DATEPART(month, OrderDate) AS Month, SUM(OD.Quantity * OD.UnitPrice) / AVG(P.UnitsInStock) AS InventoryTurnoverRatio FROM [Order Details] OD JOIN products P ON OD.ProductID = P.ProductID GROUP BY DATEPART(month, OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products are associated with the highest total order quantities?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS TotalOrderedQuantity FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName ORDER BY TotalOrderedQuantity DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the names of products that are currently discontinued?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total freight cost for all orders made in the year 2022?"}, {"role": "assistant", "content": "SELECT SUM(Freight) AS TotalFreightCost FROM orders WHERE OrderDate BETWEEN '2022-01-01' AND '2022-12-31';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales revenue generated in each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the CustomerID and the total number of orders for each customer who has ordered more than 10 times."}, {"role": "assistant", "content": "SELECT customers.CustomerID, COUNT(orders.OrderID) AS order_count FROM customers INNER JOIN orders ON customers.CustomerID = orders.CustomerID GROUP BY customers.CustomerID HAVING COUNT(orders.OrderID) > 10"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped over a week late in August 2023?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS LateOrders FROM orders WHERE DATEDIFF(ShippedDate, RequiredDate) > 7 AND OrderDate BETWEEN '2023-08-01' AND '2023-08-31';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee achieved the highest sales in 2022?"}, {"role": "assistant", "content": "SELECT o.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY o.EmployeeID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top 5 best-selling products?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS TotalSales FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName ORDER BY TotalSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have a discount applied in more than 10 orders?"}, {"role": "assistant", "content": "SELECT p.ProductName, COUNT(*) AS OrderCount FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE od.Discount > 0.0 GROUP BY p.ProductName HAVING OrderCount > 10;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average order value for June 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-06-01' AND '2023-06-30'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average value of orders placed in January 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-01-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the customers along with their total spent amounts, ordered by highest to lowest total spent."}, {"role": "assistant", "content": "SELECT c.CustomerID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSpent FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID ORDER BY TotalSpent DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average order value for Q1 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-03-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List orders where the shipping cost was above average."}, {"role": "assistant", "content": "SELECT * FROM orders WHERE Freight > (SELECT AVG(Freight) FROM orders);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average freight cost for orders shipped to Europe?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AverageFreightCost FROM orders WHERE ShipCountry IN ('Austria', 'Belgium', 'Denmark', 'Finland', 'France', 'Germany', 'Greece', 'Ireland', 'Italy', 'Netherlands', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland', 'United Kingdom');"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average salary of employees by title?"}, {"role": "assistant", "content": "SELECT Title, AVG(Salary) AS AvgSalary FROM employees GROUP BY Title;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total number of orders for each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, COUNT(od.OrderID) AS OrderCount FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the top 5 products with the highest unit price."}, {"role": "assistant", "content": "SELECT ProductName, UnitPrice FROM products ORDER BY UnitPrice DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Calculate the total freight cost for each shipping company in 2023."}, {"role": "assistant", "content": "SELECT shippers.CompanyName, SUM(orders.Freight) AS total_freight_cost FROM orders JOIN shippers ON orders.ShipVia = shippers.ShipperID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY shippers.CompanyName"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the percentage of orders that were shipped within 3 days of being placed?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN DATEDIFF(ShippedDate, OrderDate) <= 3 THEN 1 END) / COUNT(*) * 100 AS WithinThreeDays FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have been ordered with a discount?"}, {"role": "assistant", "content": "SELECT DISTINCT p.ProductName FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE od.Discount > 0;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total number of orders shipped via each shipping method per month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, ShipVia, COUNT(OrderID) AS OrdersShipped FROM orders GROUP BY Month, ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the total number of products supplied by each supplier."}, {"role": "assistant", "content": "SELECT SupplierID, COUNT(ProductID) AS TotalProducts FROM products GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products need to be reordered?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock <= ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have the highest total sales volume in quantity?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS TotalSalesQuantity FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductName ORDER BY TotalSalesQuantity DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How many orders were placed and fulfilled in each month of 2023?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(orders.OrderDate, '%Y-%m') AS month, COUNT(orders.OrderID) AS orders_placed, COUNT(CASE WHEN orders.ShippedDate IS NOT NULL THEN 1 END) AS orders_fulfilled FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY month ORDER BY month"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What was the total sales revenue generated in the year 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier supplies the highest number of different products?"}, {"role": "assistant", "content": "SELECT SupplierID, COUNT(DISTINCT ProductID) AS ProductCount FROM products GROUP BY SupplierID ORDER BY ProductCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average shipping cost per order for 2023?"}, {"role": "assistant", "content": "SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total value of orders shipped in the first quarter of 2023?"}, {"role": "assistant", "content": "SELECT QUARTER(o.OrderDate) AS OrderQuarter, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalValue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE YEAR(o.OrderDate) = 2023 GROUP BY OrderQuarter;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the Customer Retention Rate for the last 6 months?"}, {"role": "assistant", "content": "SELECT (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 6 MONTH) AND CURDATE()) / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < DATE_SUB(CURDATE(), INTERVAL 6 MONTH)) AS CustomerRetentionRate;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the most common job title among the employees?"}, {"role": "assistant", "content": "SELECT Title, COUNT(*) AS TitleCount FROM employees GROUP BY Title ORDER BY TitleCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the difference in days between the hire date and the birthdate of employees."}, {"role": "assistant", "content": "SELECT EmployeeID, JULIANDAY(HireDate) - JULIANDAY(BirthDate) AS DaysDifference FROM employees;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How many products are discontinued?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS discontinued_products FROM products WHERE products.Discontinued = 1"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List all orders that took more than 10 days to fulfill in 2021."}, {"role": "assistant", "content": "SELECT OrderID FROM orders WHERE YEAR(OrderDate) = 2021 AND DATEDIFF(ShippedDate, OrderDate) > 10;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What was the total sales revenue generated each month in the year 2022?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE YEAR(OrderDate) = 2022 GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What was the total sales revenue for the month of January 2023?"}, {"role": "assistant", "content": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE DATE_FORMAT(o.OrderDate, '%Y-%m') = '2023-01';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average order value for orders placed between January 1, 2023, and December 31, 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which city has received the highest number of orders?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) as TotalOrders FROM orders GROUP BY ShipCity ORDER BY TotalOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which product category has the highest total sales in 2023?"}, {"role": "assistant", "content": "SELECT categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN categories ON products.CategoryID = categories.CategoryID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY categories.CategoryName ORDER BY total_sales DESC"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average reorder level across all products?"}, {"role": "assistant", "content": "SELECT AVG(ReorderLevel) AS AverageReorderLevel FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total inventory value of products currently in stock?"}, {"role": "assistant", "content": "SELECT SUM(UnitsInStock * UnitPrice) AS TotalInventoryValue FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the average quantity of products ordered per order."}, {"role": "assistant", "content": "SELECT AVG(Quantity) AS AverageQuantity FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the percentage of orders shipped within the same country as the customer?"}, {"role": "assistant", "content": "SELECT (COUNT(*) / (SELECT COUNT(*) from orders) * 100) as percent_same_country FROM orders o JOIN customers c ON o.CustomerID = c.CustomerID WHERE o.ShipCountry = c.Country;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List all employees who were hired this year."}, {"role": "assistant", "content": "SELECT * FROM employees WHERE YEAR(HireDate) = YEAR(CURDATE());"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated each year?"}, {"role": "assistant", "content": "SELECT EXTRACT(YEAR FROM OrderDate) AS Year, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS YearlyRevenue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY Year ORDER BY Year;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the total quantity ordered for each product."}, {"role": "assistant", "content": "SELECT ProductID, SUM(Quantity) AS total_quantity FROM [Order Details] GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How many orders have been placed by customers in Germany in the year 2023?"}, {"role": "assistant", "content": "SELECT COUNT(o.OrderID) FROM orders o JOIN customers c ON o.CustomerID = c.CustomerID WHERE c.Country = 'Germany' AND o.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average age of employees."}, {"role": "assistant", "content": "SELECT AVG((CURRENT_DATE - BirthDate) / 365.25) AS AvgAge FROM employees;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total discount given on orders placed in 2022?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * [Order Details].Discount) AS total_discount FROM orders INNER JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE YEAR(orders.OrderDate) = 2022"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customer region had the highest average order fulfillment time in the past month?"}, {"role": "assistant", "content": "SELECT ShipRegion, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders WHERE OrderDate >= CURDATE() - INTERVAL 1 MONTH GROUP BY ShipRegion ORDER BY AvgFulfillmentTime DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average price per unit of all products?"}, {"role": "assistant", "content": "SELECT AVG(UnitPrice) AS AveragePrice FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the average order value for each customer."}, {"role": "assistant", "content": "SELECT c.CustomerID, AVG(od.UnitPrice * od.Quantity * (1 - od.Discount)) as average_order_value FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the on-time delivery rate for the month of April 2023?"}, {"role": "assistant", "content": "SELECT COUNT(orders.OrderID) FILTER (WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders WHERE orders.OrderDate BETWEEN '2023-04-01' AND '2023-04-30'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the on-time delivery rate for each month in 2023?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS month, COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE NULL END) * 1.0 / COUNT(*) AS on_time_delivery_rate FROM orders WHERE YEAR(OrderDate) = 2023 GROUP BY month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the total number of units on order for each product in 2022?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM(products.UnitsOnOrder) AS units_on_order FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY products.ProductID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the names and prices of products that have less than 20 units in stock?"}, {"role": "assistant", "content": "SELECT ProductName, UnitPrice FROM products WHERE UnitsInStock < 20;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total quantity of products sold per product category."}, {"role": "assistant", "content": "SELECT CategoryID, SUM([Order Details].Quantity) AS TotalQuantity FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY CategoryID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List all orders that were shipped to Germany."}, {"role": "assistant", "content": "SELECT * FROM orders WHERE ShipCountry = 'Germany';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Who are the top 3 employees based on total sales generated?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID ORDER BY TotalSales DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the total sales for each product?"}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the orders that have not been shipped within the required date."}, {"role": "assistant", "content": "SELECT orders.OrderID, orders.RequiredDate, orders.ShippedDate FROM orders WHERE orders.ShippedDate IS NULL OR orders.ShippedDate > orders.RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How many products have been discontinued?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS discontinued_count FROM products WHERE products.Discontinued = 1"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the total units ordered for each supplier?"}, {"role": "assistant", "content": "SELECT s.SupplierID, SUM(od.Quantity) AS TotalUnitsOrdered FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.SupplierID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the orders that were placed but never shipped in 2022."}, {"role": "assistant", "content": "SELECT OrderID FROM orders WHERE ShippedDate IS NULL AND DATE_FORMAT(OrderDate, '%Y') = '2022'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated by each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales revenue generated in the month of January 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE OrderDate BETWEEN '2023-01-01' AND '2023-01-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total quantity of each product sold?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].Quantity) AS TotalQuantity FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top 5 customers by order value?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalOrderValue FROM customers INNER JOIN orders ON customers.CustomerID = orders.CustomerID INNER JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID ORDER BY TotalOrderValue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many products are in each category?"}, {"role": "assistant", "content": "SELECT CategoryID, COUNT(ProductID) AS ProductCount FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the employees who report to each manager."}, {"role": "assistant", "content": "SELECT Manager.LastName AS ManagerLastName, Manager.FirstName AS ManagerFirstName, Subordinate.LastName AS EmployeeLastName, Subordinate.FirstName AS EmployeeFirstName FROM employees AS Subordinate JOIN employees AS Manager ON Subordinate.ReportsTo = Manager.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee generated the most sales in the last year?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE YEAR(o.OrderDate) = YEAR(CURDATE()) GROUP BY e.EmployeeID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products need to be reordered soon?"}, {"role": "assistant", "content": "SELECT products.ProductName FROM products WHERE products.UnitsInStock <= products.ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders did each employee handle in the first quarter of this year?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) AS OrderCount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.OrderDate BETWEEN '2023-01-01' AND '2023-03-31' GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales for each product category this year?"}, {"role": "assistant", "content": "SELECT categories.CategoryName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID JOIN products ON [Order Details].ProductID = products.ProductID JOIN categories ON products.CategoryID = categories.CategoryID WHERE YEAR(orders.OrderDate) = YEAR(CURDATE()) GROUP BY categories.CategoryName"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the total freight cost for all orders shipped via each shipping method in 2022."}, {"role": "assistant", "content": "SELECT ShipVia, SUM(Freight) AS TotalFreight FROM orders WHERE YEAR(OrderDate) = 2022 GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the five cities with the highest total sales?"}, {"role": "assistant", "content": "SELECT ShipCity, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY ShipCity ORDER BY TotalSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total number of units ordered for each product category."}, {"role": "assistant", "content": "SELECT c.CategoryID, SUM(od.Quantity) AS TotalUnitsOrdered FROM [Order Details] od INNER JOIN products p ON od.ProductID = p.ProductID INNER JOIN categories c ON p.CategoryID = c.CategoryID GROUP BY c.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the monthly trend of order placements for the current year?"}, {"role": "assistant", "content": "SELECT MONTH(OrderDate) AS Month, COUNT(*) AS NumberOfOrders FROM orders WHERE YEAR(OrderDate) = YEAR(CURDATE()) GROUP BY MONTH(OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How long has each employee been working at the company?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, DATEDIFF(CURDATE(), employees.HireDate) AS DaysWorked FROM employees;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products need reordering?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock <= ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many products have a reorder level higher than 20?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS HighReorderProducts FROM products WHERE ReorderLevel > 20;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the customers who have not placed any orders in the current year."}, {"role": "assistant", "content": "SELECT CustomerID FROM customers WHERE CustomerID NOT IN (SELECT DISTINCT CustomerID FROM orders WHERE OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR));"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the top 5 customers who have incurred the highest total freight costs."}, {"role": "assistant", "content": "SELECT CustomerID, SUM(Freight) AS TotalFreight FROM orders GROUP BY CustomerID ORDER BY TotalFreight DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How many units of each product were sold in the first quarter of 2023?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].Quantity) AS units_sold FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-03-31' GROUP BY products.ProductID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped via each shipping method in 2023?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS OrderCount FROM orders WHERE OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY ShipVia"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were placed each month in the current year?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS OrderMonth, COUNT(OrderID) AS TotalOrders FROM orders WHERE YEAR(OrderDate) = YEAR(CURDATE()) GROUP BY OrderMonth ORDER BY OrderMonth;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which product had the highest average discount?"}, {"role": "assistant", "content": "SELECT ProductID, AVG(Discount) AS AvgDiscount FROM [Order Details] GROUP BY ProductID ORDER BY AvgDiscount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What percentage of total stock does each product contribute?"}, {"role": "assistant", "content": "SELECT p.ProductID, ROUND(p.UnitsInStock / (SELECT SUM(UnitsInStock) FROM products) * 100, 2) AS StockPercentage FROM products p;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee processed the highest number of orders last month?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) AS OrderCount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE YEAR(o.OrderDate) = YEAR(CURDATE()) AND MONTH(o.OrderDate) = MONTH(CURDATE()) - 1 GROUP BY e.EmployeeID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the month with the highest total sales."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') as order_month, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) as total_sales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY order_month ORDER BY total_sales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the top 5 suppliers based on the total sales revenue."}, {"role": "assistant", "content": "SELECT p.SupplierID, s.CompanyName, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM products p JOIN suppliers s ON p.SupplierID = s.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.SupplierID, s.CompanyName ORDER BY TotalRevenue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customer generated the highest lifetime value?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS CustomerLifetimeValue FROM customers INNER JOIN orders ON customers.CustomerID = orders.CustomerID INNER JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID ORDER BY CustomerLifetimeValue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many employees live in each country?"}, {"role": "assistant", "content": "SELECT Country, COUNT(EmployeeID) AS EmployeeCount FROM employees GROUP BY Country;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales revenue for the month of January 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE MONTH(OrderDate) = 1 AND YEAR(OrderDate) = 2023;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the top 5 cities with the highest average shipping cost."}, {"role": "assistant", "content": "SELECT ShipCity, AVG(Freight) AS AverageFreight FROM orders GROUP BY ShipCity ORDER BY AverageFreight DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products need to be reordered (units in stock less than reorder level)?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top 5 products by sales revenue?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(UnitPrice * Quantity * (1 - Discount)) AS TotalSales FROM [Order Details] GROUP BY ProductID ORDER BY TotalSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the correlation between employee hire date and performance?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, employees.HireDate, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID ORDER BY employees.HireDate;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How many new customers were acquired in May 2023?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT customers.CustomerID) AS new_customers FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID WHERE orders.OrderDate BETWEEN '2023-05-01' AND '2023-05-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which suppliers provide products that are currently in stock?"}, {"role": "assistant", "content": "SELECT DISTINCT SupplierID FROM products WHERE UnitsInStock > 0;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many employees are there in each country?"}, {"role": "assistant", "content": "SELECT Country, COUNT(*) AS NumEmployees FROM employees GROUP BY Country;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average fulfillment time for orders by month?"}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM OrderDate) AS Month, AVG(DATEDIFF(DAY, OrderDate, ShippedDate)) AS AvgFulfillmentTime FROM orders GROUP BY EXTRACT(MONTH FROM OrderDate)"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many days on average does it take to fulfill an order?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(day, OrderDate, ShippedDate)) AS AvgFulfillmentTime FROM orders"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount applied per product?"}, {"role": "assistant", "content": "SELECT AVG(Discount) AS AverageDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which suppliers have supplied the most products?"}, {"role": "assistant", "content": "SELECT s.SupplierID, COUNT(p.ProductID) AS TotalProductsSupplied FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID GROUP BY s.SupplierID ORDER BY TotalProductsSupplied DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which regions have the highest on-time delivery rates?"}, {"role": "assistant", "content": "SELECT ShipRegion, (COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END) * 100.0 / COUNT(OrderID)) AS OnTimeDeliveryRate FROM orders GROUP BY ShipRegion ORDER BY OnTimeDeliveryRate DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were handled by employees who were hired in the year 2020?"}, {"role": "assistant", "content": "SELECT COUNT(orders.OrderID) AS TotalOrders FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID WHERE YEAR(HireDate) = 2020;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount applied to products per month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS month, AVG(Discount) AS AverageDiscount FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average time between order date and required date?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(RequiredDate, OrderDate)) AS AverageLeadTime FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many products have a stock level below their reorder level?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which orders were delayed more than five days past the required date?"}, {"role": "assistant", "content": "SELECT OrderID FROM orders WHERE DATEDIFF(ShippedDate, RequiredDate) > 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average time taken to fulfill an order?"}, {"role": "assistant", "content": "SELECT AVG(DATE_PART('day', ShippedDate::timestamp - OrderDate::timestamp)) AS AverageFulfillmentTime FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total value of current inventory (UnitPrice * UnitsInStock) for all products."}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * UnitsInStock) AS TotalInventoryValue FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average lead time for each supplier?"}, {"role": "assistant", "content": "SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS AverageLeadTime FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY products.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List all orders including the details of the employee who handled them."}, {"role": "assistant", "content": "SELECT orders.OrderID, orders.CustomerID, orders.OrderDate, employees.LastName, employees.FirstName FROM orders JOIN employees ON orders.EmployeeID = employees.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total quantity of products ordered from each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.Quantity) AS TotalQuantity FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped late in the last month?"}, {"role": "assistant", "content": "SELECT COUNT(orders.OrderID) AS Late_Orders FROM orders WHERE orders.RequiredDate < orders.ShippedDate AND MONTH(orders.OrderDate) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH) AND YEAR(orders.OrderDate) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped late (i.e., shipped after the required date)?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS LateOrders FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee has the most orders shipped on time?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) AS OnTimeOrders FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.ShippedDate <= o.RequiredDate GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the most frequently ordered product?"}, {"role": "assistant", "content": "SELECT p.ProductName, COUNT(od.ProductID) AS OrderCount FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductName ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have a unit price greater than 50?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitPrice > 50;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many units of each product were ordered last month?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].Quantity) AS UnitsOrderedLastMonth FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID WHERE [Order Details].OrderDate >= DATEADD(month, -1, GETDATE()) GROUP BY products.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which shipping company has the highest on-time delivery rate?"}, {"role": "assistant", "content": "SELECT shippers.CompanyName, COUNT(orders.OrderID) WHERE orders.ShippedDate <= orders.RequiredDate / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders JOIN shippers ON orders.ShipVia = shippers.ShipperID GROUP BY shippers.CompanyName ORDER BY on_time_delivery_rate DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total discount amount given for each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.UnitPrice * od.Quantity * od.Discount) AS TotalDiscount FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total number of products sold by each employee."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].Quantity) AS TotalProductsSold FROM employees INNER JOIN orders ON employees.EmployeeID = orders.EmployeeID INNER JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List customers who have not placed any orders in the last year."}, {"role": "assistant", "content": "SELECT c.CustomerID, c.CompanyName FROM customers c LEFT JOIN orders o ON c.CustomerID = o.CustomerID WHERE o.OrderID IS NULL OR o.OrderDate < DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify products with a unit price greater than the average unit price across all products."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName FROM products p WHERE p.UnitPrice > (SELECT AVG(UnitPrice) FROM products);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the most frequently ordered product in 2023?"}, {"role": "assistant", "content": "SELECT products.ProductID, products.ProductName, COUNT([Order Details].OrderID) AS order_count FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID ORDER BY order_count DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the names and IDs of all products that are currently out of stock?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE UnitsInStock = 0;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How many products were low on stock (below reorder level) in August 2023?"}, {"role": "assistant", "content": "SELECT products.ProductID FROM products WHERE products.UnitsInStock < products.ReorderLevel AND MONTH(products.RecordDate) = 8 AND YEAR(products.RecordDate) = 2023"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total number of products available in the inventory?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which shipping company has the highest on-time delivery rate?"}, {"role": "assistant", "content": "SELECT ShipVia, SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS OnTimeDeliveryRate FROM orders GROUP BY ShipVia ORDER BY OnTimeDeliveryRate DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top 5 products in terms of total units sold?"}, {"role": "assistant", "content": "SELECT products.ProductID, products.ProductName, SUM([Order Details].Quantity) AS TotalUnitsSold FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductID, products.ProductName ORDER BY TotalUnitsSold DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the monthly average shipping cost?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(Freight) AS AvgShippingCost FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which employee has the highest sales in Q1 2023?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-03-31' GROUP BY employees.EmployeeID ORDER BY employee_sales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the total revenue generated from each product sold in 2022?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_revenue FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY products.ProductID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the most ordered product in terms of quantity?"}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].Quantity) AS TotalQuantityOrdered FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductName ORDER BY TotalQuantityOrdered DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many products have less than 10 units in stock?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE UnitsInStock < 10;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the top 5 products with the highest total sales revenue."}, {"role": "assistant", "content": "SELECT products.ProductID, products.ProductName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID, products.ProductName ORDER BY TotalSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have the highest and lowest inventory turnover ratio?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity * od.UnitPrice) / AVG(p.UnitsInStock) AS InventoryTurnoverRatio FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName ORDER BY InventoryTurnoverRatio DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify employees with the highest and lowest order counts."}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, COUNT(o.OrderID) AS OrderCount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID ORDER BY OrderCount DESC LIMIT 1 UNION SELECT e.EmployeeID, e.FirstName, e.LastName, COUNT(o.OrderID) AS OrderCount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID ORDER BY OrderCount ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee handled the most orders?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS OrderCount FROM orders GROUP BY EmployeeID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average lead time for each supplier in delivered products."}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, CompanyName, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS AverageLeadTime FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY suppliers.SupplierID, CompanyName;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average discount given in orders for the year 2023?"}, {"role": "assistant", "content": "SELECT AVG([Order Details].Discount) AS avg_discount FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order fulfillment time by month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgOrderFulfillmentTime FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated by each employee?"}, {"role": "assistant", "content": "SELECT EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) as TotalRevenue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the total freight cost incurred in the year 2023."}, {"role": "assistant", "content": "SELECT SUM(Freight) AS TotalFreightCost2023 FROM orders WHERE YEAR(OrderDate) = 2023;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify which month has the highest number of orders historically."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, COUNT(OrderID) AS OrderCount FROM orders GROUP BY DATE_FORMAT(OrderDate, '%Y-%m') ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average number of products per order."}, {"role": "assistant", "content": "SELECT AVG(od.Quantity) AS AverageProductsPerOrder FROM [Order Details] od;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which product has the highest total sales in 2022?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY products.ProductID ORDER BY total_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How many orders were placed in each quarter of 2022?"}, {"role": "assistant", "content": "SELECT QUARTER(orders.OrderDate) AS order_quarter, COUNT(orders.OrderID) AS total_orders FROM orders WHERE orders.OrderDate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY order_quarter"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many unique customers placed orders in the last quarter?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT CustomerID) FROM orders WHERE OrderDate >= DATEADD(MONTH, -3, GETDATE());"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top three products that generate the most sales revenue?"}, {"role": "assistant", "content": "SELECT od.ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM [Order Details] od GROUP BY od.ProductID ORDER BY TotalRevenue DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the names of products that have been discontinued?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier has supplied the most quantity of products?"}, {"role": "assistant", "content": "SELECT SupplierID, SUM(UnitsOnOrder) AS TotalQuantitySupplied FROM products GROUP BY SupplierID ORDER BY TotalQuantitySupplied DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the average discount given by each employee."}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(od.Discount) AS AvgDiscount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which month had the highest number of orders placed?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, COUNT(OrderID) AS OrderCount FROM orders GROUP BY DATE_FORMAT(OrderDate, '%Y-%m') ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Retrieve the contact information for all suppliers located in a specific region."}, {"role": "assistant", "content": "SELECT SupplierID, CompanyName, ContactName, Phone, City, Region FROM suppliers WHERE Region = 'specified_region';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the discount amount for each order in January 2023."}, {"role": "assistant", "content": "SELECT o.OrderID, SUM(od.UnitPrice * od.Quantity * od.Discount) AS DiscountAmount FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate BETWEEN '2023-01-01' AND '2023-01-31' GROUP BY o.OrderID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the total sales by month?"}, {"role": "assistant", "content": "SELECT YEAR(o.OrderDate) AS Year, MONTH(o.OrderDate) AS Month, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY YEAR(o.OrderDate), MONTH(o.OrderDate) ORDER BY Year, Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which category has the highest number of products?"}, {"role": "assistant", "content": "SELECT CategoryID, COUNT(ProductID) AS NumberOfProducts FROM products GROUP BY CategoryID ORDER BY NumberOfProducts DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products received the highest total discount?"}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].Discount) AS TotalDiscount FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductName ORDER BY TotalDiscount DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which regions have the highest average order value?"}, {"role": "assistant", "content": "SELECT ShipRegion, AVG([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS AverageOrderValue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY ShipRegion ORDER BY AverageOrderValue DESC"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the top 3 customers by revenue in the last quarter."}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) as Revenue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE orders.OrderDate > DATE_SUB(NOW(), INTERVAL 3 MONTH) GROUP BY customers.CustomerID ORDER BY Revenue DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What percentage of orders were delivered before the required date in 2022?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN YEAR(OrderDate) = 2022 AND ShippedDate <= RequiredDate THEN 1 ELSE 0 END) * 1.0 / COUNT(OrderID) AS BeforeRequiredDateRate FROM orders WHERE YEAR(OrderDate) = 2022"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which supplier has the shortest average lead time in April 2023?"}, {"role": "assistant", "content": "SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID JOIN products ON [Order Details].ProductID = products.ProductID WHERE orders.OrderDate BETWEEN '2023-04-01' AND '2023-04-30' GROUP BY products.SupplierID ORDER BY supplier_lead_time ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Who are the employees reporting to each manager?"}, {"role": "assistant", "content": "SELECT m.EmployeeID AS ManagerID, m.LastName AS ManagerLastName, m.FirstName AS ManagerFirstName, e.EmployeeID AS EmployeeID, e.LastName AS EmployeeLastName, e.FirstName AS EmployeeFirstName FROM employees e JOIN employees m ON e.ReportsTo = m.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the average discount applied to orders in January 2023."}, {"role": "assistant", "content": "SELECT AVG(od.Discount) AS AvgDiscount FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate BETWEEN '2023-01-01' AND '2023-01-31';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total sales for employees located in a specific region."}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE e.Region = 'specific region' GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the names of all suppliers who are located in Germany?"}, {"role": "assistant", "content": "SELECT CompanyName FROM suppliers WHERE Country = 'Germany';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What was the average order value in June 2023?"}, {"role": "assistant", "content": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) / COUNT(DISTINCT o.OrderID) AS AvgOrderValue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE DATE_FORMAT(o.OrderDate, '%Y-%m') = '2023-06';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average freight cost for each customer."}, {"role": "assistant", "content": "SELECT CustomerID, AVG(Freight) AS AvgFreight FROM orders GROUP BY CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were placed on weekends in the last three months?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS WeekendOrders FROM orders WHERE DAYOFWEEK(OrderDate) IN (1, 7) AND OrderDate >= DATE_SUB(CURDATE(), INTERVAL 3 MONTH)"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the total sales revenue generated in the year 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many products have been ordered but not yet shipped?"}, {"role": "assistant", "content": "SELECT orders.OrderID FROM orders WHERE orders.ShippedDate IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products are low in stock and need reordering?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock <= ReorderLevel AND Discontinued = 0;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped but not yet delivered by the required date?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the average number of products per order."}, {"role": "assistant", "content": "SELECT AVG(ProductCount) AS AverageProductsPerOrder FROM (SELECT OrderID, COUNT(ProductID) AS ProductCount FROM [Order Details] GROUP BY OrderID) AS ProductCounts;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which suppliers provide products that are currently discontinued?"}, {"role": "assistant", "content": "SELECT DISTINCT suppliers.SupplierID, suppliers.CompanyName FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID WHERE products.Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the most commonly ordered product quantities?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].Quantity) AS MostCommonQuantities FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductID ORDER BY MostCommonQuantities DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the most expensive product by unit price."}, {"role": "assistant", "content": "SELECT ProductName FROM products ORDER BY UnitPrice DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the top 5 highest priced products."}, {"role": "assistant", "content": "SELECT ProductName, UnitPrice FROM products ORDER BY UnitPrice DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List customers with their respective regions and count of orders placed."}, {"role": "assistant", "content": "SELECT customers.CustomerID, customers.Region, COUNT(orders.OrderID) AS total_orders FROM customers LEFT JOIN orders ON customers.CustomerID = orders.CustomerID GROUP BY customers.CustomerID, customers.Region;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the top 5 cities with the highest number of orders."}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipCity ORDER BY OrderCount DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total quantity of each product sold?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(Quantity) AS TotalQuantity FROM [Order Details] GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the total sales and the number of orders for each customer in March 2023."}, {"role": "assistant", "content": "SELECT O.CustomerID, SUM(OD.UnitPrice * OD.Quantity * (1 - OD.Discount)) AS TotalSales, COUNT(O.OrderID) AS OrderCount FROM orders O JOIN [Order Details] OD ON O.OrderID = OD.OrderID WHERE DATE_FORMAT(O.OrderDate, '%Y-%m') = '2023-03' GROUP BY O.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many units have been sold for each product, grouped by supplier?"}, {"role": "assistant", "content": "SELECT s.SupplierName, p.ProductName, SUM(od.Quantity) AS TotalQuantitySold FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.SupplierName, p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the percentage of orders shipped within 5 days of the order date."}, {"role": "assistant", "content": "SELECT COUNT(OrderID) * 100.0 / (SELECT COUNT(OrderID) FROM orders) AS PercentageWithin5Days FROM orders WHERE DATEDIFF(ShippedDate, OrderDate) <= 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total quantity ordered across all products by month?"}, {"role": "assistant", "content": "SELECT MONTH(OrderDate) AS OrderMonth, YEAR(OrderDate) AS OrderYear, SUM(Quantity) AS TotalQuantityOrdered FROM [Order Details] GROUP BY OrderMonth, OrderYear;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which product has generated the highest revenue?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(UnitPrice * Quantity * (1 - Discount)) AS Revenue FROM [Order Details] GROUP BY ProductID ORDER BY Revenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average order value for each customer."}, {"role": "assistant", "content": "SELECT c.CustomerID, AVG((od.UnitPrice * od.Quantity * (1 - od.Discount)) / COUNT(o.OrderID)) AS AverageOrderValue FROM customers c INNER JOIN orders o ON c.CustomerID = o.CustomerID INNER JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average lead time for orders delivered by each supplier?"}, {"role": "assistant", "content": "SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_lead_time FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.SupplierID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which suppliers provide products that are currently out of stock?"}, {"role": "assistant", "content": "SELECT s.SupplierName FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID WHERE p.UnitsInStock = 0;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many units on order are there for each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, p.UnitsOnOrder FROM products p"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many units of each product are currently in stock?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName, UnitsInStock FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which product has the highest unit price but lowest sales quantity?"}, {"role": "assistant", "content": "SELECT products.ProductID, products.ProductName FROM products WHERE products.UnitPrice = (SELECT MAX(products.UnitPrice) FROM products) AND products.ProductID NOT IN (SELECT [Order Details].ProductID FROM [Order Details] WHERE [Order Details].Quantity > 0)"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which product had the highest sales in terms of quantity in March 2023?"}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].Quantity) AS total_quantity FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-03-01' AND '2023-03-31' GROUP BY products.ProductName ORDER BY total_quantity DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales generated by each employee for the past year?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the average number of days between order placement and order shipping by customer."}, {"role": "assistant", "content": "SELECT CustomerID, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AverageDaysToShip FROM orders GROUP BY CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales revenue generated by each product category in the last year?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(UnitPrice * Quantity * (1 - Discount)) AS TotalSales FROM [Order Details] JOIN orders ON orders.OrderID = [Order Details].OrderID WHERE OrderDate >= CURDATE() - INTERVAL 1 YEAR GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify suppliers that have not supplied any products in the last year."}, {"role": "assistant", "content": "SELECT suppliers.CompanyName FROM suppliers LEFT JOIN (SELECT products.SupplierID, COUNT(*) AS ProductCount FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY products.SupplierID) AS recent_products ON suppliers.SupplierID = recent_products.SupplierID WHERE recent_products.ProductCount IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have stock levels below their reorder level?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many units of each product are currently on order?"}, {"role": "assistant", "content": "SELECT ProductName, UnitsOnOrder FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the monthly sales trend for each product over the last year?"}, {"role": "assistant", "content": "SELECT products.ProductID, FORMAT([Order Details].OrderDate, 'yyyy-MM') AS Month, SUM([Order Details].Quantity) AS MonthlySales FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID WHERE [Order Details].OrderDate >= DATEADD(year, -1, GETDATE()) GROUP BY products.ProductID, FORMAT([Order Details].OrderDate, 'yyyy-MM');"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the average discount provided per order."}, {"role": "assistant", "content": "SELECT AVG([Order Details].Discount) AS AvgDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average quantity per unit for products supplied by each supplier?"}, {"role": "assistant", "content": "SELECT s.SupplierID, s.SupplierName, AVG(CAST(p.QuantityPerUnit AS DECIMAL)) AS AverageQuantityPerUnit FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID GROUP BY s.SupplierID, s.SupplierName;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average shipping cost per order for the current year?"}, {"role": "assistant", "content": "SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders WHERE YEAR(orders.OrderDate) = YEAR(CURDATE())"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the top 3 regions by total sales revenue."}, {"role": "assistant", "content": "SELECT customers.Region, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSalesRevenue FROM customers INNER JOIN orders ON customers.CustomerID = orders.CustomerID INNER JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.Region ORDER BY TotalSalesRevenue DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were placed each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS OrderMonth, COUNT(OrderID) AS TotalOrders FROM orders GROUP BY OrderMonth;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which product has the highest cumulative discount in terms of dollar value?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, SUM(od.Discount * od.UnitPrice * od.Quantity) AS TotalDiscount FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductID, p.ProductName ORDER BY TotalDiscount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many different suppliers are there?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT SupplierID) FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the correlation between freight cost and fulfillment time?"}, {"role": "assistant", "content": "SELECT Freight, DATEDIFF(ShippedDate, OrderDate) AS FulfillmentTime FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee made the highest sales on a specific date?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate = 'YYYY-MM-DD' GROUP BY e.EmployeeID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average unit price of products in each category?"}, {"role": "assistant", "content": "SELECT CategoryID, AVG(UnitPrice) AS AveragePrice FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which product had the highest sales revenue in 2022?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS product_sales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID WHERE orders.OrderDate BETWEEN '2022-01-01' AND '2022-12-31' GROUP BY products.ProductID ORDER BY product_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders have been placed by each customer?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS OrderCount FROM orders GROUP BY CustomerID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which employee generated the most sales in Q4 2023?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID WHERE orders.OrderDate BETWEEN '2023-10-01' AND '2023-12-31' GROUP BY employees.EmployeeID ORDER BY total_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the maximum, minimum, and average salary of the employees?"}, {"role": "assistant", "content": "SELECT MAX(Salary) AS MaxSalary, MIN(Salary) AS MinSalary, AVG(Salary) AS AvgSalary FROM employees;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount given per order in the last week?"}, {"role": "assistant", "content": "SELECT AVG([Order Details].Discount) AS Average_Discount FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE orders.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 WEEK);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average order value for the year 2022?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2022-01-01' AND '2022-12-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were placed by each customer in the last quarter of 2022?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS OrderCount FROM orders WHERE OrderDate BETWEEN '2022-10-01' AND '2022-12-31' GROUP BY CustomerID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total quantity of products ordered in each month of the current year?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, SUM(od.Quantity) AS TotalQuantityOrdered FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID WHERE YEAR(OrderDate) = YEAR(CURDATE()) GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders included products with more than a 10% discount?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT od.OrderID) as NumberOfOrders FROM [Order Details] od WHERE od.Discount > 0.10"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the inventory turnover ratio for the past month?"}, {"role": "assistant", "content": "SELECT SUM(od.Quantity * od.UnitPrice) / AVG(p.UnitsInStock) AS InventoryTurnoverRatio FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID JOIN orders o ON od.OrderID = o.OrderID WHERE EXTRACT(MONTH FROM o.OrderDate) = EXTRACT(MONTH FROM CURRENT_DATE - INTERVAL '1 MONTH');"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the top 3 cities with the most orders placed."}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(*) AS total_orders FROM orders GROUP BY ShipCity ORDER BY total_orders DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average shipping cost per order for orders shipped to 'Canada'?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AverageShippingCost FROM orders WHERE ShipCountry = 'Canada';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the retention rate of customers comparing the first half of 2023 to the previous year?"}, {"role": "assistant", "content": "(SELECT COUNT(DISTINCT o.CustomerID) FROM orders o WHERE o.OrderDate BETWEEN '2023-01-01' AND '2023-06-30') / (SELECT COUNT(DISTINCT o.CustomerID) FROM orders o WHERE o.OrderDate < '2023-01-01') AS customer_retention_rate"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many distinct products have been ordered?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT ProductID) AS DistinctProducts FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were placed each month by each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, DATE_FORMAT(o.OrderDate, '%Y-%m') AS OrderMonth, COUNT(o.OrderID) AS OrderCount FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID GROUP BY c.CustomerID, OrderMonth;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the hire date of the oldest employee?"}, {"role": "assistant", "content": "SELECT e.FirstName, e.LastName, e.HireDate FROM employees e ORDER BY e.HireDate ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many order details entries have a discount greater than 10%?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM [Order Details] WHERE Discount > 0.1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier has the highest average lead time?"}, {"role": "assistant", "content": "SELECT s.CompanyName, AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AverageLeadTime FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY s.CompanyName ORDER BY AverageLeadTime DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify employees whose orders had the highest average discount applied."}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(od.Discount) AS AvgDiscount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID ORDER BY AvgDiscount DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average unit price of products within each category?"}, {"role": "assistant", "content": "SELECT CategoryID, AVG(UnitPrice) AS AverageUnitPrice FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the employees who have never made a sale."}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName FROM employees e LEFT JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.OrderID IS NULL OR o.OrderID IS NULL"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped but not yet delivered?"}, {"role": "assistant", "content": "SELECT OrderID FROM orders WHERE ShippedDate IS NOT NULL AND RequiredDate IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which orders have the highest discounts applied?"}, {"role": "assistant", "content": "SELECT orders.OrderID, MAX([Order Details].Discount) AS MaxDiscount FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY orders.OrderID ORDER BY MaxDiscount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average time taken to ship an order?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, OrderDate)) as AverageShippingTime FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: List the top 5 products by sales for Q2 2023."}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-04-01' AND '2023-06-30' GROUP BY products.ProductID ORDER BY total_sales DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products from each supplier have not been discontinued?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, products.ProductName FROM suppliers INNER JOIN products ON suppliers.SupplierID = products.SupplierID WHERE products.Discontinued = 0;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the total number of orders where the quantity ordered exceeded 50 units in 2023?"}, {"role": "assistant", "content": "SELECT COUNT(orders.OrderID) AS large_orders FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE [Order Details].Quantity > 50 AND orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average quantity of products ordered per order?"}, {"role": "assistant", "content": "SELECT AVG([Order Details].Quantity) AS AverageQuantity FROM [Order Details]"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the performance of each product based on sales quantities in Q1 2023?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-03-31' GROUP BY products.ProductID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the top 5 customers by the number of orders placed."}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS OrderCount FROM orders GROUP BY CustomerID ORDER BY OrderCount DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average shipping time for orders shipped to a specific country in the current month?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgShippingTime FROM orders WHERE DATE_FORMAT(OrderDate, '%Y-%m') = DATE_FORMAT(CURDATE(), '%Y-%m') AND ShipCountry = 'specified_country';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which customers have purchased more than 5 different products?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, customers.CompanyName FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID, customers.CompanyName HAVING COUNT(DISTINCT [Order Details].ProductID) > 5"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which region has the highest on-time delivery rate?"}, {"role": "assistant", "content": "SELECT ShipRegion, (SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) / COUNT(*)) * 100 AS on_time_rate FROM orders GROUP BY ShipRegion ORDER BY on_time_rate DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were placed in the current year?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS TotalOrders FROM orders WHERE YEAR(OrderDate) = YEAR(CURRENT_DATE);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total discount given on all orders in the last month."}, {"role": "assistant", "content": "SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice * [Order Details].Discount) AS TotalDiscount FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE orders.OrderDate >= DATE_ADD(CURDATE(), INTERVAL -1 MONTH);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have a stock level below their reorder level?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which month had the highest number of orders placed?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, COUNT(OrderID) AS NumberOfOrders FROM orders GROUP BY Month ORDER BY NumberOfOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the employee with the largest average order size."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, AVG([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS AvgOrderSize FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID ORDER BY AvgOrderSize DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many distinct customers placed orders each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', o.OrderDate) AS Month, COUNT(DISTINCT o.CustomerID) AS UniqueCustomers FROM orders o GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the average discounts applied per order?"}, {"role": "assistant", "content": "SELECT OrderID, AVG(Discount) AS AverageDiscount FROM [Order Details] GROUP BY OrderID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order fulfillment time for orders made in February 2023?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AvgFulfillmentTime FROM orders o WHERE MONTH(o.OrderDate) = 2 AND YEAR(o.OrderDate) = 2023;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Get a list of employees and the number of orders they have handled."}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName, COUNT(o.OrderID) AS OrderCount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the inventory turnover ratio for the product 'Chai' in May 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE products.ProductName = 'Chai' AND orders.OrderDate BETWEEN '2023-05-01' AND '2023-05-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which shipping method has the shortest average order fulfillment time?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AverageFulfillmentTime FROM orders GROUP BY ShipVia ORDER BY AverageFulfillmentTime ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the number of products sold with discounts?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT ProductID) AS ProductsWithDiscount FROM [Order Details] WHERE Discount > 0;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order fulfillment time per employee?"}, {"role": "assistant", "content": "SELECT EmployeeID, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AverageFulfillmentTime FROM orders GROUP BY EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average number of units ordered per order?"}, {"role": "assistant", "content": "SELECT AVG(Quantity) AS AvgQuantityPerOrder FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the total revenue generated from orders shipped to Germany."}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE orders.ShipCountry = 'Germany';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the freights cost totals for each month in 2023."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, SUM(Freight) AS TotalFreight FROM orders WHERE YEAR(OrderDate) = 2023 GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which categories have an average unit price above $20?"}, {"role": "assistant", "content": "SELECT CategoryName FROM categories c JOIN products p ON c.CategoryID = p.CategoryID GROUP BY c.CategoryName HAVING AVG(p.UnitPrice) > 20;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Who are the suppliers for orders placed in the first quarter of this year?"}, {"role": "assistant", "content": "SELECT DISTINCT s.CompanyName FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID WHERE o.OrderDate BETWEEN '2023-01-01' AND '2023-03-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales quantity for each product?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(Quantity) AS TotalSales FROM [Order Details] GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which city has the highest number of orders?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) as NumberOfOrders FROM orders GROUP BY ShipCity ORDER BY NumberOfOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order fulfillment time for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(DATEDIFF(day, OrderDate, ShippedDate)) AS AverageFulfillmentTime FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customers have placed orders in the last month?"}, {"role": "assistant", "content": "SELECT CustomerID FROM orders WHERE OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List customers who have placed orders within the last 30 days."}, {"role": "assistant", "content": "SELECT * FROM orders WHERE OrderDate >= DATE_SUB(CURRENT_DATE, INTERVAL 30 DAY);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the names and unit prices of all products?"}, {"role": "assistant", "content": "SELECT ProductName, UnitPrice FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the monthly sales performance for each product."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, EXTRACT(MONTH FROM o.OrderDate) AS Month, SUM(od.Quantity) AS MonthlySales FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY p.ProductID, p.ProductName, EXTRACT(MONTH FROM o.OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales revenue generated last month?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS Total_Sales_Revenue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE MONTH(orders.OrderDate) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH) AND YEAR(orders.OrderDate) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employees have handled the most orders?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS OrdersHandled FROM orders GROUP BY EmployeeID ORDER BY OrdersHandled DESC;"}]}
