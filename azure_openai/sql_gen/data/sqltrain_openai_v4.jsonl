{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier has the highest total sales revenue?"}, {"role": "assistant", "content": "SELECT s.SupplierID, s.CompanyName, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.SupplierID, s.CompanyName ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the number of orders shipped by each shipping method monthly?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(ShippedDate, '%Y-%m') AS Month, ShipVia, COUNT(OrderID) AS OrdersCount FROM orders GROUP BY DATE_FORMAT(ShippedDate, '%Y-%m'), ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the region with the highest number of late shipments."}, {"role": "assistant", "content": "SELECT ShipRegion, COUNT(OrderID) AS LateShipments FROM orders WHERE ShippedDate > RequiredDate GROUP BY ShipRegion ORDER BY LateShipments DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the price variance for products sold at different discounts."}, {"role": "assistant", "content": "SELECT od.ProductID, MAX(od.UnitPrice * (1 - od.Discount)) - MIN(od.UnitPrice * (1 - od.Discount)) as PriceVariance FROM [Order Details] od GROUP BY od.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the top 5 suppliers by the number of orders fulfilled."}, {"role": "assistant", "content": "SELECT s.SupplierID, s.CompanyName, COUNT(DISTINCT o.OrderID) AS OrdersFulfilled FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY s.SupplierID, s.CompanyName ORDER BY OrdersFulfilled DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How frequently are products being sold at a discount?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS DiscountedSales FROM [Order Details] WHERE Discount > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How does the average time delay between order and shipment date vary by shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgDelay FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the top-performing employee in terms of sales for each region."}, {"role": "assistant", "content": "SELECT o.ShipRegion, e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.ShipRegion, e.EmployeeID ORDER BY o.ShipRegion, TotalSales DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the customer retention rate from 2022 to 2023?"}, {"role": "assistant", "content": "(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS retention_rate"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products need to be reordered due to low stock levels?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE UnitsInStock <= ReorderLevel AND Discontinued = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify products where sales exceed the reorder level."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName HAVING SUM(od.Quantity) > p.ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average shipping cost per order in 2023?"}, {"role": "assistant", "content": "SELECT AVG(orders.Freight) AS avg_shipping_cost FROM orders WHERE YEAR(orders.OrderDate) = 2023"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify products supplied by a specific supplier."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE SupplierID = ?;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How many returning customers placed orders last month?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT o1.CustomerID) AS returning_customers FROM orders o1 JOIN (SELECT DISTINCT CustomerID FROM orders WHERE OrderDate < DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1' MONTH) AS o2 ON o1.CustomerID = o2.CustomerID WHERE DATE_TRUNC('month', o1.OrderDate) = DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1' MONTH"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify discontinued products with high inventory levels."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE Discontinued = 1 AND UnitsInStock > 100;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find out which employee reports to whom and calculate the total sales for each manager."}, {"role": "assistant", "content": "SELECT m.EmployeeID AS ManagerID, m.FirstName AS ManagerFirstName, m.LastName AS ManagerLastName, e.EmployeeID, e.FirstName, e.LastName, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e LEFT JOIN employees m ON e.ReportsTo = m.EmployeeID LEFT JOIN orders o ON e.EmployeeID = o.EmployeeID LEFT JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY m.EmployeeID, m.FirstName, m.LastName, e.EmployeeID, e.FirstName, e.LastName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated by each customer?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order value for each shipping country?"}, {"role": "assistant", "content": "SELECT o.ShipCountry, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) / COUNT(DISTINCT o.OrderID) AS AvgOrderValue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total inventory value for each product, represented as product price multiplied by units in stock?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName, UnitPrice * UnitsInStock AS InventoryValue FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the percentage of orders that received at least a 10% discount?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT OrderID) * 100.0 / (SELECT COUNT(DISTINCT OrderID) FROM [Order Details]) AS PercentDiscounted FROM [Order Details] WHERE Discount >= 0.10;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the distribution of employee titles across regions?"}, {"role": "assistant", "content": "SELECT e.Title, e.Region, COUNT(*) AS Number FROM employees e GROUP BY e.Title, e.Region;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average unit price of products per supplier?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, AVG(products.UnitPrice) AS AverageUnitPrice FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID GROUP BY suppliers.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the products nearing their reorder level."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock <= ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which city has received the most shipments?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS TotalShipments FROM orders GROUP BY ShipCity ORDER BY TotalShipments DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify employees whose sales have increased by more than 20% compared to the previous year."}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE YEAR(o.OrderDate) = YEAR(CURDATE()) GROUP BY e.EmployeeID HAVING SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) > 1.2 * (SELECT SUM(od2.UnitPrice * od2.Quantity * (1 - od2.Discount)) FROM orders o2 JOIN [Order Details] od2 ON o2.OrderID = od2.OrderID WHERE o2.EmployeeID = e.EmployeeID AND YEAR(o2.OrderDate) = YEAR(CURDATE()) - 1);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the breakdown of discontinued products by category?"}, {"role": "assistant", "content": "SELECT c.CategoryID, COUNT(*) AS DiscontinuedCount FROM products p JOIN categories c ON p.CategoryID = c.CategoryID WHERE p.Discontinued = 1 GROUP BY c.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders have a shipping time greater than 7 days?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS OrdersOver7Days FROM orders WHERE DATEDIFF(ShippedDate, OrderDate) > 7;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top 5 selling products based on order quantities?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS TotalQuantity FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductName ORDER BY TotalQuantity DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier's products have the highest average discount applied?"}, {"role": "assistant", "content": "SELECT s.SupplierID, s.CompanyName, AVG(od.Discount) AS AvgDiscount FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.SupplierID, s.CompanyName ORDER BY AvgDiscount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What percentage of orders were delivered on time each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', orders.OrderDate) AS Month, 100.0 * COUNT(CASE WHEN orders.ShippedDate <= orders.RequiredDate THEN 1 END) / COUNT(orders.OrderID) AS OnTimeDeliveryRate FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated for each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.UnitPrice * (od.Quantity - (od.Quantity * od.Discount))) AS TotalRevenue FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductID ORDER BY TotalRevenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the total sales revenue for each month in 2023?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(orders.OrderDate, '%Y-%m') AS month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY DATE_FORMAT(orders.OrderDate, '%Y-%m')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many days on average does it take for each employee to fulfill an order?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AverageDaysToFulfill FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.ShippedDate IS NOT NULL GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employees have not processed any orders in the last month?"}, {"role": "assistant", "content": "SELECT e.EmployeeID FROM employees e LEFT JOIN orders o ON e.EmployeeID = o.EmployeeID AND o.OrderDate >= DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 month' WHERE o.OrderID IS NULL GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average order fulfillment time across different regions?"}, {"role": "assistant", "content": "SELECT region.RegionDescription, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_fulfillment_time FROM orders JOIN employees ON orders.EmployeeID = employees.EmployeeID JOIN employeeTerritories ON employees.EmployeeID = employeeTerritories.EmployeeID JOIN territories ON employeeTerritories.TerritoryID = territories.TerritoryID JOIN region ON territories.RegionID = region.RegionID GROUP BY region.RegionDescription"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employees have their birthdays this month?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.FirstName, e.LastName FROM employees e WHERE MONTH(e.BirthDate) = MONTH(CURDATE());"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which orders were delivered on time in March 2023?"}, {"role": "assistant", "content": "SELECT orders.OrderID FROM orders WHERE orders.ShippedDate <= orders.RequiredDate AND MONTH(orders.ShippedDate) = 3 AND YEAR(orders.ShippedDate) = 2023"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which month had the highest overall sales?"}, {"role": "assistant", "content": "SELECT EXTRACT(MONTH FROM o.OrderDate) AS OrderMonth, SUM(od.Quantity * od.UnitPrice) AS TotalSales FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID GROUP BY EXTRACT(MONTH FROM o.OrderDate) ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Compare the product performance for the first quarter of 2023 with the last quarter of 2022."}, {"role": "assistant", "content": "SELECT products.ProductID, SUM(CASE WHEN orders.OrderDate BETWEEN '2023-01-01' AND '2023-03-31' THEN [Order Details].Quantity ELSE 0 END) AS first_quarter_sales, SUM(CASE WHEN orders.OrderDate BETWEEN '2022-10-01' AND '2022-12-31' THEN [Order Details].Quantity ELSE 0 END) AS last_quarter_2022_sales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY products.ProductID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee has processed the most orders?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS OrdersProcessed FROM orders GROUP BY EmployeeID ORDER BY OrdersProcessed DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Identify the top 10 cities by total sales in 2023."}, {"role": "assistant", "content": "SELECT customers.City, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY customers.City ORDER BY total_sales DESC LIMIT 10"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which city has the highest number of orders?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipCity ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which shipping method is most frequently used?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(*) AS Frequency FROM orders GROUP BY ShipVia ORDER BY Frequency DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the longest time taken to fulfill an order?"}, {"role": "assistant", "content": "SELECT MAX(DATEDIFF(ShippedDate, OrderDate)) AS LongestFulfillmentTime FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average sales per employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS AverageSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped by each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS TotalOrders FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Are there any products that have not been ordered in 2023?"}, {"role": "assistant", "content": "SELECT products.ProductID FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = 2023);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the effect of employee sales territory on overall sales performance?"}, {"role": "assistant", "content": "SELECT territories.TerritoryDescription, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID JOIN employeeTerritories ON employees.EmployeeID = employeeTerritories.EmployeeID JOIN territories ON employeeTerritories.TerritoryID = territories.TerritoryID GROUP BY territories.TerritoryDescription ORDER BY total_sales DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customer has received the most discounts on their orders?"}, {"role": "assistant", "content": "SELECT orders.CustomerID, SUM([Order Details].Discount) AS TotalDiscount FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY orders.CustomerID ORDER BY TotalDiscount DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customers have the highest total freight costs?"}, {"role": "assistant", "content": "SELECT CustomerID, SUM(Freight) AS TotalFreightCost FROM orders GROUP BY CustomerID ORDER BY TotalFreightCost DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the monthly inventory turnover ratio?"}, {"role": "assistant", "content": "SELECT EXTRACT(YEAR FROM o.OrderDate) AS Year, EXTRACT(MONTH FROM o.OrderDate) AS Month, SUM(od.Quantity * od.UnitPrice) / AVG(p.UnitsInStock) AS InventoryTurnoverRatio FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY Year, Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee has the most overdue orders?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) AS OverdueCount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.RequiredDate < CURDATE() AND o.ShippedDate IS NULL GROUP BY e.EmployeeID ORDER BY OverdueCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders did each employee fulfill in the last year?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) AS OrderCount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.OrderDate >= DATEADD(YEAR, -1, CURRENT_DATE) GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the top 3 cities with the highest sales revenue."}, {"role": "assistant", "content": "SELECT ShipCity, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY ShipCity ORDER BY TotalSales DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average shipping cost per order each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(Freight) AS AvgShippingCost FROM orders GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier has the most products on order?"}, {"role": "assistant", "content": "SELECT SupplierID, SUM(UnitsOnOrder) AS TotalUnitsOnOrder FROM products GROUP BY SupplierID ORDER BY TotalUnitsOnOrder DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the monthly trend in the number of orders placed over the past year?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, COUNT(OrderID) AS TotalOrders FROM orders WHERE OrderDate >= DATEADD(YEAR, -1, CURRENT_DATE) GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average number of days between order and required date by supplier?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, AVG(DATEDIFF(orders.RequiredDate, orders.OrderDate)) AS AverageDays FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON orders.OrderID = [Order Details].OrderID GROUP BY suppliers.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped on time?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) FROM orders WHERE ShippedDate <= RequiredDate"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Find out the top 5 most profitable products in 2023."}, {"role": "assistant", "content": "SELECT products.ProductID, SUM(([Order Details].UnitPrice * (1 - [Order Details].Discount) - products.UnitPrice) * [Order Details].Quantity) AS profit FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY products.ProductID ORDER BY profit DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List employees who have not made any sales in the last three months."}, {"role": "assistant", "content": "SELECT e.EmployeeID, CONCAT(e.FirstName, ' ', e.LastName) AS EmployeeName FROM employees e WHERE NOT EXISTS (SELECT 1 FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.EmployeeID = e.EmployeeID AND o.OrderDate >= DATEADD(MONTH, -3, CURRENT_DATE));"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders include products with a discount greater than 20%?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT od.OrderID) FROM [Order Details] od WHERE od.Discount > 0.20;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which countries have the most diverse customer base?"}, {"role": "assistant", "content": "SELECT Country, COUNT(DISTINCT CustomerID) AS UniqueCustomers FROM customers GROUP BY Country ORDER BY UniqueCustomers DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many employees report to each manager?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(e2.EmployeeID) AS Reports FROM employees e LEFT JOIN employees e2 ON e.EmployeeID = e2.ReportsTo GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders did each employee process in the last year?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) AS TotalOrders FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.OrderDate > CURRENT_DATE - INTERVAL '1' YEAR GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What percentage of orders are shipped to Europe?"}, {"role": "assistant", "content": "SELECT (SUM(CASE WHEN ShipCountry IN ('Austria', 'Belgium', 'Bulgaria', 'Croatia', 'Cyprus', 'Czech Republic', 'Denmark', 'Estonia', 'Finland', 'France', 'Germany', 'Greece', 'Hungary', 'Iceland', 'Ireland', 'Italy', 'Latvia', 'Lithuania', 'Luxembourg', 'Malta', 'Netherlands', 'Poland', 'Portugal', 'Romania', 'Slovakia', 'Slovenia', 'Spain', 'Sweden', 'United Kingdom') THEN 1 ELSE 0 END) * 100.0) / COUNT(OrderID) AS EuropeanOrdersPercentage FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order fulfillment time each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order value for each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', orders.OrderDate) AS Month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS AvgOrderValue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customer placed the largest total value of orders?"}, {"role": "assistant", "content": "SELECT CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalValue FROM [Order Details] JOIN orders ON orders.OrderID = [Order Details].OrderID GROUP BY CustomerID ORDER BY TotalValue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify products with the highest reorder level."}, {"role": "assistant", "content": "SELECT ProductName FROM products ORDER BY ReorderLevel DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated by each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity * od.UnitPrice) AS TotalRevenue FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total value of products in stock for each supplier?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, SUM(products.UnitPrice * products.UnitsInStock) AS TotalValueInStock FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID GROUP BY suppliers.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total freight cost incurred per month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS OrderMonth, SUM(Freight) AS TotalFreight FROM orders GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total number of units sold per category."}, {"role": "assistant", "content": "SELECT c.CategoryID, SUM(od.Quantity) AS TotalUnitsSold FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID JOIN categories c ON p.CategoryID = c.CategoryID GROUP BY c.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the products with the highest discount applied in orders."}, {"role": "assistant", "content": "SELECT p.ProductName, MAX(od.Discount) AS MaxDiscount FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductName ORDER BY MaxDiscount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the monthly inventory turnover ratio for the top-selling product."}, {"role": "assistant", "content": "SELECT ProductName, SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS InventoryTurnover FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY ProductName ORDER BY SUM([Order Details].Quantity) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How many orders were fulfilled on time in the last quarter?"}, {"role": "assistant", "content": "SELECT COUNT(orders.OrderID) AS on_time_orders FROM orders WHERE orders.ShippedDate <= orders.RequiredDate AND QUARTER(orders.OrderDate) = QUARTER(CURDATE())"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders do each customer place on average?"}, {"role": "assistant", "content": "SELECT AVG(OrderCount) AS AverageOrders FROM (SELECT CustomerID, COUNT(OrderID) AS OrderCount FROM orders GROUP BY CustomerID) AS CustomerOrders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average fulfillment time for orders?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS AvgFulfillmentTime FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the products with zero units on order."}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE UnitsOnOrder = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customer placed the highest value order?"}, {"role": "assistant", "content": "SELECT c.CustomerID, (od.UnitPrice * od.Quantity * (1 - od.Discount)) AS OrderValue FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID ORDER BY OrderValue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total value of products currently on order?"}, {"role": "assistant", "content": "SELECT SUM(UnitsOnOrder * UnitPrice) AS TotalValueOnOrder FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order size (in terms of quantity) managed by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(od.Quantity) AS AvgOrderSize FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order fulfillment time for orders shipped to the USA?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, OrderDate)) AS AverageFulfillmentTime FROM orders WHERE ShipCountry = 'USA';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the supplier with the longest average delivery time."}, {"role": "assistant", "content": "SELECT p.SupplierID, AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AvgLeadTime FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID JOIN products p ON od.ProductID = p.ProductID GROUP BY p.SupplierID ORDER BY AvgLeadTime DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which regions have the highest order fulfillment delays?"}, {"role": "assistant", "content": "SELECT region.RegionDescription, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate) - DATEDIFF(orders.RequiredDate, orders.OrderDate)) AS avg_delay FROM orders JOIN employees ON orders.EmployeeID = employees.EmployeeID JOIN employeeTerritories ON employees.EmployeeID = employeeTerritories.EmployeeID JOIN territories ON employeeTerritories.TerritoryID = territories.TerritoryID JOIN region ON territories.RegionID = region.RegionID GROUP BY region.RegionDescription HAVING avg_delay > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Who is the longest-serving employee based on the hire date?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.HireDate FROM employees e ORDER BY e.HireDate ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customers are from 'USA' and have more than 5 orders?"}, {"role": "assistant", "content": "SELECT c.CustomerID FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID WHERE c.Country = 'USA' GROUP BY c.CustomerID HAVING COUNT(o.OrderID) > 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have been discontinued?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customer generated the highest revenue in the last quarter?"}, {"role": "assistant", "content": "SELECT o.CustomerID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE QUARTER(o.OrderDate) = 4 AND YEAR(o.OrderDate) = YEAR(CURRENT_DATE) GROUP BY o.CustomerID ORDER BY TotalRevenue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the proportion of total sales contributed by discounted orders?"}, {"role": "assistant", "content": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) / (SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID) * 100 AS DiscountedSalesProportion FROM [Order Details] od WHERE od.Discount > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total discounts given by each employee."}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * od.Discount) AS TotalDiscount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which city has the highest number of customers?"}, {"role": "assistant", "content": "SELECT City, COUNT(*) AS num_customers FROM customers GROUP BY City ORDER BY num_customers DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales revenue for each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(o.OrderDate, '%Y-%m') AS Month, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average freight cost per order?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AvgFreightCost FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How does the average freight cost vary by shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(Freight) AS AvgFreight FROM orders GROUP BY ShipVia"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount applied across all orders?"}, {"role": "assistant", "content": "SELECT AVG(Discount) AS AverageDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average freight cost per shipping country?"}, {"role": "assistant", "content": "SELECT ShipCountry, AVG(Freight) AS AvgFreightCost FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many unique products have been ordered?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT ProductID) AS UniqueProductsOrdered FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders have been shipped more than a week after the order date?"}, {"role": "assistant", "content": "SELECT COUNT(o.OrderID) FROM orders o WHERE DATEDIFF(o.ShippedDate, o.OrderDate) > 7;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee fulfilled the most orders last month?"}, {"role": "assistant", "content": "SELECT o.EmployeeID, COUNT(*) AS TotalOrders FROM orders o WHERE MONTH(o.ShippedDate) = MONTH(CURDATE() - INTERVAL 1 MONTH) AND YEAR(o.ShippedDate) = YEAR(CURDATE() - INTERVAL 1 MONTH) GROUP BY o.EmployeeID ORDER BY TotalOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Find the average order value for each month in 2023."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(OrderDate) = 2023 GROUP BY DATE_FORMAT(OrderDate, '%Y-%m')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How many orders have been placed by each customer?"}, {"role": "assistant", "content": "SELECT orders.CustomerID, COUNT(orders.OrderID) AS order_count FROM orders GROUP BY orders.CustomerID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped on time last month?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS OnTimeOrders FROM orders WHERE ShippedDate <= RequiredDate AND MONTH(OrderDate) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH) AND YEAR(OrderDate) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which categories have the highest number of products with no units in stock?"}, {"role": "assistant", "content": "SELECT CategoryID, COUNT(*) AS NoStockProducts FROM products WHERE UnitsInStock = 0 GROUP BY CategoryID ORDER BY NoStockProducts DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What percentage of orders had a discount applied?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT [Order Details].OrderID) * 100.0 / COUNT(DISTINCT orders.OrderID) AS percentage_with_discount FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE [Order Details].Discount > 0"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top 5 products sold by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, od.ProductID, SUM(od.Quantity) AS TotalQuantity FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, od.ProductID ORDER BY TotalQuantity DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many distinct cities have customers placed an order from?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT c.City) FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How has the customer retention rate changed over the past year?"}, {"role": "assistant", "content": "SELECT (COUNT(DISTINCT CASE WHEN YEAR(orders.OrderDate) = YEAR(CURDATE()) THEN orders.CustomerID END) / COUNT(DISTINCT CASE WHEN YEAR(orders.OrderDate) = YEAR(CURDATE())-1 THEN orders.CustomerID END)) * 100 AS retention_rate FROM orders"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the total number of orders shipped beyond the required date for each region."}, {"role": "assistant", "content": "SELECT ShipRegion, COUNT(OrderID) AS LateOrders FROM orders WHERE ShippedDate > RequiredDate GROUP BY ShipRegion"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find products with the smallest difference between units in stock and reorder level."}, {"role": "assistant", "content": "SELECT ProductID, ABS(UnitsInStock - ReorderLevel) AS StockDifference FROM products ORDER BY StockDifference ASC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the monthly Customer Retention Rate for the last year."}, {"role": "assistant", "content": "SELECT EXTRACT(YEAR FROM OrderDate) AS Year, EXTRACT(MONTH FROM OrderDate) AS Month, (COUNT(DISTINCT CustomerID) FILTER (WHERE OrderDate BETWEEN DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 year' AND DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 month')) / NULLIF(COUNT(DISTINCT CustomerID) FILTER (WHERE OrderDate < DATE_TRUNC('month', CURRENT_DATE) - INTERVAL '1 year'), 0) AS RetentionRate FROM orders GROUP BY Year, Month ORDER BY Year, Month"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the on-time delivery rate for each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) * 100.0 / COUNT(OrderID) AS OnTimeDeliveryRate FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the difference between reorder level and current stock for all products."}, {"role": "assistant", "content": "SELECT ProductID, (ReorderLevel - UnitsInStock) as StockGap FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the difference between the earliest and latest shipped order dates each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(ShippedDate, '%Y-%m') AS Month, DATEDIFF(MAX(ShippedDate), MIN(ShippedDate)) AS DateDifference FROM orders WHERE ShippedDate IS NOT NULL GROUP BY DATE_FORMAT(ShippedDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which city has the highest number of orders handled by employees?"}, {"role": "assistant", "content": "SELECT o.ShipCity, COUNT(o.OrderID) AS OrderCount FROM orders o GROUP BY o.ShipCity ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average freight cost for each employee responsible for the orders?"}, {"role": "assistant", "content": "SELECT EmployeeID, AVG(Freight) AS AverageFreight FROM orders GROUP BY EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which shipping company had the highest on-time delivery rate in 2023?"}, {"role": "assistant", "content": "SELECT shippers.CompanyName, COUNT(CASE WHEN orders.ShippedDate <= orders.RequiredDate THEN 1 END) / CAST(COUNT(orders.OrderID) AS DECIMAL) AS on_time_rate FROM orders JOIN shippers ON orders.ShipVia = shippers.ShipperID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY shippers.CompanyName ORDER BY on_time_rate DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order size per product?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, AVG(od.Quantity) AS AvgOrderSize FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average sale value per order for each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS AvgSaleValue FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total quantity sold for each product?"}, {"role": "assistant", "content": "SELECT p.ProductID, SUM(od.Quantity) as TotalQuantitySold FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier provides the most number of products?"}, {"role": "assistant", "content": "SELECT p.SupplierID, COUNT(DISTINCT p.ProductID) AS NumberOfProducts FROM products p GROUP BY p.SupplierID ORDER BY NumberOfProducts DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List all products with units on order and their respective suppliers."}, {"role": "assistant", "content": "SELECT p.ProductName, s.SupplierName, p.UnitsOnOrder FROM products p JOIN suppliers s ON p.SupplierID = s.SupplierID WHERE p.UnitsOnOrder > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order value per month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) / COUNT(DISTINCT o.OrderID) AS AvgOrderValue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the product names and their current stock levels?"}, {"role": "assistant", "content": "SELECT ProductName, UnitsInStock FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total freight cost by shipping country?"}, {"role": "assistant", "content": "SELECT ShipCountry, SUM(Freight) AS TotalFreightCost FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders have been shipped and not shipped yet?"}, {"role": "assistant", "content": "SELECT SUM(CASE WHEN ShippedDate IS NOT NULL THEN 1 ELSE 0 END) AS ShippedCount, SUM(CASE WHEN ShippedDate IS NULL THEN 1 ELSE 0 END) AS NotShippedCount FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total number of orders each employee has pending shipment?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) AS PendingOrders FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.ShippedDate IS NULL GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the total revenue generated for each product."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, SUM(od.Quantity * od.UnitPrice) AS TotalRevenue FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the total sales by country?"}, {"role": "assistant", "content": "SELECT ShipCountry, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee has the most orders delayed past the required date?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(*) AS DelayedOrders FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.ShippedDate > o.RequiredDate GROUP BY e.EmployeeID ORDER BY DelayedOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify which suppliers provide discontinued products."}, {"role": "assistant", "content": "SELECT DISTINCT SupplierID FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order fulfillment time for each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AverageFulfillmentTime FROM orders GROUP BY DATE_TRUNC('month', OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier has the highest lead time variance?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, VARIANCE(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS LeadTimeVariance FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY suppliers.SupplierID ORDER BY LeadTimeVariance DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total and average order fulfillment time per month."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime, SUM(DATEDIFF(ShippedDate, OrderDate)) AS TotalFulfillmentTime FROM orders GROUP BY DATE_FORMAT(OrderDate, '%Y-%m');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customers have the highest lifetime value?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS LifetimeValue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID ORDER BY LifetimeValue DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which months had a higher number of late shipments than on-time deliveries?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month FROM orders GROUP BY Month HAVING COUNT(CASE WHEN ShippedDate > RequiredDate THEN 1 END) > COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total number of products ordered in 2022?"}, {"role": "assistant", "content": "SELECT SUM(Quantity) AS TotalQuantity FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE EXTRACT(YEAR FROM orders.OrderDate) = 2022"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders have been shipped to each region?"}, {"role": "assistant", "content": "SELECT ShipRegion, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee handled the highest number of orders this year?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS OrderCount FROM orders WHERE YEAR(OrderDate) = YEAR(CURRENT_DATE) GROUP BY EmployeeID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the month with the highest inventory turnover ratio."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS OrderMonth, SUM(od.Quantity * od.UnitPrice) / AVG(p.UnitsInStock) AS InventoryTurnover FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY OrderMonth ORDER BY InventoryTurnover DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many unique customers placed orders each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, COUNT(DISTINCT CustomerID) AS UniqueCustomers FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average order fulfillment time for each month in 2023?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS month, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders WHERE YEAR(OrderDate) = 2023 GROUP BY DATE_FORMAT(OrderDate, '%Y-%m')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped within the same city as the supplier?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM orders JOIN suppliers ON orders.ShipCountry = suppliers.Country AND orders.ShipCity = suppliers.City JOIN products ON orders.OrderID IN (SELECT OrderID FROM [Order Details] WHERE [Order Details].ProductID = products.ProductID) WHERE products.SupplierID = suppliers.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average discount applied by each employee."}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(od.Discount) AS AvgDiscount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How does the average freight cost vary by country?"}, {"role": "assistant", "content": "SELECT ShipCountry, AVG(Freight) AS AvgFreightCost FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products need to be reordered, based on their current stock levels?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock <= ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which regions experience the longest average shipping times?"}, {"role": "assistant", "content": "SELECT ShipRegion, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AverageShippingTime FROM orders GROUP BY ShipRegion ORDER BY AverageShippingTime DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the total sales per product?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, SUM(od.Quantity * od.UnitPrice) AS TotalSales FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee has generated the highest total sales?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the number of customers per region."}, {"role": "assistant", "content": "SELECT Region, COUNT(DISTINCT CustomerID) AS NumberOfCustomers FROM customers GROUP BY Region;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the top shipping method based on frequency?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS Count FROM orders GROUP BY ShipVia ORDER BY Count DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the regions that supply the most products."}, {"role": "assistant", "content": "SELECT Region, COUNT(p.ProductID) AS ProductCount FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID GROUP BY Region ORDER BY ProductCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount applied on orders per month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(Discount) AS AvgDiscount FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many distinct products were sold by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(DISTINCT od.ProductID) AS DistinctProducts FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List products that need reordering (Units in Stock less than Reorder Level)."}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average freight cost per order?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AverageFreightCost FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which cities have the highest number of customers?"}, {"role": "assistant", "content": "SELECT City, COUNT(CustomerID) AS NumberOfCustomers FROM customers GROUP BY City ORDER BY NumberOfCustomers DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List suppliers and the total number of products they provide."}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, COUNT(products.ProductID) AS ProductCount FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID GROUP BY suppliers.CompanyName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which city has the highest on-time delivery rate?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) FILTER(WHERE ShippedDate <= RequiredDate) * 100.0 / COUNT(OrderID) AS OnTimeRate FROM orders GROUP BY ShipCity ORDER BY OnTimeRate DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total discount given on orders each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', orders.OrderDate) AS Month, SUM([Order Details].UnitPrice * [Order Details].Quantity * [Order Details].Discount) AS TotalDiscount FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the overall customer satisfaction based on order return frequency?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS ReturnFrequency FROM orders GROUP BY CustomerID HAVING COUNT(OrderID) > 1 ORDER BY ReturnFrequency DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the ten orders with the highest shipping costs?"}, {"role": "assistant", "content": "SELECT OrderID, Freight FROM orders ORDER BY Freight DESC LIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the average shipping cost for orders shipped via a specific shipping method."}, {"role": "assistant", "content": "SELECT ShipVia, AVG(Freight) AS AvgFreight FROM orders WHERE ShipVia = [specific_shipping_method] GROUP BY ShipVia"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the percentage of orders with a discount above 10% this year?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT od.OrderID) * 1.0 / (SELECT COUNT(OrderID) FROM orders WHERE YEAR(OrderDate) = YEAR(CURRENT_DATE)) * 100 AS DiscountedOrderPercentage FROM [Order Details] od INNER JOIN orders o ON od.OrderID = o.OrderID WHERE od.Discount > 0.1 AND YEAR(o.OrderDate) = YEAR(CURRENT_DATE);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average lead time for each supplier?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS AverageLeadTime FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON orders.OrderID = [Order Details].OrderID GROUP BY suppliers.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the total value of products in stock for each supplier."}, {"role": "assistant", "content": "SELECT SupplierID, SUM(UnitPrice * UnitsInStock) AS TotalStockValue FROM products GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total number of discontinued products still in stock?"}, {"role": "assistant", "content": "SELECT COUNT(ProductID) FROM products WHERE Discontinued = 1 AND UnitsInStock > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What percentage of total sales does each employee contribute?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) / (SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID) * 100 AS SalesPercentage FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which country incurs the highest average freight cost per order?"}, {"role": "assistant", "content": "SELECT ShipCountry, AVG(Freight) AS AvgFreight FROM orders GROUP BY ShipCountry ORDER BY AvgFreight DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify products with low sales performance but high stock levels."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock > 100 AND ProductID NOT IN (SELECT ProductID FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find orders that were shipped late."}, {"role": "assistant", "content": "SELECT o.OrderID FROM orders o WHERE o.ShippedDate > o.RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which country has the most suppliers?"}, {"role": "assistant", "content": "SELECT Country, COUNT(SupplierID) AS SupplierCount FROM suppliers GROUP BY Country ORDER BY SupplierCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which employee generated the most sales revenue last month?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS sales_revenue FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID WHERE MONTH(orders.OrderDate) = MONTH(CURDATE())-1 AND YEAR(orders.OrderDate) = YEAR(CURDATE()) GROUP BY employees.EmployeeID ORDER BY sales_revenue DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which suppliers have the shortest lead time for product delivery?"}, {"role": "assistant", "content": "SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS lead_time FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.SupplierID ORDER BY lead_time ASC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the correlation between order size and freight cost?"}, {"role": "assistant", "content": "SELECT CORR(order_size, Freight) AS Correlation FROM (SELECT o.OrderID, SUM(od.Quantity) AS order_size, o.Freight FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.OrderID) subquery;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What are the monthly sales trends for the top 5 products?"}, {"role": "assistant", "content": "SELECT products.ProductName, DATE_FORMAT(orders.OrderDate, '%Y-%m') AS month, SUM([Order Details].Quantity) AS monthly_sales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY products.ProductName, DATE_FORMAT(orders.OrderDate, '%Y-%m') ORDER BY monthly_sales DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the percentage of on-time deliveries for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) * 100.0 / COUNT(OrderID) AS OnTimeDeliveryRate FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the products with zero inventory turnover last month."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName FROM products p LEFT JOIN [Order Details] od ON p.ProductID = od.ProductID AND EXTRACT(MONTH FROM od.OrderDate) = EXTRACT(MONTH FROM CURRENT_DATE) - 1 AND EXTRACT(YEAR FROM od.OrderDate) = EXTRACT(YEAR FROM CURRENT_DATE) HAVING SUM(od.Quantity * od.UnitPrice) IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which product has the highest number of units on order?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsOnOrder = (SELECT MAX(UnitsOnOrder) FROM products);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have never been ordered?"}, {"role": "assistant", "content": "SELECT products.ProductName FROM products LEFT JOIN [Order Details] ON products.ProductID = [Order Details].ProductID WHERE [Order Details].OrderID IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: List products with the highest sales volume in 2023."}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].Quantity) AS sales_volume FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE EXTRACT(YEAR FROM orders.OrderDate) = 2023 GROUP BY products.ProductID ORDER BY sales_volume DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total freight cost incurred for each shipping country."}, {"role": "assistant", "content": "SELECT ShipCountry, SUM(Freight) AS TotalFreight FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the number of orders shipped within each region."}, {"role": "assistant", "content": "SELECT ShipRegion, COUNT(OrderID) AS NumOrders FROM orders GROUP BY ShipRegion"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which month had the highest total sales revenue?"}, {"role": "assistant", "content": "SELECT EXTRACT(YEAR FROM OrderDate) AS Year, EXTRACT(MONTH FROM OrderDate) AS Month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS MonthlyRevenue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY Year, Month ORDER BY MonthlyRevenue DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total freight cost for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, SUM(Freight) AS TotalFreight FROM orders GROUP BY ShipVia ORDER BY TotalFreight DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the average order value (AOV) across all customers."}, {"role": "assistant", "content": "SELECT AVG([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS AverageOrderValue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total freight cost for each employee's orders in the last six months?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(o.Freight) AS TotalFreight FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.OrderDate >= DATE_SUB(CURRENT_DATE, INTERVAL 6 MONTH) GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average discount applied per order."}, {"role": "assistant", "content": "SELECT AVG(Discount) AS AverageDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were made by each employee in the current month?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) AS NumberOfOrders FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE EXTRACT(YEAR FROM o.OrderDate) = EXTRACT(YEAR FROM CURDATE()) AND EXTRACT(MONTH FROM o.OrderDate) = EXTRACT(MONTH FROM CURDATE()) GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have a unit price greater than $50?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitPrice > 50;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average time to fulfill an order by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AvgFulfillmentTime FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.ShippedDate IS NOT NULL GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How many orders were placed by new customers in 2023?"}, {"role": "assistant", "content": "SELECT COUNT(orders.OrderID) FROM orders JOIN customers ON orders.CustomerID = customers.CustomerID WHERE NOT EXISTS (SELECT 1 FROM orders o WHERE o.OrderDate < '2023-01-01' AND o.CustomerID = customers.CustomerID) AND orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which city has the highest number of orders processed?"}, {"role": "assistant", "content": "SELECT o.ShipCity, COUNT(o.OrderID) AS OrderCount FROM orders o GROUP BY o.ShipCity ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the supplier with the lowest average product price."}, {"role": "assistant", "content": "SELECT SupplierID, AVG(UnitPrice) AS AvgPrice FROM products GROUP BY SupplierID ORDER BY AvgPrice ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which customer's lifetime value is the highest?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID ORDER BY lifetime_value DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which months had the highest inventory turnover ratios?"}, {"role": "assistant", "content": "SELECT Month, SUM(od.Quantity * od.UnitPrice) / AVG(p.UnitsInStock) AS InventoryTurnoverRatio FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY Month ORDER BY InventoryTurnoverRatio DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top five cities by total sales revenue?"}, {"role": "assistant", "content": "SELECT ShipCity, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY ShipCity ORDER BY TotalSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which country generates the highest total sales revenue?"}, {"role": "assistant", "content": "SELECT orders.ShipCountry, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY orders.ShipCountry ORDER BY total_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the top 5 customers by lifetime value."}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS LifetimeValue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID ORDER BY LifetimeValue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average unit price of all products?"}, {"role": "assistant", "content": "SELECT AVG(UnitPrice) AS AvgUnitPrice FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many products have reached or exceeded their reorder level?"}, {"role": "assistant", "content": "SELECT COUNT(ProductID) FROM products WHERE UnitsInStock <= ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which product generated the highest revenue last month?"}, {"role": "assistant", "content": "SELECT TOP 1 od.ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID WHERE YEAR(o.OrderDate) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH) AND MONTH(o.OrderDate) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH) GROUP BY od.ProductID ORDER BY TotalRevenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the monthly trend in the number of orders placed?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, COUNT(OrderID) AS OrderCount FROM orders GROUP BY Month ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average discount per order."}, {"role": "assistant", "content": "SELECT OrderID, AVG(Discount) AS AverageDiscount FROM [Order Details] GROUP BY OrderID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have stock levels below their reorder level?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier provides the most products?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, COUNT(products.ProductID) AS ProductCount FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID GROUP BY suppliers.SupplierID ORDER BY ProductCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average fulfillment time for orders in the last six months?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AvgFulfillmentTime FROM orders o WHERE o.OrderDate >= DATEADD(MONTH, -6, CURRENT_DATE);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the correlation between freight cost and total sales value for orders in 2023?"}, {"role": "assistant", "content": "SELECT CORR(corr_sales.freight, corr_sales.total_sales_value) AS correlation FROM (SELECT orders.OrderID, orders.Freight, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY orders.OrderID) AS corr_sales"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee managed the most orders?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS OrderCount FROM orders GROUP BY EmployeeID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total freight cost for each city by month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, ShipCity, SUM(Freight) AS TotalFreight FROM orders GROUP BY DATE_FORMAT(OrderDate, '%Y-%m'), ShipCity"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which regions have the fewest orders?"}, {"role": "assistant", "content": "SELECT Region, COUNT(o.OrderID) AS NumberOfOrders FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID GROUP BY Region ORDER BY NumberOfOrders ASC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee handled the highest number of different products?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(DISTINCT od.ProductID) AS UniqueProducts FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID ORDER BY UniqueProducts DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which categories have the highest inventory turnover ratio?"}, {"role": "assistant", "content": "SELECT categories.CategoryName, SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN categories ON products.CategoryID = categories.CategoryID GROUP BY categories.CategoryID ORDER BY turnover_ratio DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the total number of units in stock for discontinued products?"}, {"role": "assistant", "content": "SELECT SUM(products.UnitsInStock) AS discontinued_stock FROM products WHERE products.Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many products were ordered by each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, SUM(od.Quantity) AS TotalProductsOrdered FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the correlation between discount applied and units sold."}, {"role": "assistant", "content": "SELECT Discount, SUM(Quantity) AS TotalUnitsSold FROM [Order Details] GROUP BY Discount ORDER BY Discount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were overdue for shipping in the past month?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS OverdueOrders FROM orders WHERE ShippedDate > RequiredDate AND YEAR(OrderDate) = YEAR(CURRENT_DATE - INTERVAL '1 month') AND MONTH(OrderDate) = MONTH(CURRENT_DATE - INTERVAL '1 month');"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total freight cost handled by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(o.Freight) AS TotalFreight FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the employee responsible for the highest single order value."}, {"role": "assistant", "content": "SELECT o.EmployeeID, od.OrderID, MAX(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS MaxOrderValue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.EmployeeID, od.OrderID ORDER BY MaxOrderValue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the average discount percentage for each supplier."}, {"role": "assistant", "content": "SELECT s.SupplierID, AVG(od.Discount) * 100 AS AvgDiscountPercentage FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which countries have the highest number of orders?"}, {"role": "assistant", "content": "SELECT ShipCountry, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipCountry ORDER BY OrderCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the total monthly sales revenue for the year 2023?"}, {"role": "assistant", "content": "SELECT TO_CHAR(orders.OrderDate, 'YYYY-MM') AS month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE EXTRACT(YEAR FROM orders.OrderDate) = 2023 GROUP BY TO_CHAR(orders.OrderDate, 'YYYY-MM')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How much discount has been given in total per customer?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].Quantity * [Order Details].UnitPrice * [Order Details].Discount) AS TotalDiscount FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many units of each product are currently in stock?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName, UnitsInStock FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the products with the highest average discount applied."}, {"role": "assistant", "content": "SELECT od.ProductID, AVG(od.Discount) AS AvgDiscount FROM [Order Details] od GROUP BY od.ProductID ORDER BY AvgDiscount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Calculate the inventory turnover ratio for each product category in 2023."}, {"role": "assistant", "content": "SELECT categories.CategoryID, SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN categories ON products.CategoryID = categories.CategoryID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY categories.CategoryID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify suppliers providing products that are discontinued."}, {"role": "assistant", "content": "SELECT DISTINCT s.SupplierID, s.CompanyName FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID WHERE p.Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the average number of days between order date and shipping date."}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, OrderDate)) AS AverageShippingTime FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the product with the highest unit price."}, {"role": "assistant", "content": "SELECT ProductName FROM products ORDER BY UnitPrice DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total value of units currently in stock for each product?"}, {"role": "assistant", "content": "SELECT ProductID, (UnitsInStock * UnitPrice) AS TotalStockValue FROM products;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which shipping company has the highest on-time delivery rate?"}, {"role": "assistant", "content": "SELECT shippers.CompanyName, COUNT(CASE WHEN orders.ShippedDate <= orders.RequiredDate THEN 1 END) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders JOIN shippers ON orders.ShipVia = shippers.ShipperID GROUP BY shippers.CompanyName ORDER BY on_time_delivery_rate DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount provided by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(od.Discount) AS AverageDiscount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the product categories with the most discontinued products."}, {"role": "assistant", "content": "SELECT p.CategoryID, COUNT(*) AS DiscontinuedCount FROM products p WHERE p.Discontinued = 1 GROUP BY p.CategoryID ORDER BY DiscontinuedCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many units in stock are there for each category?"}, {"role": "assistant", "content": "SELECT CategoryID, SUM(UnitsInStock) AS TotalUnitsInStock FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount given on orders across all products?"}, {"role": "assistant", "content": "SELECT AVG(Discount) FROM [Order Details]"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which suppliers have supplied products with the least discounts applied?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN suppliers ON products.SupplierID = suppliers.SupplierID WHERE [Order Details].Discount = (SELECT MIN(Discount) FROM [Order Details]) GROUP BY suppliers.CompanyName"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which product generated the highest revenue in the last year?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(UnitPrice * Quantity * (1 - Discount)) AS Revenue FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(OrderDate) = YEAR(CURRENT_DATE) - 1 GROUP BY ProductID ORDER BY Revenue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the monthly growth rate in total sales?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, ((SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) - LAG(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))) OVER (ORDER BY DATE_FORMAT(OrderDate, '%Y-%m'))) / LAG(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))) OVER (ORDER BY DATE_FORMAT(OrderDate, '%Y-%m')) * 100) AS MonthlyGrowthRate FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Determine the monthly inventory turnover ratio for 2023."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS month, SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN products ON [Order Details].ProductID = products.ProductID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY DATE_FORMAT(orders.OrderDate, '%Y-%m')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average order fulfillment time for the first half of 2023?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_fulfillment_time FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-06-30'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the top 5 cities by total revenue."}, {"role": "assistant", "content": "SELECT c.City, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.City ORDER BY TotalRevenue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which customers are purchasing products from multiple categories?"}, {"role": "assistant", "content": "SELECT customers.CustomerID FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID JOIN products ON [Order Details].ProductID = products.ProductID JOIN categories ON products.CategoryID = categories.CategoryID GROUP BY customers.CustomerID HAVING COUNT(DISTINCT categories.CategoryID) > 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the trend in the number of orders over the past six months?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS month, COUNT(OrderID) AS order_count FROM orders WHERE OrderDate >= DATE_SUB(CURDATE(), INTERVAL 6 MONTH) GROUP BY DATE_FORMAT(OrderDate, '%Y-%m') ORDER BY month"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total quantity ordered for each product?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].Quantity) AS TotalQuantityOrdered FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the most popular product based on order quantity."}, {"role": "assistant", "content": "SELECT ProductName FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY ProductName ORDER BY SUM(od.Quantity) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the most ordered products from each supplier?"}, {"role": "assistant", "content": "SELECT SupplierID, ProductName, TotalOrdered FROM (SELECT SupplierID, ProductName, SUM([Order Details].Quantity) AS TotalOrdered, ROW_NUMBER() OVER (PARTITION BY SupplierID ORDER BY SUM([Order Details].Quantity) DESC) as rn FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY SupplierID, ProductName) as ranked_products WHERE rn = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the region with the lowest on-time delivery rate."}, {"role": "assistant", "content": "SELECT ShipRegion, SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) / COUNT(OrderID) AS OnTimeRate FROM orders GROUP BY ShipRegion ORDER BY OnTimeRate ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total freight cost for orders fulfilled within the required date?"}, {"role": "assistant", "content": "SELECT SUM(Freight) AS TotalFreightCost FROM orders WHERE ShippedDate <= RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier has the highest average discount given on products?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, AVG([Order Details].Discount) AS AverageDiscount FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY suppliers.SupplierID ORDER BY AverageDiscount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount given per category?"}, {"role": "assistant", "content": "SELECT c.CategoryID, AVG(od.Discount) AS AvgDiscount FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN categories c ON p.CategoryID = c.CategoryID GROUP BY c.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products are currently out of stock?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the products with a reorder level higher than units in stock."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE ReorderLevel > UnitsInStock;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total discount value given for each product."}, {"role": "assistant", "content": "SELECT ProductID, SUM(Discount * Quantity * UnitPrice) AS TotalDiscount FROM [Order Details] GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order fulfillment time by month?"}, {"role": "assistant", "content": "SELECT TO_CHAR(OrderDate, 'YYYY-MM') AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY TO_CHAR(OrderDate, 'YYYY-MM')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the maximum freight cost incurred for a single order each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, MAX(Freight) AS MaxFreight FROM orders GROUP BY DATE_FORMAT(OrderDate, '%Y-%m')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the top 5 products with the highest sales volume."}, {"role": "assistant", "content": "SELECT p.ProductName FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductName ORDER BY SUM(od.Quantity) DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Who is the highest-paid employee, and how much did they contribute to sales?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.Salary, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, e.Salary ORDER BY e.Salary DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which product category has the highest average inventory turnover ratio?"}, {"role": "assistant", "content": "SELECT c.CategoryID, AVG(SUM(od.Quantity * od.UnitPrice) / NULLIF(AVG(p.UnitsInStock), 0)) AS AvgInventoryTurnover FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID JOIN categories c ON p.CategoryID = c.CategoryID GROUP BY c.CategoryID ORDER BY AvgInventoryTurnover DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the order details with over 20% discount."}, {"role": "assistant", "content": "SELECT OrderID, ProductID, Discount FROM [Order Details] WHERE Discount > 0.20;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee has made the highest sales in the last year?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATE_ADD(CURRENT_DATE, INTERVAL -1 YEAR) GROUP BY e.EmployeeID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Determine the average discount applied to orders in 2023."}, {"role": "assistant", "content": "SELECT AVG([Order Details].Discount) AS avg_discount FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE EXTRACT(YEAR FROM orders.OrderDate) = 2023"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many unique products does each supplier provide?"}, {"role": "assistant", "content": "SELECT SupplierID, COUNT(DISTINCT ProductID) AS UniqueProducts FROM products GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales amount generated by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average unit price of products within each category?"}, {"role": "assistant", "content": "SELECT CategoryID, AVG(UnitPrice) AS AveragePrice FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many customers have placed more than 10 orders?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT CustomerID) FROM orders GROUP BY CustomerID HAVING COUNT(OrderID) > 10;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify suppliers with products that are out of stock."}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, products.ProductName FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID WHERE products.UnitsInStock = 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Identify the top 3 employees by the number of orders they fulfilled in 2023."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, COUNT(orders.OrderID) AS fulfilled_orders FROM orders JOIN employees ON orders.EmployeeID = employees.EmployeeID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY employees.EmployeeID ORDER BY fulfilled_orders DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order quantity for products in stock?"}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, AVG(od.Quantity) AS AvgOrderQty FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE p.UnitsInStock > 0 GROUP BY p.ProductID, p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find out the products with zero stock but still on order."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock = 0 AND UnitsOnOrder > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the supplier with the highest number of discontinued products."}, {"role": "assistant", "content": "SELECT s.SupplierID, s.CompanyName, COUNT(p.ProductID) AS DiscontinuedCount FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID WHERE p.Discontinued = 1 GROUP BY s.SupplierID ORDER BY DiscontinuedCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the difference in shipping costs between orders shipped on time and late orders?"}, {"role": "assistant", "content": "SELECT (AVG(CASE WHEN ShippedDate <= RequiredDate THEN Freight ELSE NULL END) - AVG(CASE WHEN ShippedDate > RequiredDate THEN Freight ELSE NULL END)) AS CostDifference FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the products with the highest and lowest inventory turnover ratios."}, {"role": "assistant", "content": "SELECT p.ProductName, (SUM(od.Quantity * od.UnitPrice) / NULLIF(AVG(p.UnitsInStock), 0)) AS InventoryTurnover FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName ORDER BY InventoryTurnover DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top 3 most frequently ordered products?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT(ProductID) AS OrderFrequency FROM [Order Details] GROUP BY ProductID ORDER BY OrderFrequency DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which regions have the highest average shipping costs?"}, {"role": "assistant", "content": "SELECT ShipRegion, AVG(Freight) AS AvgShippingCost FROM orders GROUP BY ShipRegion ORDER BY AvgShippingCost DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which orders have the highest discounts applied?"}, {"role": "assistant", "content": "SELECT od.OrderID, od.Discount FROM [Order Details] od ORDER BY od.Discount DESC LIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Find the top 5 products that contribute to the highest revenue."}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS product_revenue FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID ORDER BY product_revenue DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped on or before the required date each month?"}, {"role": "assistant", "content": "SELECT TO_CHAR(OrderDate, 'YYYY-MM') AS Month, COUNT(OrderID) AS OnTimeOrders FROM orders WHERE ShippedDate <= RequiredDate GROUP BY TO_CHAR(OrderDate, 'YYYY-MM')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the order with the maximum quantity of a single product."}, {"role": "assistant", "content": "SELECT OrderID, ProductID, Quantity FROM [Order Details] ORDER BY Quantity DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which product has the highest total sales revenue?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(UnitPrice * Quantity * (1 - Discount)) AS TotalSales FROM [Order Details] GROUP BY ProductID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the monthly retention rate for the last 6 months?"}, {"role": "assistant", "content": "SELECT YEAR(OrderDate) AS Year, MONTH(OrderDate) AS Month, (COUNT(DISTINCT CASE WHEN OrderDate BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 1 MONTH) AND CURRENT_DATE THEN CustomerID END) * 100.0 / NULLIF(COUNT(DISTINCT CASE WHEN OrderDate < DATE_SUB(CURRENT_DATE, INTERVAL 1 MONTH) THEN CustomerID END), 0)) AS RetentionRate FROM orders WHERE OrderDate BETWEEN DATE_SUB(CURRENT_DATE, INTERVAL 6 MONTH) AND CURRENT_DATE GROUP BY YEAR(OrderDate), MONTH(OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many products have a reorder level higher than units in stock?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS NumberOfProducts FROM products WHERE ReorderLevel > UnitsInStock;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the relationship between unit price and quantity sold across products."}, {"role": "assistant", "content": "SELECT p.ProductID, p.UnitPrice, SUM(od.Quantity) AS TotalSold FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.UnitPrice;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the number of discontinued products per supplier."}, {"role": "assistant", "content": "SELECT SupplierID, COUNT(*) AS DiscontinuedCount FROM products WHERE Discontinued = 1 GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee generated the most sales last month?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATE_FORMAT(LAST_DAY(CURDATE() - INTERVAL 1 MONTH) + INTERVAL 1 DAY, '%Y-%m-01') AND o.OrderDate < DATE_FORMAT(CURDATE(), '%Y-%m-01') GROUP BY e.EmployeeID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which suppliers provide more than 10 different products?"}, {"role": "assistant", "content": "SELECT SupplierID, COUNT(DISTINCT ProductID) AS ProductCount FROM products GROUP BY SupplierID HAVING COUNT(DISTINCT ProductID) > 10;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find products with a UnitPrice greater than the average UnitPrice of all products."}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE UnitPrice > (SELECT AVG(UnitPrice) FROM products);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which shipping company is used the most?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS UsageCount FROM orders GROUP BY ShipVia ORDER BY UsageCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the employee with the earliest hire date and calculate their total sales."}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.HireDate, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE e.HireDate = (SELECT MIN(HireDate) FROM employees) GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders included a discount greater than 20%?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT OrderID) AS NumOrders FROM [Order Details] WHERE Discount > 0.20;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total quantity of products sold in the first quarter?"}, {"role": "assistant", "content": "SELECT SUM(od.Quantity) AS TotalQuantity FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID WHERE EXTRACT(QUARTER FROM o.OrderDate) = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find suppliers with discontinued products."}, {"role": "assistant", "content": "SELECT DISTINCT SupplierID FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped after the required date?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS NumberOfLateShipments FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the total number of units ordered for each product."}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS TotalOrders FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which product has the greatest number of units on order?"}, {"role": "assistant", "content": "SELECT ProductName, UnitsOnOrder FROM products ORDER BY UnitsOnOrder DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which shipping method is used most frequently?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS UsageCount FROM orders GROUP BY ShipVia ORDER BY UsageCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which orders had a delivery time greater than required?"}, {"role": "assistant", "content": "SELECT OrderID, DATEDIFF(ShippedDate, RequiredDate) AS DeliveryTime FROM orders WHERE DATEDIFF(ShippedDate, OrderDate) > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average order value for Q1 of this year?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE QUARTER(orders.OrderDate) = 1 AND YEAR(orders.OrderDate) = YEAR(CURDATE())"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the least ordered product each month."}, {"role": "assistant", "content": "SELECT p.ProductID, EXTRACT(MONTH FROM o.OrderDate) AS Month, SUM(od.Quantity) AS TotalQuantity FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY p.ProductID, Month ORDER BY Month, TotalQuantity ASC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many unique products are sold in a specific region?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT od.ProductID) FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.ShipRegion = 'SpecificRegion';"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have never been ordered?"}, {"role": "assistant", "content": "SELECT ProductID FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped late per month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, COUNT(OrderID) AS LateOrders FROM orders WHERE ShippedDate > RequiredDate GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify suppliers with no products currently in stock."}, {"role": "assistant", "content": "SELECT s.SupplierID, s.CompanyName FROM suppliers s WHERE NOT EXISTS (SELECT 1 FROM products p WHERE s.SupplierID = p.SupplierID AND p.UnitsInStock > 0);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount given per order?"}, {"role": "assistant", "content": "SELECT AVG(Discount) AS AverageDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the distribution of shipping costs across different regions?"}, {"role": "assistant", "content": "SELECT ShipRegion, AVG(Freight) AS AverageFreight FROM orders GROUP BY ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total Customer Lifetime Value for each customer?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS LifetimeValue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN \"Order Details\" ON orders.OrderID = \"Order Details\".OrderID GROUP BY customers.CustomerID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the top 5 products based on units sold."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, SUM(od.Quantity) as UnitsSold FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName ORDER BY UnitsSold DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many products have never been ordered?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the age distribution of employees making the most sales?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.BirthDate, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID ORDER BY TotalSales DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have a unit price higher than the average unit price of all products?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitPrice > (SELECT AVG(UnitPrice) FROM products);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which order had the highest total discount?"}, {"role": "assistant", "content": "SELECT OrderID, SUM(Discount * UnitPrice * Quantity) AS TotalDiscount FROM [Order Details] GROUP BY OrderID ORDER BY TotalDiscount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total quantity of products ordered by each customer?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].Quantity) AS TotalQuantity FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order value by customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, AVG(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS AverageOrderValue FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List products that have never been ordered."}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE ProductID NOT IN (SELECT ProductID FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the monthly trend of on-time delivery rate?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END) * 100.0 / COUNT(*) AS OnTimeRate FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify trends in stock levels over the past year for a given product."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(od.OrderDate, '%Y-%m') AS OrderMonth, p.ProductName, p.UnitsInStock AS StockLevels FROM OrderDetails od JOIN products p ON od.ProductID = p.ProductID WHERE p.ProductID = ? AND od.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY OrderMonth, p.ProductName, StockLevels ORDER BY OrderMonth;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales contribution of each sales territory (region)?"}, {"role": "assistant", "content": "SELECT e.Region, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS RegionSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.Region;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the percentage of orders delivered on time for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) * 100.0 / COUNT(OrderID) AS OnTimeRate FROM orders GROUP BY ShipVia"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee has the highest number of orders with discounts applied?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) AS DiscountedOrders FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE od.Discount > 0 GROUP BY e.EmployeeID ORDER BY DiscountedOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top 3 performing products in terms of quantity sold?"}, {"role": "assistant", "content": "SELECT ProductName, SUM([Order Details].Quantity) AS TotalQuantitySold FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY ProductName ORDER BY TotalQuantitySold DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount given per order?"}, {"role": "assistant", "content": "SELECT AVG(Discount) AS AverageDiscount FROM (SELECT OrderID, AVG(Discount) as Discount FROM [Order Details] GROUP BY OrderID) AS OrderDiscounts;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which suppliers provide products that are frequently reordered?"}, {"role": "assistant", "content": "SELECT SupplierID, COUNT(*) AS Reorders FROM products WHERE UnitsOnOrder > 0 GROUP BY SupplierID ORDER BY Reorders DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the total revenue generated by each supplier in 2023?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_revenue FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN suppliers ON products.SupplierID = suppliers.SupplierID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY suppliers.CompanyName ORDER BY total_revenue DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Identify the customer with the highest lifetime value."}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID ORDER BY customer_lifetime_value DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier has the highest number of products?"}, {"role": "assistant", "content": "SELECT SupplierID, COUNT(ProductID) AS ProductCount FROM products GROUP BY SupplierID ORDER BY ProductCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount applied per order?"}, {"role": "assistant", "content": "SELECT OrderID, AVG(Discount) AS AverageDiscount FROM [Order Details] GROUP BY OrderID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify low-performing products with high pricing."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitPrice > 100 AND ProductID NOT IN (SELECT ProductID FROM [Order Details] GROUP BY ProductID HAVING SUM(Quantity) > 0);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the busiest shipping month based on the number of shipped orders."}, {"role": "assistant", "content": "SELECT TO_CHAR(ShippedDate, 'YYYY-MM') AS Month, COUNT(OrderID) AS ShippedOrders FROM orders GROUP BY TO_CHAR(ShippedDate, 'YYYY-MM') ORDER BY ShippedOrders DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employees are associated with the most late shipments?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS LateShipments FROM orders WHERE ShippedDate > RequiredDate GROUP BY EmployeeID ORDER BY LateShipments DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated per product?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity * od.UnitPrice * (1 - od.Discount)) AS Revenue FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped but not delivered by the required date?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS LateOrders FROM orders WHERE ShippedDate IS NOT NULL AND ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which territories generate the highest sales, and which employees manage them?"}, {"role": "assistant", "content": "SELECT e.Region, e.FirstName || ' ' || e.LastName AS EmployeeName, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.Region, EmployeeName ORDER BY TotalSales DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Calculate the on-time delivery rate for the second quarter of 2023."}, {"role": "assistant", "content": "SELECT CAST(SUM(CASE WHEN orders.ShippedDate <= orders.RequiredDate THEN 1 ELSE 0 END) AS FLOAT) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders WHERE OrderDate BETWEEN '2023-04-01' AND '2023-06-30'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the Inventory Turnover Ratio for each product?"}, {"role": "assistant", "content": "SELECT p.ProductID, (SUM(od.Quantity * od.UnitPrice) / AVG(p.UnitsInStock)) as InventoryTurnover FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have a reorder level higher than 20?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE ReorderLevel > 20;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the trend of on-time delivery rates by month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(orders.OrderDate, '%Y-%m') AS month, (COUNT(CASE WHEN orders.ShippedDate <= orders.RequiredDate THEN orders.OrderID END) / COUNT(orders.OrderID))*100 AS on_time_rate FROM orders GROUP BY month"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the month-over-month growth in sales for each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, DATE_FORMAT(o.OrderDate,'%Y-%m') AS Month, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS MonthlySales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, Month ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List employees with more than 5 years of service and their cumulative sales."}, {"role": "assistant", "content": "SELECT e.EmployeeID, CONCAT(e.FirstName, ' ', e.LastName) AS EmployeeName, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE DATEDIFF(CURRENT_DATE, e.HireDate) > 1825 GROUP BY e.EmployeeID, e.FirstName, e.LastName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which city received the most shipments and what are the total sales to that city?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(o.OrderID) AS Shipments, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY ShipCity ORDER BY Shipments DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total number of products supplied by each supplier?"}, {"role": "assistant", "content": "SELECT SupplierID, COUNT(ProductID) AS ProductCount FROM products GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which city has the highest number of suppliers?"}, {"role": "assistant", "content": "SELECT City, COUNT(SupplierID) AS NumberOfSuppliers FROM suppliers GROUP BY City ORDER BY NumberOfSuppliers DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total number of products in each category?"}, {"role": "assistant", "content": "SELECT CategoryID, COUNT(ProductID) AS NumberOfProducts FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the top 5 products by total sales value."}, {"role": "assistant", "content": "SELECT od.ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM [Order Details] od GROUP BY od.ProductID ORDER BY TotalSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped after the required date?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS LateOrders FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which month had the highest on-time delivery rate?"}, {"role": "assistant", "content": "SELECT Month, OnTimeDeliveryRate FROM (SELECT DATE_TRUNC('month', OrderDate) AS Month, SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) * 100.0 / COUNT(OrderID) AS OnTimeDeliveryRate FROM orders GROUP BY Month) AS MonthlyRates ORDER BY OnTimeDeliveryRate DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List products with a sales count but no current stock."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE p.UnitsInStock = 0 GROUP BY p.ProductID, p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many customers have placed orders in more than one country?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT CustomerID) FROM (SELECT CustomerID, COUNT(DISTINCT ShipCountry) AS CountryCount FROM orders GROUP BY CustomerID) AS CountryCounts WHERE CountryCount > 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated by each country?"}, {"role": "assistant", "content": "SELECT ShipCountry, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS Revenue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total discount amount provided for each product."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, SUM(od.Quantity * od.UnitPrice * od.Discount) AS TotalDiscount FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which cities have the highest number of orders handled by employees?"}, {"role": "assistant", "content": "SELECT o.ShipCity, COUNT(DISTINCT o.OrderID) AS OrderCount FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID GROUP BY o.ShipCity ORDER BY OrderCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which shipping method is used most frequently?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS Frequency FROM orders GROUP BY ShipVia ORDER BY Frequency DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the top 5 customers by total revenue generated."}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID ORDER BY TotalRevenue DESC LIMIT 5"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the average unit price of products per supplier."}, {"role": "assistant", "content": "SELECT SupplierID, AVG(UnitPrice) AS AverageUnitPrice FROM products GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the total number of products sold by each supplier."}, {"role": "assistant", "content": "SELECT SupplierID, SUM([Order Details].Quantity) AS TotalProductsSold FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which products have the highest sales volume last month?"}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].Quantity) AS sales_volume FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH) AND MONTH(orders.OrderDate) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH) GROUP BY products.ProductName ORDER BY sales_volume DESC"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which shipping company has the lowest average shipping cost per order?"}, {"role": "assistant", "content": "SELECT shippers.CompanyName, AVG(orders.Freight) AS avg_shipping_cost FROM orders JOIN shippers ON orders.ShipVia = shippers.ShipperID GROUP BY shippers.CompanyName ORDER BY avg_shipping_cost ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the top 5 customers by order quantity."}, {"role": "assistant", "content": "SELECT c.CustomerID, SUM(od.Quantity) AS TotalQuantity FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID ORDER BY TotalQuantity DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many discontinued products does each supplier have?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, COUNT(*) AS DiscontinuedProducts FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID WHERE products.Discontinued = 1 GROUP BY suppliers.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify customers with orders exceeding $5000 in total."}, {"role": "assistant", "content": "SELECT c.CustomerID FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID HAVING SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) > 5000;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average shipping cost per order in the last quarter?"}, {"role": "assistant", "content": "SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders WHERE OrderDate BETWEEN '2023-07-01' AND '2023-09-30'"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the retention rate for the last month?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT o.CustomerID) / (SELECT COUNT(DISTINCT o.CustomerID) FROM orders o WHERE o.OrderDate < DATE_TRUNC('month', current_date) - INTERVAL '1' month) FROM orders o WHERE o.OrderDate BETWEEN DATE_TRUNC('month', current_date) - INTERVAL '1' month AND DATE_TRUNC('month', current_date);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have the highest unit price in each category?"}, {"role": "assistant", "content": "SELECT p.CategoryID, p.ProductID, p.ProductName, p.UnitPrice FROM products p INNER JOIN (SELECT CategoryID, MAX(UnitPrice) AS MaxPrice FROM products GROUP BY CategoryID) mp ON p.CategoryID = mp.CategoryID AND p.UnitPrice = mp.MaxPrice;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find seasonal trends in product sales by month."}, {"role": "assistant", "content": "SELECT TO_CHAR(o.OrderDate, 'YYYY-MM') AS Month, p.ProductName, SUM(od.Quantity) AS TotalQuantity FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY TO_CHAR(o.OrderDate, 'YYYY-MM'), p.ProductName ORDER BY Month, TotalQuantity DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average freight cost per order?"}, {"role": "assistant", "content": "SELECT AVG(Freight) AS AvgFreight FROM orders"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier has the least lead time?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS AverageLeadTime FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON orders.OrderID = [Order Details].OrderID GROUP BY suppliers.SupplierID ORDER BY AverageLeadTime ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the contribution of each product to the total revenue?"}, {"role": "assistant", "content": "SELECT ProductName, SUM(od.UnitPrice * od.Quantity) * 100.0 / (SELECT SUM(UnitPrice * Quantity) FROM [Order Details]) AS Contribution FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductID ORDER BY Contribution DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average number of units ordered for each product category?"}, {"role": "assistant", "content": "SELECT p.CategoryID, AVG(od.Quantity) AS AvgQuantity FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the top 5 cities with the highest number of orders."}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS TotalOrders FROM orders GROUP BY ShipCity ORDER BY TotalOrders DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the most common shipping method used?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS NumberOfShipments FROM orders GROUP BY ShipVia ORDER BY NumberOfShipments DESC FETCH FIRST 1 ROW ONLY;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many unique products were ordered last year?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT ProductID) FROM [Order Details] WHERE OrderID IN (SELECT OrderID FROM orders WHERE YEAR(OrderDate) = YEAR(CURRENT_DATE) - 1);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which city had the highest number of orders last year?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(*) AS OrderCount FROM orders WHERE YEAR(OrderDate) = YEAR(CURDATE()) - 1 GROUP BY ShipCity ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount applied across all order details?"}, {"role": "assistant", "content": "SELECT AVG(Discount) AS AverageDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average shipping cost per order for each month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, AVG(Freight) AS AverageShippingCostPerOrder FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the average unit price of products from each supplier."}, {"role": "assistant", "content": "SELECT SupplierID, AVG(UnitPrice) AS AvgUnitPrice FROM products GROUP BY SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What percentage of orders were delivered on or before the required date each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, COUNT(CASE WHEN ShippedDate <= RequiredDate THEN OrderID END) * 100.0 / COUNT(OrderID) AS OnTimeDeliveryRate FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How do sales trends vary by employee over the last quarter?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, DATE_FORMAT(o.OrderDate, '%Y-%m') AS Month, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS MonthlySales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 3 MONTH) GROUP BY e.EmployeeID, Month ORDER BY e.EmployeeID, Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order value handled by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, AVG(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS AverageOrderValue FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated from each country?"}, {"role": "assistant", "content": "SELECT Country, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY Country"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Identify the employee with the highest sales in the United States."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID JOIN customers ON orders.CustomerID = customers.CustomerID WHERE customers.Country = 'USA' GROUP BY employees.EmployeeID ORDER BY employee_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the product performance based on sales in the last month?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS TotalSales FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID WHERE od.OrderDate >= DATE_SUB(CURRENT_DATE, INTERVAL 1 MONTH) GROUP BY p.ProductName ORDER BY TotalSales DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the correlation between freight cost and shipping time?"}, {"role": "assistant", "content": "SELECT CORR(Freight, DATEDIFF(ShippedDate, OrderDate)) AS Correlation FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were placed each month by each customer?"}, {"role": "assistant", "content": "SELECT TO_CHAR(OrderDate, 'YYYY-MM') AS Month, CustomerID, COUNT(OrderID) AS OrdersCount FROM orders GROUP BY TO_CHAR(OrderDate, 'YYYY-MM'), CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the customer with the highest number of orders in the last month."}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS NumberOfOrders FROM orders WHERE OrderDate >= DATE_TRUNC('month', CURRENT_DATE - INTERVAL '1 month') GROUP BY CustomerID ORDER BY NumberOfOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average number of days orders are shipped late?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, RequiredDate)) AS AvgDaysLate FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the total units ordered for each category?"}, {"role": "assistant", "content": "SELECT p.CategoryID, SUM(od.Quantity) AS TotalUnitsOrdered FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total number of orders delayed beyond the required date for each month?"}, {"role": "assistant", "content": "SELECT TO_CHAR(OrderDate, 'YYYY-MM') AS Month, COUNT(*) AS DelayedOrders FROM orders WHERE ShippedDate > RequiredDate GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Calculate the customer retention rate for the first half of 2023."}, {"role": "assistant", "content": "SELECT (SELECT COUNT(DISTINCT CustomerID) FROM orders WHERE OrderDate BETWEEN '2023-01-01' AND '2023-06-30') / NULLIF((SELECT COUNT(DISTINCT CustomerID) FROM orders WHERE OrderDate < '2023-01-01'), 0) AS customer_retention_rate"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the lifetime value of each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS LifetimeValue FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were not shipped by their required date?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were placed by customers in each region?"}, {"role": "assistant", "content": "SELECT ShipRegion, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify any correlation between employee salary and sales performance."}, {"role": "assistant", "content": "SELECT e.EmployeeID, e.Salary, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How does the average shipping cost vary by country?"}, {"role": "assistant", "content": "SELECT ShipCountry, AVG(Freight) AS AvgShippingCost FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average age of employees in each title category?"}, {"role": "assistant", "content": "SELECT e.Title, AVG(TIMESTAMPDIFF(YEAR, e.BirthDate, CURDATE())) AS AverageAge FROM employees e GROUP BY e.Title;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee fulfilled the highest number of orders?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS NumOrders FROM orders GROUP BY EmployeeID ORDER BY NumOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the average time delay for late orders by month."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(DATEDIFF(ShippedDate, RequiredDate)) AS AvgDelay FROM orders WHERE ShippedDate > RequiredDate GROUP BY DATE_FORMAT(OrderDate, '%Y-%m')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List all discontinued products."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which country has the highest average shipping cost?"}, {"role": "assistant", "content": "SELECT ShipCountry, AVG(Freight) AS AverageFreight FROM orders GROUP BY ShipCountry ORDER BY AverageFreight DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which discontinued products still have stock available?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName FROM products WHERE Discontinued = 1 AND UnitsInStock > 0;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the monthly inventory turnover ratio."}, {"role": "assistant", "content": "SELECT strftime('%Y-%m', o.OrderDate) AS Month, SUM(od.Quantity * od.UnitPrice) / AVG(p.UnitsInStock) AS InventoryTurnoverRatio FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total sales value for products with a discount."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName, SUM(od.Quantity * od.UnitPrice * (1 - od.Discount)) as TotalSales FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID WHERE od.Discount > 0 GROUP BY p.ProductID, p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the top 5 products by total sales revenue."}, {"role": "assistant", "content": "SELECT ProductID, SUM(UnitPrice * Quantity * (1 - Discount)) AS TotalSales FROM [Order Details] GROUP BY ProductID ORDER BY TotalSales DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average discount given for all products ordered."}, {"role": "assistant", "content": "SELECT AVG(Discount) AS AvgDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List all products with their total quantity sold over all orders."}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS TotalQuantitySold FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales revenue per product for the last month?"}, {"role": "assistant", "content": "SELECT products.ProductName, SUM([Order Details].Quantity * [Order Details].UnitPrice) AS TotalSales FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate >= DATEADD(MONTH, -1, CAST(GETDATE() AS DATE)) GROUP BY products.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which category has the most products out of stock?"}, {"role": "assistant", "content": "SELECT CategoryID, COUNT(ProductID) AS OutOfStockCount FROM products WHERE UnitsInStock = 0 GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were fulfilled within 5 days across all regions?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS OrdersFulfilledWithin5Days FROM orders WHERE DATEDIFF(ShippedDate, OrderDate) <= 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated by each supplier?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON orders.OrderID = [Order Details].OrderID GROUP BY suppliers.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total number of orders shipped late by each employee."}, {"role": "assistant", "content": "SELECT e.EmployeeID, COUNT(o.OrderID) AS LateShipments FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID WHERE o.ShippedDate > o.RequiredDate GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which employee generated the most sales in February 2023?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID WHERE MONTH(orders.OrderDate) = 2 AND YEAR(orders.OrderDate) = 2023 GROUP BY employees.EmployeeID ORDER BY employee_sales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the average UnitPrice for each category."}, {"role": "assistant", "content": "SELECT CategoryID, AVG(UnitPrice) as AveragePrice FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which region had the highest growth in sales in the last six months?"}, {"role": "assistant", "content": "SELECT ShipRegion, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM [Order Details] JOIN orders ON orders.OrderID = [Order Details].OrderID WHERE orders.OrderDate >= DATEADD(month, -6, CURRENT_DATE) GROUP BY orders.ShipRegion ORDER BY TotalSales DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales generated by each employee?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total discount given to customers this month?"}, {"role": "assistant", "content": "SELECT SUM(od.UnitPrice * od.Quantity * od.Discount) AS TotalDiscount FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID WHERE MONTH(OrderDate) = MONTH(CURRENT_DATE) AND YEAR(OrderDate) = YEAR(CURRENT_DATE);"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which product had the highest performance in terms of quantity sold in the past year?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 12 MONTH) GROUP BY products.ProductID ORDER BY product_performance DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify orders with a total value greater than $10,000."}, {"role": "assistant", "content": "SELECT o.OrderID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalValue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.OrderID HAVING SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) > 10000;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average units in stock for each product category."}, {"role": "assistant", "content": "SELECT c.CategoryID, AVG(p.UnitsInStock) AS AvgStock FROM products p JOIN categories c ON p.CategoryID = c.CategoryID GROUP BY c.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the total discount given by month in 2023?"}, {"role": "assistant", "content": "SELECT TO_CHAR(OrderDate, 'YYYY-MM') AS month, SUM([Order Details].UnitPrice * [Order Details].Quantity * [Order Details].Discount) AS total_discount FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE EXTRACT(YEAR FROM OrderDate) = 2023 GROUP BY TO_CHAR(OrderDate, 'YYYY-MM')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average number of products in each order?"}, {"role": "assistant", "content": "SELECT AVG(NumProducts) FROM (SELECT OrderID, COUNT(ProductID) AS NumProducts FROM [Order Details] GROUP BY OrderID) AS OrderProductCount;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top 5 products with the highest unit price?"}, {"role": "assistant", "content": "SELECT ProductName, UnitPrice FROM products ORDER BY UnitPrice DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the total freight cost by each supplier."}, {"role": "assistant", "content": "SELECT s.SupplierID, s.CompanyName, SUM(o.Freight) AS TotalFreight FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY s.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the countries with the highest number of suppliers."}, {"role": "assistant", "content": "SELECT Country, COUNT(SupplierID) AS SupplierCount FROM suppliers GROUP BY Country ORDER BY SupplierCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What proportion of orders were delivered late by month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, SUM(CASE WHEN ShippedDate > RequiredDate THEN 1 ELSE 0 END) / COUNT(OrderID) AS LateDeliveryRate FROM orders GROUP BY DATE_FORMAT(OrderDate, '%Y-%m')"}]}
{"messages": [{"role": "system", "content": "You are a smart AI assistant with excellent SQL and data analysis skills. You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List products where the units on order exceed the units in stock."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsOnOrder > UnitsInStock;"}]}
