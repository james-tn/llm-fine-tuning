{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount given per order?"}, {"role": "assistant", "content": "SELECT AVG(Discount) FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which region had the longest average order fulfillment time?"}, {"role": "assistant", "content": "SELECT O.ShipRegion, AVG(DATEDIFF(O.ShippedDate, O.OrderDate)) AS AvgFulfillmentTime FROM orders O GROUP BY O.ShipRegion ORDER BY AvgFulfillmentTime DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List products with the highest inventory turnover ratio."}, {"role": "assistant", "content": "SELECT p.ProductID, (SUM(od.Quantity * od.UnitPrice) / AVG(p.UnitsInStock)) AS InventoryTurnoverRatio FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY InventoryTurnoverRatio DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have received the highest discount on average?"}, {"role": "assistant", "content": "SELECT products.ProductName, AVG([Order Details].Discount) AS AverageDiscount FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductID ORDER BY AverageDiscount DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total discount provided by each employee?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].Discount * [Order Details].UnitPrice * [Order Details].Quantity) AS TotalDiscount FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales amount for each employee in the last month?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS MonthlySales FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH) GROUP BY e.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total value of inventory currently in stock?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * UnitsInStock) AS InventoryValue FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which day of the week has the highest number of orders placed?"}, {"role": "assistant", "content": "SELECT DAYNAME(o.OrderDate) AS OrderDay, COUNT(*) AS NumberOfOrders FROM orders o GROUP BY OrderDay ORDER BY NumberOfOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average discount applied in all orders by each employee."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, AVG([Order Details].Discount) AS AvgDiscount FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the contributions of each employee towards the top 3 most ordered products."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, products.ProductID, SUM([Order Details].Quantity * [Order Details].UnitPrice) AS SalesValue FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY employees.EmployeeID, products.ProductID ORDER BY SalesValue DESC LIMIT 3"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List all orders that took more than ten days to fulfill."}, {"role": "assistant", "content": "SELECT * FROM orders WHERE DATEDIFF(ShippedDate, OrderDate) > 10;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales per country?"}, {"role": "assistant", "content": "SELECT orders.ShipCountry, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY orders.ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the number of customers with missing contact information?"}, {"role": "assistant", "content": "SELECT COUNT(CustomerID) FROM customers WHERE ContactName IS NULL OR Phone IS NULL;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total value of the inventory currently in stock?"}, {"role": "assistant", "content": "SELECT SUM(UnitPrice * UnitsInStock) AS TotalInventoryValue FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the monthly inventory turnover ratio for each product?"}, {"role": "assistant", "content": "SELECT P.ProductID, (SUM(OD.Quantity * OD.UnitPrice) / AVG(P.UnitsInStock)) AS InventoryTurnover FROM [Order Details] OD JOIN products P ON OD.ProductID = P.ProductID GROUP BY P.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List all products that have never been ordered."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE ProductID NOT IN (SELECT DISTINCT ProductID FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the top five most expensive products ordered."}, {"role": "assistant", "content": "SELECT p.ProductName, p.UnitPrice FROM products p ORDER BY p.UnitPrice DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What percentage of orders included a discount in the past month?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT orders.OrderID) / (SELECT COUNT(*) FROM orders WHERE MONTH(OrderDate) = MONTH(CURDATE()) - 1 AND YEAR(OrderDate) = YEAR(CURDATE())) * 100 AS DiscountedOrdersRate FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE [Order Details].Discount > 0 AND MONTH(orders.OrderDate) = MONTH(CURDATE()) - 1 AND YEAR(orders.OrderDate) = YEAR(CURDATE());"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped after their required date in the last month?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS LateOrders FROM orders WHERE ShippedDate > RequiredDate AND OrderDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND CURDATE();"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the orders with the highest discount applied."}, {"role": "assistant", "content": "SELECT OrderID, Discount FROM [Order Details] WHERE Discount = (SELECT MAX(Discount) FROM [Order Details]);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average shipping cost per order for each customer?"}, {"role": "assistant", "content": "SELECT CustomerID, AVG(Freight) FROM orders GROUP BY CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify orders shipped within 3 days of ordering date."}, {"role": "assistant", "content": "SELECT OrderID FROM orders WHERE DATEDIFF(ShippedDate, OrderDate) <= 3;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the shortest time taken to fulfill an order?"}, {"role": "assistant", "content": "SELECT MIN(DATEDIFF(ShippedDate, OrderDate)) AS ShortestFulfillmentTime FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine how many employees report to each manager."}, {"role": "assistant", "content": "SELECT E.ReportsTo, COUNT(*) AS EmployeeCount FROM employees E GROUP BY E.ReportsTo;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the average unit price of products by category."}, {"role": "assistant", "content": "SELECT CategoryID, AVG(UnitPrice) AS AverageUnitPrice FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the total freight cost for orders shipped to each region."}, {"role": "assistant", "content": "SELECT ShipRegion, SUM(Freight) AS TotalFreightCost FROM orders GROUP BY ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which shipping method has the highest average shipping cost?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(Freight) AS AverageShippingCost FROM orders GROUP BY ShipVia ORDER BY AverageShippingCost DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the top city by total sales in December 2023?"}, {"role": "assistant", "content": "SELECT ShipCity, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS CitySales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE DATE_FORMAT(orders.OrderDate, '%Y-%m') = '2023-12' GROUP BY ShipCity ORDER BY CitySales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which products are frequently purchased together?"}, {"role": "assistant", "content": "SELECT a.ProductID, b.ProductID, COUNT(*) AS count_together FROM [Order Details] AS a JOIN [Order Details] AS b ON a.OrderID = b.OrderID AND a.ProductID <> b.ProductID GROUP BY a.ProductID, b.ProductID ORDER BY count_together DESC LIMIT 10"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customer has the highest number of orders?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(*) AS OrderCount FROM orders GROUP BY CustomerID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: For each category, find the product with the least units in stock."}, {"role": "assistant", "content": "SELECT CategoryID, ProductName FROM (SELECT *, ROW_NUMBER() OVER(PARTITION BY CategoryID ORDER BY UnitsInStock ASC) AS rn FROM products) AS t WHERE rn = 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average shipping cost per month?"}, {"role": "assistant", "content": "SELECT DATE_TRUNC('month', OrderDate) AS Month, AVG(Freight) AS AvgShippingCost FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which countries have the highest number of shipments?"}, {"role": "assistant", "content": "SELECT ShipCountry, COUNT(*) AS NumberOfShipments FROM orders GROUP BY ShipCountry ORDER BY NumberOfShipments DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the on-time delivery rate for each shipping company?"}, {"role": "assistant", "content": "SELECT shippers.CompanyName, SUM(CASE WHEN orders.ShippedDate <= orders.RequiredDate THEN 1 ELSE 0 END) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM shippers JOIN orders ON shippers.ShipperID = orders.ShipVia GROUP BY shippers.CompanyName"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales revenue for each product category?"}, {"role": "assistant", "content": "SELECT OD.ProductID, SUM(OD.UnitPrice * OD.Quantity * (1 - OD.Discount)) AS TotalSales FROM [Order Details] OD JOIN orders O ON OD.OrderID = O.OrderID GROUP BY OD.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the monthly product performance for each product."}, {"role": "assistant", "content": "SELECT p.ProductID, EXTRACT(MONTH FROM o.OrderDate) AS Month, SUM(od.Quantity) AS MonthlyPerformance FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY p.ProductID, EXTRACT(MONTH FROM o.OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales for each product category?"}, {"role": "assistant", "content": "SELECT ProductID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM [Order Details] GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders had a shipping cost greater than the average shipping cost?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) FROM orders WHERE Freight > (SELECT AVG(Freight) FROM orders);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order value for orders placed in February 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS AvgOrderValue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE DATE_FORMAT(orders.OrderDate, '%Y-%m') = '2023-02';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many customers are from each region?"}, {"role": "assistant", "content": "SELECT ShipRegion, COUNT(DISTINCT CustomerID) AS CustomerCount FROM orders GROUP BY ShipRegion;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify customers with orders that were shipped late."}, {"role": "assistant", "content": "SELECT o.CustomerID FROM orders o WHERE o.RequiredDate < o.ShippedDate;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find products with a unit price above the average unit price."}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitPrice > (SELECT AVG(UnitPrice) FROM products);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the revenue loss due to discounts for each product."}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity * od.UnitPrice * od.Discount) AS RevenueLoss FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductName;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find employees who have processed orders exclusively in their country."}, {"role": "assistant", "content": "SELECT E.EmployeeID, E.FirstName, E.LastName FROM employees E JOIN orders O ON E.EmployeeID = O.EmployeeID JOIN [Order Details] OD ON O.OrderID = OD.OrderID GROUP BY E.EmployeeID HAVING SUM(OD.UnitPrice * OD.Quantity * (1 - OD.Discount)) > 0 AND COUNT(DISTINCT ShipCountry) = 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total freight costs for orders shipped by each shipping method."}, {"role": "assistant", "content": "SELECT ShipVia, SUM(Freight) AS total_freight_cost FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the percentage of discontinued products?"}, {"role": "assistant", "content": "SELECT (SUM(CASE WHEN Discontinued = 1 THEN 1 ELSE 0 END) * 100.0 / COUNT(ProductID)) AS DiscontinuedPercentage FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average freight cost per order."}, {"role": "assistant", "content": "SELECT AVG(o.Freight) AS AverageFreight FROM orders o;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped after the required date?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS LateOrders FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many units of each product were sold last month?"}, {"role": "assistant", "content": "SELECT OD.ProductID, SUM(Quantity) AS TotalUnitsSold FROM [Order Details] OD JOIN products P ON OD.ProductID = P.ProductID WHERE MONTH(OrderDate) = MONTH(DATEADD(month, -1, GETDATE())) AND YEAR(OrderDate) = YEAR(DATEADD(month, -1, GETDATE())) GROUP BY OD.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total freight cost incurred last month?"}, {"role": "assistant", "content": "SELECT SUM(O.Freight) AS TotalFreightCost FROM orders O WHERE YEAR(O.OrderDate) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH) AND MONTH(O.OrderDate) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the monthly trend of units ordered for each product?"}, {"role": "assistant", "content": "SELECT products.ProductName, MONTH([Order Details].OrderDate) AS OrderMonth, SUM([Order Details].Quantity) AS TotalOrdered FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductName, OrderMonth;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales generated by each employee?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the product with the highest inventory turnover ratio."}, {"role": "assistant", "content": "SELECT TOP 1 products.ProductID, products.ProductName, (SUM([Order Details].Quantity * [Order Details].UnitPrice) / NULLIF(AVG(products.UnitsInStock), 0)) AS TurnoverRatio FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductID, products.ProductName ORDER BY TurnoverRatio DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the most popular product among high-value customers?"}, {"role": "assistant", "content": "SELECT products.ProductName, COUNT([Order Details].OrderID) AS popularity FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID JOIN (SELECT CustomerID FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY CustomerID HAVING SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) > 10000) AS high_value_customers ON customers.CustomerID = high_value_customers.CustomerID GROUP BY products.ProductName ORDER BY popularity DESC"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List customers who have ordered more than 10 times."}, {"role": "assistant", "content": "SELECT CustomerID FROM orders GROUP BY CustomerID HAVING COUNT(*) > 10;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated from each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have received the highest total discount?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Discount * od.Quantity * od.UnitPrice) AS TotalDiscount FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName ORDER BY TotalDiscount DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier provides the most products?"}, {"role": "assistant", "content": "SELECT SupplierID, COUNT(ProductID) AS ProductCount FROM products GROUP BY SupplierID ORDER BY ProductCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which city has the highest number of suppliers?"}, {"role": "assistant", "content": "SELECT City, COUNT(SupplierID) AS NumberOfSuppliers FROM suppliers GROUP BY City ORDER BY NumberOfSuppliers DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee handled the most orders last quarter?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS OrdersHandled FROM orders WHERE OrderDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 3 MONTH) AND CURDATE() GROUP BY EmployeeID ORDER BY OrdersHandled DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have stock levels below their reorder level?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the average time between the order date and required date."}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(RequiredDate, OrderDate)) AS AvgOrderGap FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which product has the highest total discount applied to orders?"}, {"role": "assistant", "content": "SELECT p.ProductName FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName ORDER BY SUM(od.Discount * od.Quantity * od.UnitPrice) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many customers are there in each country?"}, {"role": "assistant", "content": "SELECT Country, COUNT(CustomerID) AS CustomerCount FROM customers GROUP BY Country;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which supplier provides the most diverse range of products?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, COUNT(DISTINCT products.ProductID) AS ProductCount FROM suppliers JOIN products ON suppliers.SupplierID = products.SupplierID GROUP BY suppliers.SupplierID ORDER BY ProductCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which orders had the highest discounts applied?"}, {"role": "assistant", "content": "SELECT orders.OrderID, [Order Details].Discount FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID ORDER BY [Order Details].Discount DESC LIMIT 10"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales revenue generated for each month?"}, {"role": "assistant", "content": "SELECT MONTH(OrderDate) AS Month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS MonthlySales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY MONTH(OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average unit price of products ordered with a discount greater than 0.05?"}, {"role": "assistant", "content": "SELECT AVG(od.UnitPrice) FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID WHERE od.Discount > 0.05;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the order with the maximum delay beyond the required date."}, {"role": "assistant", "content": "SELECT OrderID, DATEDIFF(ShippedDate, RequiredDate) AS Delay FROM orders WHERE ShippedDate > RequiredDate ORDER BY Delay DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the most expensive product supplied by each supplier?"}, {"role": "assistant", "content": "SELECT SupplierID, ProductName, UnitPrice FROM products WHERE (SupplierID, UnitPrice) IN (SELECT SupplierID, MAX(UnitPrice) FROM products GROUP BY SupplierID);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the monthly average order value over the last year?"}, {"role": "assistant", "content": "SELECT MONTH(o.OrderDate) AS month, AVG(SUM(od.UnitPrice * od.Quantity * (1 - od.Discount))) AS avg_order_value FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE YEAR(o.OrderDate) = YEAR(CURRENT_DATE() - INTERVAL 1 YEAR) GROUP BY MONTH(o.OrderDate);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average lead time for each supplier in delivering products?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS AverageLeadTime FROM products JOIN orders ON products.ProductID = orders.OrderID JOIN suppliers ON products.SupplierID = suppliers.SupplierID GROUP BY suppliers.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total freight cost for shipments handled by each employee?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM(Freight) AS TotalFreight FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the average age of employees and cross-compare it with their total sales figures."}, {"role": "assistant", "content": "SELECT AVG(YEAR(CURDATE()) - YEAR(employees.BirthDate)) AS AvgAge, sales.TotalSales FROM employees JOIN (SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID) AS sales ON employees.EmployeeID = sales.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine which city has the highest number of shipping orders."}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS NumberOfOrders FROM orders GROUP BY ShipCity ORDER BY NumberOfOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the customer retention rate from 2022 to 2023?"}, {"role": "assistant", "content": "(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top 3 cities with the most orders?"}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipCity ORDER BY OrderCount DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped after the required date in August 2023?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS LateOrders FROM orders WHERE ShippedDate > RequiredDate AND DATE_FORMAT(OrderDate, '%Y-%m') = '2023-08';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the average salary of employees by title."}, {"role": "assistant", "content": "SELECT Title, AVG(Salary) AS AvgSalary FROM employees GROUP BY Title"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total discount applied across all orders managed by each employee?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * [Order Details].Discount) AS TotalDiscount FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales revenue from all orders last month?"}, {"role": "assistant", "content": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalSales FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 MONTH);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the customer with the most late shipments in 2023."}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(*) FROM orders WHERE ShippedDate > RequiredDate AND OrderDate BETWEEN '2023-01-01' AND '2023-12-31' GROUP BY CustomerID ORDER BY COUNT(*) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total quantity and revenue for orders with discounts greater than 10%?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS TotalQuantity, SUM(Quantity * UnitPrice * (1 - Discount)) AS TotalRevenue FROM [Order Details] WHERE Discount > 0.1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the suppliers providing products priced above $100 per unit."}, {"role": "assistant", "content": "SELECT DISTINCT SupplierID FROM products WHERE UnitPrice > 100;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order quantity for orders taken by each employee?"}, {"role": "assistant", "content": "SELECT E.EmployeeID, AVG(OD.Quantity) AS AverageQuantity FROM employees E JOIN orders O ON E.EmployeeID = O.EmployeeID JOIN [Order Details] OD ON O.OrderID = OD.OrderID GROUP BY E.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the monthly trend in the number of orders placed?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, COUNT(OrderID) AS NumOrders FROM orders GROUP BY Month ORDER BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which customers are located in cities with the highest total sales?"}, {"role": "assistant", "content": "SELECT customers.CompanyName, orders.ShipCity, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CompanyName, orders.ShipCity ORDER BY total_sales DESC"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped late?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were placed in the last month?"}, {"role": "assistant", "content": "SELECT COUNT(OrderID) AS OrdersLastMonth FROM orders WHERE OrderDate >= DATE_SUB(LAST_DAY(DATE_SUB(NOW(), INTERVAL 1 MONTH)), INTERVAL DAY(LAST_DAY(DATE_SUB(NOW(), INTERVAL 1 MONTH))) - 1 DAY);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which region has the highest average employee salary?"}, {"role": "assistant", "content": "SELECT Region, AVG(Salary) AS AverageSalary FROM employees GROUP BY Region ORDER BY AverageSalary DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the supplier with the longest average lead time."}, {"role": "assistant", "content": "SELECT s.CompanyName, AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AverageLeadTime FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID GROUP BY s.CompanyName ORDER BY AverageLeadTime DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total number of discontinued products?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS DiscontinuedCount FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated by each customer over their lifetime?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount applied to orders?"}, {"role": "assistant", "content": "SELECT AVG(Discount) AS AverageDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order fulfillment time for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average order value for orders made in January 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-01-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the customer retention rate for last year?"}, {"role": "assistant", "content": "SELECT (SELECT COUNT(DISTINCT CustomerID) FROM orders WHERE OrderDate BETWEEN '2022-01-01' AND '2022-12-31') / NULLIF((SELECT COUNT(DISTINCT CustomerID) FROM orders WHERE OrderDate < '2022-01-01'), 0) AS RetentionRate;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the products with the highest product performance score."}, {"role": "assistant", "content": "SELECT ProductID, SUM([Order Details].Quantity) AS PerformanceScore FROM [Order Details] GROUP BY ProductID ORDER BY PerformanceScore DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales amount generated by each employee for the current month?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE MONTH(orders.OrderDate) = MONTH(CURDATE()) AND YEAR(orders.OrderDate) = YEAR(CURDATE()) GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average hiring duration in years for employees before they started generating sales."}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(orders.OrderDate, employees.HireDate) / 365.25) AS AvgYearsBeforeSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average unit price of products by category?"}, {"role": "assistant", "content": "SELECT c.CategoryID, AVG(p.UnitPrice) AS AvgUnitPrice FROM products p JOIN categories c ON p.CategoryID = c.CategoryID GROUP BY c.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order fulfillment time for each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(DATEDIFF(ShippedDate, OrderDate)) AS AvgFulfillmentTime FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated from sales of each product?"}, {"role": "assistant", "content": "SELECT p.ProductID, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order fulfillment time grouped by employee?"}, {"role": "assistant", "content": "SELECT EmployeeID, AVG(DATEDIFF(ShippedDate, OrderDate)) AS average_fulfillment_time FROM orders GROUP BY EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify products with a below-average inventory turnover ratio."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName FROM products p WHERE (SELECT SUM(od.Quantity * od.UnitPrice) FROM [Order Details] od WHERE od.ProductID = p.ProductID) / NULLIF(AVG(p.UnitsInStock), 0) < (SELECT AVG(SUM(od.Quantity * od.UnitPrice) / NULLIF(AVG(p.UnitsInStock), 0)) FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find out the month with the highest average order value."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(o.OrderDate, '%Y-%m') AS MonthYear, AVG(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS AvgOrderValue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY MonthYear ORDER BY AvgOrderValue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders has each employee handled this month?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS OrdersThisMonth FROM orders WHERE YEAR(OrderDate) = YEAR(CURRENT_DATE) AND MONTH(OrderDate) = MONTH(CURRENT_DATE) GROUP BY EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders contain a discount higher than 20%?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS HighDiscountOrders FROM [Order Details] WHERE Discount > 0.20;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the order with the largest total sales value."}, {"role": "assistant", "content": "SELECT OrderID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSalesValue FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY OrderID ORDER BY TotalSalesValue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the distribution of employees across different regions?"}, {"role": "assistant", "content": "SELECT Region, COUNT(EmployeeID) AS NumberOfEmployees FROM employees GROUP BY Region;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which product had the highest sales volume in the last quarter?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(Quantity) FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 3 MONTH) AND CURDATE() GROUP BY ProductID ORDER BY SUM(Quantity) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List all shipments that were delayed."}, {"role": "assistant", "content": "SELECT * FROM orders WHERE ShippedDate > RequiredDate;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total discount given on all products?"}, {"role": "assistant", "content": "SELECT SUM(Quantity * UnitPrice * Discount) AS TotalDiscount FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the product performance score for the top 5 selling products."}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity) AS PerformanceScore FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID GROUP BY p.ProductID ORDER BY PerformanceScore DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List all discontinued products and their remaining units in stock."}, {"role": "assistant", "content": "SELECT ProductName, UnitsInStock FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customer placed the highest number of orders?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS NumberOfOrders FROM orders GROUP BY CustomerID ORDER BY NumberOfOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What percentage of orders have not been shipped yet?"}, {"role": "assistant", "content": "SELECT (COUNT(CASE WHEN ShippedDate IS NULL THEN 1 END) / COUNT(OrderID)) * 100 AS UnshippedOrdersPercentage FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top 5 customers by total order value?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalValue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID ORDER BY TotalValue DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the average time difference between order date and required date."}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(RequiredDate, OrderDate)) AS AverageOrderToRequired FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total order quantity fulfilled by each employee?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].Quantity) AS TotalQuantity FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have a UnitsInStock value below their ReorderLevel?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order value for each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, AVG(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS AvgOrderValue FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many units are on order for each product?"}, {"role": "assistant", "content": "SELECT ProductName, UnitsOnOrder FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which city has the highest number of employee shipments?"}, {"role": "assistant", "content": "SELECT o.ShipCity, COUNT(o.OrderID) AS Shipments FROM orders o GROUP BY o.ShipCity ORDER BY Shipments DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the most expensive order ever shipped by the company?"}, {"role": "assistant", "content": "SELECT * FROM orders ORDER BY Freight DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have fewer units in stock than their reorder level?"}, {"role": "assistant", "content": "SELECT * FROM products WHERE UnitsInStock < ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which shipping method is used most frequently?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS Frequency FROM orders GROUP BY ShipVia ORDER BY Frequency DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average unit price of products supplied by each supplier?"}, {"role": "assistant", "content": "SELECT s.CompanyName, AVG(p.UnitPrice) AS AverageUnitPrice FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID GROUP BY s.CompanyName;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Who is the most frequent shipping recipient?"}, {"role": "assistant", "content": "SELECT ShipName, COUNT(OrderID) AS NumberOfOrders FROM orders GROUP BY ShipName ORDER BY NumberOfOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the average units on order across all products."}, {"role": "assistant", "content": "SELECT AVG(UnitsOnOrder) AS AvgUnitsOnOrder FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average number of units per order for each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, AVG(od.Quantity) AS AvgUnitsPerOrder FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductName"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the monthly sales performance for each product."}, {"role": "assistant", "content": "SELECT [Order Details].ProductID, DATE_FORMAT(OrderDate, '%Y-%m') AS Month, SUM([Order Details].Quantity) AS TotalSold FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY [Order Details].ProductID, Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales for each shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated by each product category?"}, {"role": "assistant", "content": "SELECT c.CategoryID, SUM(od.Quantity * od.UnitPrice) AS TotalRevenue FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN categories c ON p.CategoryID = c.CategoryID GROUP BY c.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have generated over $10,000 in total sales revenue?"}, {"role": "assistant", "content": "SELECT ProductName FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY ProductName HAVING SUM([Order Details].Quantity * [Order Details].UnitPrice) > 10000;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many products are currently discontinued?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS DiscontinuedProducts FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated last month?"}, {"role": "assistant", "content": "SELECT SUM(od.Quantity * od.UnitPrice) AS TotalRevenue FROM [Order Details] od WHERE od.OrderID IN (SELECT OrderID FROM orders WHERE OrderDate BETWEEN '2023-09-01' AND '2023-09-30')"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the total sales revenue generated by each product category, and how does it compare monthly?"}, {"role": "assistant", "content": "SELECT c.CategoryName, MONTH(o.OrderDate) AS month, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS total_sales FROM [Order Details] od JOIN products p ON od.ProductID = p.ProductID JOIN categories c ON p.CategoryID = c.CategoryID JOIN orders o ON od.OrderID = o.OrderID GROUP BY c.CategoryName, MONTH(o.OrderDate)"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which supplier has the shortest average lead time?"}, {"role": "assistant", "content": "SELECT suppliers.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_lead_time FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID JOIN products ON [Order Details].ProductID = products.ProductID JOIN suppliers ON products.SupplierID = suppliers.SupplierID GROUP BY suppliers.SupplierID ORDER BY avg_lead_time ASC"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which supplier has the fastest lead time?"}, {"role": "assistant", "content": "SELECT suppliers.CompanyName, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_lead_time FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID JOIN products ON [Order Details].ProductID = products.ProductID JOIN suppliers ON products.SupplierID = suppliers.SupplierID GROUP BY suppliers.CompanyName ORDER BY avg_lead_time ASC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the total sales generated in each country by month for 2023?"}, {"role": "assistant", "content": "SELECT orders.ShipCountry, MONTH(orders.OrderDate) AS month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(orders.OrderDate) = 2023 GROUP BY orders.ShipCountry, MONTH(orders.OrderDate)"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify top 3 regions with the highest on-time delivery rate this year."}, {"role": "assistant", "content": "SELECT ShipRegion, SUM(CASE WHEN ShippedDate <= RequiredDate THEN 1 ELSE 0 END) * 100.0 / COUNT(OrderID) AS OnTimeRate FROM orders WHERE YEAR(OrderDate) = YEAR(CURDATE()) GROUP BY ShipRegion ORDER BY OnTimeRate DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average freight cost per employee for all orders processed last year?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, AVG(orders.Freight) AS AvgFreight FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID WHERE YEAR(orders.OrderDate) = YEAR(CURDATE()) - 1 GROUP BY employees.EmployeeID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total discount amount applied per order?"}, {"role": "assistant", "content": "SELECT OrderID, SUM(UnitPrice * Quantity * Discount) AS TotalDiscount FROM [Order Details] GROUP BY OrderID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the top 5 products with the most units on order."}, {"role": "assistant", "content": "SELECT ProductName, UnitsOnOrder FROM products ORDER BY UnitsOnOrder DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total discount given to each customer?"}, {"role": "assistant", "content": "SELECT c.CustomerID, SUM(od.UnitPrice * od.Quantity * od.Discount) AS TotalDiscount FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average age of employees."}, {"role": "assistant", "content": "SELECT AVG(YEAR(CURRENT_DATE) - YEAR(BirthDate)) AS AverageAge FROM employees;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which shipping method is used most frequently?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS NumOfOrders FROM orders GROUP BY ShipVia ORDER BY NumOfOrders DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total quantity of products sold this year?"}, {"role": "assistant", "content": "SELECT SUM(od.Quantity) AS TotalQuantity FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID WHERE YEAR(o.OrderDate) = YEAR(CURRENT_DATE());"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the percentage of products that are discontinued."}, {"role": "assistant", "content": "SELECT (COUNT(*) FILTER (WHERE Discontinued = 1) / COUNT(*)) * 100 AS DiscontinuedPercentage FROM products"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify products that need reordering based on reorder levels?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock + UnitsOnOrder <= ReorderLevel;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average discount per order for each product."}, {"role": "assistant", "content": "SELECT ProductID, AVG([Order Details].Discount) AS AverageDiscount FROM [Order Details] GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average number of products ordered per order last week?"}, {"role": "assistant", "content": "SELECT AVG(od.Quantity) AS avg_products_per_order FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE o.OrderDate BETWEEN DATE_SUB(CURRENT_DATE(), INTERVAL 7 DAY) AND CURRENT_DATE();"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have orders with discounts greater than 20%?"}, {"role": "assistant", "content": "SELECT DISTINCT ProductName FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID WHERE Discount > 0.2;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total sales for each product grouped by month."}, {"role": "assistant", "content": "SELECT p.ProductID, EXTRACT(YEAR FROM NOW()) AS Year, EXTRACT(MONTH FROM NOW()) AS Month, SUM(od.Quantity * od.UnitPrice) AS TotalSales FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, Year, Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many unique products were ordered in July 2023?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT od.ProductID) AS UniqueProducts FROM [Order Details] od JOIN orders o ON o.OrderID = od.OrderID WHERE YEAR(o.OrderDate) = 2023 AND MONTH(o.OrderDate) = 7;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average reorder level for products in each category?"}, {"role": "assistant", "content": "SELECT CategoryID, AVG(ReorderLevel) AS AverageReorderLevel FROM products GROUP BY CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the inventory turnover ratio for each product?"}, {"role": "assistant", "content": "SELECT p.ProductName, COALESCE(SUM(od.Quantity * od.UnitPrice) / NULLIF(AVG(p.UnitsInStock), 0), 0) AS InventoryTurnoverRatio FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What percentage of orders were shipped to the USA?"}, {"role": "assistant", "content": "SELECT COUNT(*) * 100.0 / (SELECT COUNT(*) FROM orders) AS USAOrdersPercentage FROM orders WHERE ShipCountry = 'USA';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the product with the highest unit price in each category."}, {"role": "assistant", "content": "SELECT CategoryID, p.ProductName FROM (SELECT CategoryID, MAX(UnitPrice) AS MaxPrice FROM products GROUP BY CategoryID) mp JOIN products p ON mp.CategoryID = p.CategoryID AND mp.MaxPrice = p.UnitPrice;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which categories have the most products discontinued?"}, {"role": "assistant", "content": "SELECT CategoryID, COUNT(*) FROM products WHERE Discontinued = 1 GROUP BY CategoryID ORDER BY COUNT(*) DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify orders with a discount greater than 25%."}, {"role": "assistant", "content": "SELECT DISTINCT o.OrderID FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE od.Discount > 0.25;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have experienced a decrease in sales compared to the previous month?"}, {"role": "assistant", "content": "SELECT ProductID FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND CURDATE() GROUP BY ProductID HAVING SUM(Quantity) < (SELECT SUM(Quantity) FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN DATE_SUB(CURDATE(), INTERVAL 2 MONTH) AND DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND ProductID = [Order Details].ProductID);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the top five countries with the highest average freight cost."}, {"role": "assistant", "content": "SELECT ShipCountry, AVG(Freight) AS avg_freight_cost FROM orders GROUP BY ShipCountry ORDER BY avg_freight_cost DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average number of orders managed by employees in each country?"}, {"role": "assistant", "content": "SELECT employees.Country, AVG(orders_count.OrdersCount) AS AvgOrders FROM employees LEFT JOIN (SELECT EmployeeID, COUNT(OrderID) AS OrdersCount FROM orders GROUP BY EmployeeID) AS orders_count ON employees.EmployeeID = orders_count.EmployeeID GROUP BY employees.Country"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the total number of units sold for each discontinued product?"}, {"role": "assistant", "content": "SELECT products.ProductID, products.ProductName, SUM([Order Details].Quantity) AS total_units_sold FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID WHERE products.Discontinued = 1 GROUP BY products.ProductID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the total number of orders shipped in the last year."}, {"role": "assistant", "content": "SELECT COUNT(*) FROM orders WHERE YEAR(ShippedDate) = YEAR(CURDATE()) - 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average shipping time for orders placed in 2023?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_shipping_time FROM orders WHERE YEAR(orders.OrderDate) = 2023"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many products were sold with a discount greater than 10% in the last year?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT od.ProductID) AS num_products FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID WHERE od.Discount > 0.1 AND YEAR(o.OrderDate) = YEAR(CURRENT_DATE() - INTERVAL 1 YEAR);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Who are the top 5 customers by the number of orders?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, COUNT(orders.OrderID) AS NumberOfOrders FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID GROUP BY customers.CustomerID ORDER BY NumberOfOrders DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the most popular shipping method?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS ShipMethodCount FROM orders GROUP BY ShipVia ORDER BY ShipMethodCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the most common product category ordered?"}, {"role": "assistant", "content": "SELECT CategoryID, COUNT(*) AS OrderCount FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY CategoryID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the top 10 orders by total value."}, {"role": "assistant", "content": "SELECT orders.OrderID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS OrderValue FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY orders.OrderID ORDER BY OrderValue DESC LIMIT 10;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How much revenue was lost due to discounts last month?"}, {"role": "assistant", "content": "SELECT SUM(od.UnitPrice * od.Quantity * od.Discount) AS DiscountLost FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID WHERE MONTH(o.OrderDate) = MONTH(DATE_SUB(CURRENT_DATE(), INTERVAL 1 MONTH)) AND YEAR(o.OrderDate) = YEAR(DATE_SUB(CURRENT_DATE(), INTERVAL 1 MONTH));"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which product has the highest total sales value?"}, {"role": "assistant", "content": "SELECT p.ProductName, SUM(od.Quantity * od.UnitPrice) AS TotalSalesValue FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY TotalSalesValue DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have a unit price greater than $50 and are not discontinued?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitPrice > 50 AND Discontinued = 0;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average order value for February 2023?"}, {"role": "assistant", "content": "SELECT SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) / COUNT(DISTINCT o.OrderID) AS AvgOrderValue FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE YEAR(o.OrderDate) = 2023 AND MONTH(o.OrderDate) = 2;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which suppliers are located in the same country as our top selling product?"}, {"role": "assistant", "content": "SELECT DISTINCT s.CompanyName FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID WHERE s.Country = (SELECT s.Country FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY s.Country ORDER BY SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) DESC LIMIT 1);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the total revenue generated by each product."}, {"role": "assistant", "content": "SELECT p.ProductID, SUM(od.Quantity * od.UnitPrice) AS TotalRevenue FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the top 5 products with the highest sales volume."}, {"role": "assistant", "content": "SELECT TOP 5 p.ProductID, SUM(od.Quantity) AS TotalSalesVolume FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID ORDER BY TotalSalesVolume DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine which orders had a discount applied and quantify the total discount given."}, {"role": "assistant", "content": "SELECT OrderID, SUM([Order Details].Quantity * [Order Details].UnitPrice * Discount) AS TotalDiscount FROM [Order Details] WHERE Discount > 0 GROUP BY OrderID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which suppliers provide the most products?"}, {"role": "assistant", "content": "SELECT s.SupplierName, COUNT(p.ProductID) AS ProductCount FROM products p JOIN suppliers s ON p.SupplierID = s.SupplierID GROUP BY s.SupplierName ORDER BY ProductCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average shipping cost for orders delivered to Europe?"}, {"role": "assistant", "content": "SELECT AVG(orders.Freight) AS average_shipping_cost FROM orders WHERE orders.ShipCountry IN ('France', 'Germany', 'UK', 'Italy', 'Spain')"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the maximum discount given on an order in the past year?"}, {"role": "assistant", "content": "SELECT MAX([Order Details].Discount) FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE YEAR(orders.OrderDate) = YEAR(CURDATE()) - 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which country had the highest average discount applied to orders?"}, {"role": "assistant", "content": "SELECT ShipCountry, AVG(od.Discount) AS AverageDiscount FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY o.ShipCountry ORDER BY AverageDiscount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the product with the highest average discount applied."}, {"role": "assistant", "content": "SELECT ProductID, AVG(Discount) AS AverageDiscount FROM [Order Details] GROUP BY ProductID ORDER BY AverageDiscount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee's orders have the most significant total discount?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, employees.FirstName, employees.LastName, SUM([Order Details].Discount * [Order Details].UnitPrice * [Order Details].Quantity) AS TotalDiscount FROM orders INNER JOIN employees ON orders.EmployeeID = employees.EmployeeID INNER JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.EmployeeID ORDER BY TotalDiscount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the top 3 products with the highest sales but lowest stock levels."}, {"role": "assistant", "content": "SELECT p.ProductID, p.ProductName FROM products p JOIN [Order Details] od ON p.ProductID = od.ProductID GROUP BY p.ProductID, p.ProductName ORDER BY SUM(od.Quantity * od.UnitPrice) DESC, p.UnitsInStock ASC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products are currently out of stock?"}, {"role": "assistant", "content": "SELECT ProductName FROM products WHERE UnitsInStock = 0;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average shipping time for each country."}, {"role": "assistant", "content": "SELECT o.ShipCountry, AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AverageShippingTime FROM orders o GROUP BY o.ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the monthly trend in the average order fulfillment time across different countries?"}, {"role": "assistant", "content": "SELECT o.ShipCountry, MONTH(o.OrderDate) AS month, AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS fulfillment_time FROM orders o GROUP BY o.ShipCountry, month"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the distribution of order quantities for the top-selling product?"}, {"role": "assistant", "content": "SELECT [Order Details].Quantity, COUNT(*) AS Frequency FROM [Order Details] WHERE [Order Details].ProductID = (SELECT [Order Details].ProductID FROM [Order Details] JOIN orders ON orders.OrderID = [Order Details].OrderID GROUP BY [Order Details].ProductID ORDER BY SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) DESC LIMIT 1) GROUP BY [Order Details].Quantity;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify trends in shipping costs over the past two years."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS month, AVG(Freight) AS avg_freight_cost FROM orders WHERE OrderDate >= DATE_SUB(CURRENT_DATE, INTERVAL 2 YEAR) GROUP BY month ORDER BY month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount applied to products sold?"}, {"role": "assistant", "content": "SELECT AVG(Discount) FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total sales revenue generated in the last month?"}, {"role": "assistant", "content": "SELECT SUM(OD.UnitPrice * OD.Quantity * (1 - OD.Discount)) AS TotalSales FROM orders O JOIN [Order Details] OD ON O.OrderID = OD.OrderID WHERE YEAR(O.OrderDate) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH) AND MONTH(O.OrderDate) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the percentage of products discontinued in each category."}, {"role": "assistant", "content": "SELECT c.CategoryName, COUNT(*) * 100.0 / (SELECT COUNT(*) FROM products WHERE CategoryID = c.CategoryID) AS DiscontinuedPercentage FROM products p JOIN categories c ON p.CategoryID = c.CategoryID WHERE p.Discontinued = 1 GROUP BY c.CategoryName;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the number of orders shipped per shipping method."}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(*) AS NumberOfOrders FROM orders WHERE ShippedDate IS NOT NULL GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average salary of employees for each job title?"}, {"role": "assistant", "content": "SELECT Title, AVG(Salary) AS AverageSalary FROM employees GROUP BY Title;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated in the last year?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE YEAR(OrderDate) = YEAR(CURRENT_DATE) - 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the highest order value in June 2023?"}, {"role": "assistant", "content": "SELECT MAX([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS HighestOrderValue FROM [Order Details] JOIN orders ON orders.OrderID = [Order Details].OrderID WHERE DATE_FORMAT(orders.OrderDate, '%Y-%m') = '2023-06';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List all orders with a discount greater than 20%."}, {"role": "assistant", "content": "SELECT OrderID, ProductID FROM [Order Details] WHERE Discount > 0.20"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total discount given on all orders monthly?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(o.OrderDate, '%Y-%m') AS Month, SUM(od.Discount * od.Quantity * od.UnitPrice) AS TotalDiscount FROM [Order Details] od JOIN orders o ON od.OrderID = o.OrderID GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List the customers who placed orders in every month this year."}, {"role": "assistant", "content": "SELECT O.CustomerID FROM orders O GROUP BY O.CustomerID HAVING COUNT(DISTINCT CONCAT(YEAR(O.OrderDate), MONTH(O.OrderDate))) = 12;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What percentage of products are currently on order?"}, {"role": "assistant", "content": "SELECT (SUM(CASE WHEN UnitsOnOrder > 0 THEN 1 ELSE 0 END) / COUNT(*)) * 100 AS PercentageOnOrder FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders do we receive on average each day?"}, {"role": "assistant", "content": "SELECT AVG(OrderCount) FROM (SELECT COUNT(*) AS OrderCount FROM orders o GROUP BY o.OrderDate) AS DailyOrders;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the top 5 employees with the highest number of orders handled."}, {"role": "assistant", "content": "SELECT orders.EmployeeID, COUNT(orders.OrderID) AS OrderCount FROM orders GROUP BY orders.EmployeeID ORDER BY OrderCount DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What percentage of orders were delivered on time for May 2023?"}, {"role": "assistant", "content": "SELECT COUNT(CASE WHEN o.ShippedDate <= o.RequiredDate THEN 1 END) * 100.0 / COUNT(o.OrderID) AS OnTimeDeliveryRate FROM orders o WHERE YEAR(o.OrderDate) = 2023 AND MONTH(o.OrderDate) = 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine the total freight cost for orders shipped to Germany."}, {"role": "assistant", "content": "SELECT SUM(Freight) FROM orders WHERE ShipCountry = 'Germany';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many products have been discontinued?"}, {"role": "assistant", "content": "SELECT COUNT(*) AS DiscontinuedProducts FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customers have placed an order in the past year?"}, {"role": "assistant", "content": "SELECT DISTINCT customers.CustomerID FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID WHERE OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify the products that have never been ordered."}, {"role": "assistant", "content": "SELECT ProductName FROM products p WHERE NOT EXISTS (SELECT 1 FROM [Order Details] od WHERE p.ProductID = od.ProductID);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What are the top 3 cities hosting the most suppliers?"}, {"role": "assistant", "content": "SELECT City, COUNT(SupplierID) AS SupplierCount FROM suppliers GROUP BY City ORDER BY SupplierCount DESC LIMIT 3;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which region has the most employees?"}, {"role": "assistant", "content": "SELECT employees.Region, COUNT(*) AS NumberOfEmployees FROM employees GROUP BY employees.Region ORDER BY NumberOfEmployees DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average order fulfillment time for April 2023."}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(o.ShippedDate, o.OrderDate)) AS AvgFulfillmentTime FROM orders o WHERE YEAR(o.OrderDate) = 2023 AND MONTH(o.OrderDate) = 4;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average quantity ordered per order?"}, {"role": "assistant", "content": "SELECT AVG(Quantity) AS AverageQuantity FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the total sales revenue generated in 2023?"}, {"role": "assistant", "content": "SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average shipping cost per order for the last month?"}, {"role": "assistant", "content": "SELECT AVG(Freight) FROM orders WHERE OrderDate >= DATE_FORMAT(LAST_DAY(CURDATE() - INTERVAL 1 MONTH) + INTERVAL 1 DAY - INTERVAL 1 MONTH, '%Y-%m-%d') AND OrderDate < DATE_FORMAT(LAST_DAY(CURDATE() - INTERVAL 1 MONTH) + INTERVAL 1 DAY, '%Y-%m-%d');"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many employees report to each manager?"}, {"role": "assistant", "content": "SELECT ReportsTo, COUNT(EmployeeID) AS NumOfReports FROM employees WHERE ReportsTo IS NOT NULL GROUP BY ReportsTo;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate the average shipping time across all orders."}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, OrderDate)) AS AverageShippingTime FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which product categories have the highest sales numbers?"}, {"role": "assistant", "content": "SELECT categories.CategoryName, SUM([Order Details].Quantity) AS TotalSold FROM products JOIN categories ON products.CategoryID = categories.CategoryID JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY categories.CategoryName ORDER BY TotalSold DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which suppliers have the most products that are currently discontinued?"}, {"role": "assistant", "content": "SELECT s.CompanyName, COUNT(p.ProductID) AS DiscontinuedCount FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID WHERE p.Discontinued = 1 GROUP BY s.CompanyName ORDER BY DiscontinuedCount DESC"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which shipping method was used the most?"}, {"role": "assistant", "content": "SELECT ShipVia, COUNT(OrderID) AS UsageCount FROM orders GROUP BY ShipVia ORDER BY UsageCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which customers have placed orders with more than five different products?"}, {"role": "assistant", "content": "SELECT c.CustomerID FROM customers c JOIN orders o ON c.CustomerID = o.CustomerID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY c.CustomerID HAVING COUNT(DISTINCT od.ProductID) > 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many distinct products are ordered across all orders?"}, {"role": "assistant", "content": "SELECT COUNT(DISTINCT ProductID) FROM [Order Details];"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the distribution of order quantities?"}, {"role": "assistant", "content": "SELECT Quantity, COUNT(*) AS Frequency FROM [Order Details] GROUP BY Quantity;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine suppliers with the highest number of products in stock."}, {"role": "assistant", "content": "SELECT s.SupplierID, s.CompanyName, COUNT(p.ProductID) AS InStockCount FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID WHERE p.UnitsInStock > 0 GROUP BY s.SupplierID ORDER BY InStockCount DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the overall average lead time for all suppliers?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, OrderDate)) AS OverallAvgLeadTime FROM orders;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total order quantity for products with discounts above 10%?"}, {"role": "assistant", "content": "SELECT SUM(Quantity) AS TotalOrderQuantity FROM [Order Details] WHERE Discount > 0.10;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which month had the highest on-time delivery rate last year?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month FROM orders WHERE ShippedDate <= RequiredDate GROUP BY Month ORDER BY (COUNT(CASE WHEN ShippedDate <= RequiredDate THEN OrderID END) / COUNT(OrderID)) DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the age of each employee as of today?"}, {"role": "assistant", "content": "SELECT E.EmployeeID, E.FirstName, E.LastName, TIMESTAMPDIFF(YEAR, E.BirthDate, CURDATE()) AS Age FROM employees E;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the total freight cost for each employee."}, {"role": "assistant", "content": "SELECT EmployeeID, SUM(Freight) AS TotalFreight FROM orders GROUP BY EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which city has the highest total freight cost?"}, {"role": "assistant", "content": "SELECT ShipCity, SUM(Freight) AS TotalFreight FROM orders GROUP BY ShipCity ORDER BY TotalFreight DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify orders with more than 50 units ordered with a discount applied."}, {"role": "assistant", "content": "SELECT orders.OrderID FROM [Order Details] INNER JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE [Order Details].Quantity > 50 AND [Order Details].Discount > 0;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: How does the average order value vary by employee and month?"}, {"role": "assistant", "content": "SELECT e.EmployeeID, MONTH(o.OrderDate) AS month, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) / COUNT(DISTINCT o.OrderID) AS avg_order_value FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY e.EmployeeID, MONTH(o.OrderDate)"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the name of the shipping recipient with the maximum freight cost?"}, {"role": "assistant", "content": "SELECT ShipName FROM orders ORDER BY Freight DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average shipping cost per order each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(Freight) AS AvgShippingCost FROM orders GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the shortest shipping time for each employee's orders."}, {"role": "assistant", "content": "SELECT employees.EmployeeID, employees.FirstName, employees.LastName, MIN(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS ShortestShippingTime FROM orders INNER JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which country has the most orders placed?"}, {"role": "assistant", "content": "SELECT Country, COUNT(*) AS OrderCount FROM orders JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY Country ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average time suppliers take to deliver products to our warehouse?"}, {"role": "assistant", "content": "SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS avg_lead_time FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.SupplierID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated from each product?"}, {"role": "assistant", "content": "SELECT ProductID, SUM(UnitPrice * Quantity * (1 - Discount)) AS TotalRevenue FROM [Order Details] GROUP BY ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the minimum, maximum, and average unit price of all products?"}, {"role": "assistant", "content": "SELECT MIN(UnitPrice) AS MinPrice, MAX(UnitPrice) AS MaxPrice, AVG(UnitPrice) AS AvgPrice FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products have the highest UnitsInStock to UnitsOnOrder ratio?"}, {"role": "assistant", "content": "SELECT ProductID, ProductName, COALESCE(UnitsInStock / NULLIF(UnitsOnOrder, 0), UnitsInStock) AS StockOrderRatio FROM products ORDER BY StockOrderRatio DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which region has the highest sales revenue, and which employees contributed to it?"}, {"role": "assistant", "content": "SELECT employees.Region, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS RegionSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY employees.Region ORDER BY RegionSales DESC LIMIT 1"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were delivered on time each month?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, COUNT(OrderID) AS OnTimeOrders FROM orders WHERE ShippedDate <= RequiredDate GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the top 5 cities by number of orders placed."}, {"role": "assistant", "content": "SELECT ShipCity, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipCity ORDER BY OrderCount DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify orders where the shipping cost was above the overall average."}, {"role": "assistant", "content": "SELECT * FROM orders WHERE Freight > (SELECT AVG(Freight) FROM orders);"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the top 5 customers based on the total number of orders."}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(*) AS TotalOrders FROM orders GROUP BY CustomerID ORDER BY TotalOrders DESC LIMIT 5;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee generated the highest sales in the last month?"}, {"role": "assistant", "content": "SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM employees JOIN orders ON employees.EmployeeID = orders.EmployeeID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID WHERE OrderDate >= DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 1 MONTH), 'YYYY-MM-01') AND OrderDate < DATE_FORMAT(CURDATE(), 'YYYY-MM-01') GROUP BY employees.EmployeeID ORDER BY TotalSales DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which products are most frequently ordered?"}, {"role": "assistant", "content": "SELECT [Order Details].ProductID, COUNT([Order Details].ProductID) AS Frequency FROM [Order Details] GROUP BY [Order Details].ProductID ORDER BY Frequency DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many suppliers provide more than 10 products?"}, {"role": "assistant", "content": "SELECT SupplierID, COUNT(ProductID) AS ProductCount FROM products GROUP BY SupplierID HAVING ProductCount > 10;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the variance in units in stock for each product category?"}, {"role": "assistant", "content": "SELECT p.CategoryID, VARIANCE(p.UnitsInStock) AS StockVariance FROM products p GROUP BY p.CategoryID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: Which territories have the highest employee sales and customer retention rates?"}, {"role": "assistant", "content": "SELECT territories.TerritoryID, COALESCE(SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)), 0) AS total_sales, (COUNT(DISTINCT orders.CustomerID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') * 100.0 / NULLIF(COUNT(DISTINCT orders.CustomerID WHERE orders.OrderDate < '2023-01-01'), 0)) AS customer_retention_rate FROM employeeTerritories et JOIN employees ON et.EmployeeID = employees.EmployeeID JOIN orders ON orders.EmployeeID = employees.EmployeeID JOIN territories ON et.TerritoryID = territories.TerritoryID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY territories.TerritoryID"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the average order size for each shipping method."}, {"role": "assistant", "content": "SELECT ShipVia, AVG(od.UnitPrice * od.Quantity) AS AverageOrderSize FROM orders o JOIN [Order Details] od ON o.OrderID = od.OrderID GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated by each customer?"}, {"role": "assistant", "content": "SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalRevenue FROM customers JOIN orders ON customers.CustomerID = orders.CustomerID JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY customers.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were shipped to 'Seattle' in 2023?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM orders WHERE ShipCity = 'Seattle' AND OrderDate BETWEEN '2023-01-01' AND '2023-12-31';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average shipping cost per month for the past year?"}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS Month, AVG(Freight) AS AvgShippingCost FROM orders WHERE OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average salary by job title?"}, {"role": "assistant", "content": "SELECT Title, AVG(Salary) AS AverageSalary FROM employees GROUP BY Title;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What products have the highest number of orders?"}, {"role": "assistant", "content": "SELECT ProductID, COUNT([Order Details].OrderID) AS OrderCount FROM [Order Details] GROUP BY ProductID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Determine customers who have not placed any orders in the last year."}, {"role": "assistant", "content": "SELECT customers.CustomerID FROM customers LEFT JOIN orders ON customers.CustomerID = orders.CustomerID WHERE orders.OrderDate IS NULL OR OrderDate < '2022-01-01';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Customer Analysis\",\n        \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n    },\n    \"tables\": {\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employees have handled the most orders?"}, {"role": "assistant", "content": "SELECT o.EmployeeID, COUNT(o.OrderID) AS TotalOrders FROM orders o GROUP BY o.EmployeeID ORDER BY TotalOrders DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average discount given in August 2023?"}, {"role": "assistant", "content": "SELECT AVG([Order Details].Discount) AS AvgDiscount FROM [Order Details] JOIN orders ON orders.OrderID = [Order Details].OrderID WHERE DATE_FORMAT(orders.OrderDate, '%Y-%m') = '2023-08';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Product Analysis\",\n        \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue for each product?"}, {"role": "assistant", "content": "SELECT products.ProductID, SUM([Order Details].Quantity * [Order Details].UnitPrice) AS TotalRevenue FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY products.ProductID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: For the last month, which product had the highest sales revenue?"}, {"role": "assistant", "content": "SELECT TOP 1 products.ProductID, products.ProductName, SUM([Order Details].Quantity * [Order Details].UnitPrice) AS SalesRevenue FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate >= DATEADD(MONTH, -1, GETDATE()) GROUP BY products.ProductID, products.ProductName ORDER BY SalesRevenue DESC;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were placed by each customer in the last quarter?"}, {"role": "assistant", "content": "SELECT orders.CustomerID, COUNT(orders.OrderID) AS OrderCount FROM orders WHERE QUARTER(orders.OrderDate) = QUARTER(CURDATE()) - 1 AND YEAR(orders.OrderDate) = YEAR(CURDATE()) GROUP BY orders.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: List all orders that include a discount on any product."}, {"role": "assistant", "content": "SELECT DISTINCT OrderID FROM [Order Details] WHERE Discount > 0;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee has processed the most orders?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(OrderID) AS OrderCount FROM orders GROUP BY EmployeeID ORDER BY OrderCount DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many products are currently discontinued?"}, {"role": "assistant", "content": "SELECT COUNT(*) FROM products WHERE Discontinued = 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which employee has the best on-time delivery rate?"}, {"role": "assistant", "content": "SELECT EmployeeID, COUNT(CASE WHEN ShippedDate <= RequiredDate THEN 1 END) / COUNT(OrderID) AS OnTimeDeliveryRate FROM orders GROUP BY EmployeeID ORDER BY OnTimeDeliveryRate DESC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the employees with sales over $10,000 in this quarter."}, {"role": "assistant", "content": "SELECT e.EmployeeID FROM employees e JOIN orders o ON e.EmployeeID = o.EmployeeID JOIN [Order Details] od ON o.OrderID = od.OrderID WHERE QUARTER(o.OrderDate) = QUARTER(CURDATE()) GROUP BY e.EmployeeID HAVING SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) > 10000;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the products with the lowest inventory turnover ratio."}, {"role": "assistant", "content": "SELECT ProductID, SUM([Order Details].Quantity * [Order Details].UnitPrice) / NULLIF(AVG(products.UnitsInStock), 0) AS TurnoverRatio FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID GROUP BY ProductID ORDER BY TurnoverRatio ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total number of units in stock for all products?"}, {"role": "assistant", "content": "SELECT SUM(UnitsInStock) FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Employee Performance\",\n        \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n    },\n    \"tables\": {\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the employee with the longest tenure in the company."}, {"role": "assistant", "content": "SELECT EmployeeID, FirstName, LastName, HireDate FROM employees ORDER BY HireDate ASC LIMIT 1;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total revenue generated by each supplier over the past year?"}, {"role": "assistant", "content": "SELECT s.SupplierID, s.CompanyName, SUM(od.UnitPrice * od.Quantity * (1 - od.Discount)) AS TotalRevenue FROM suppliers s JOIN products p ON s.SupplierID = p.SupplierID JOIN [Order Details] od ON p.ProductID = od.ProductID JOIN orders o ON od.OrderID = o.OrderID WHERE o.OrderDate >= DATE_SUB(CURDATE(), INTERVAL 1 YEAR) GROUP BY s.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"business_scenarios\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"description\": \"Understanding customer demographics, purchasing patterns, and customer satisfaction.\"\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"description\": \"Analyzing product performance, inventory levels, and supplier efficiency.\"\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"description\": \"Evaluating employee performance, sales territories, and employee impact on sales.\"\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n        }\n    ],\n    \"business_metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Lifetime Value\",\n            \"description\": \"Total revenue generated from a customer over time.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY customers.CustomerID\",\n            \"tables\": [\n                \"customers\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"lifetime\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Employee Sales\",\n            \"description\": \"Total sales generated by each employee.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) GROUP BY employees.EmployeeID\",\n            \"tables\": [\n                \"employees\",\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Customer Retention Rate\",\n            \"description\": \"Percentage of returning customers over a period.\",\n            \"formula\": \"(COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate BETWEEN 'start_date' AND 'end_date') / (COUNT(DISTINCT orders.CustomerID) WHERE orders.OrderDate < 'start_date')\",\n            \"tables\": [\n                \"customers\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ],\n    \"example_queries\": [\n        {\n            \"metric\": \"Total Sales\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS total_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Average Order Value\",\n            \"query\": \"SELECT SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID) AS avg_order_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'\"\n        },\n        {\n            \"metric\": \"Customer Lifetime Value\",\n            \"query\": \"SELECT customers.CustomerID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS customer_lifetime_value FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN customers ON orders.CustomerID = customers.CustomerID GROUP BY customers.CustomerID\"\n        },\n        {\n            \"metric\": \"Product Performance\",\n            \"query\": \"SELECT products.ProductID, SUM([Order Details].Quantity) AS product_performance FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID GROUP BY products.ProductID\"\n        },\n        {\n            \"metric\": \"Employee Sales\",\n            \"query\": \"SELECT employees.EmployeeID, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS employee_sales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID JOIN employees ON orders.EmployeeID = employees.EmployeeID GROUP BY employees.EmployeeID\"\n        },\n        {\n            \"metric\": \"Order Fulfillment Time\",\n            \"query\": \"SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders\"\n        },\n        {\n            \"metric\": \"Customer Retention Rate\",\n            \"query\": \"(SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31') / (SELECT COUNT(DISTINCT orders.CustomerID) FROM orders WHERE orders.OrderDate < '2023-01-01') AS customer_retention_rate\"\n        },\n        {\n            \"metric\": \"Supplier Lead Time\",\n            \"query\": \"SELECT products.SupplierID, AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS supplier_lead_time FROM orders JOIN products ON orders.OrderID = products.ProductID GROUP BY products.SupplierID\"\n        },\n        {\n            \"metric\": \"Inventory Turnover Ratio\",\n            \"query\": \"SELECT SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock) AS inventory_turnover_ratio FROM [Order Details] JOIN products ON [Order Details].ProductID = products.ProductID\"\n        },\n        {\n            \"metric\": \"Shipping Cost per Order\",\n            \"query\": \"SELECT AVG(orders.Freight) AS shipping_cost_per_order FROM orders\"\n        },\n        {\n            \"metric\": \"On-time Delivery Rate\",\n            \"query\": \"SELECT COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID) AS on_time_delivery_rate FROM orders\"\n        }\n    ],\n    \"scenario_metric_mapping\": [\n        {\n            \"scenario\": \"Order Analysis\",\n            \"metrics\": [\n                \"Total Sales\",\n                \"Average Order Value\",\n                \"Order Fulfillment Time\",\n                \"On-time Delivery Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Customer Analysis\",\n            \"metrics\": [\n                \"Customer Lifetime Value\",\n                \"Customer Retention Rate\"\n            ]\n        },\n        {\n            \"scenario\": \"Product Analysis\",\n            \"metrics\": [\n                \"Product Performance\",\n                \"Inventory Turnover Ratio\"\n            ]\n        },\n        {\n            \"scenario\": \"Employee Performance\",\n            \"metrics\": [\n                \"Employee Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Supplier Analysis\",\n            \"metrics\": [\n                \"Supplier Lead Time\",\n                \"Total Sales\"\n            ]\n        },\n        {\n            \"scenario\": \"Shipping Analysis\",\n            \"metrics\": [\n                \"Shipping Cost per Order\",\n                \"On-time Delivery Rate\",\n                \"Order Fulfillment Time\"\n            ]\n        },\n        {\n            \"scenario\": \"Inventory Management\",\n            \"metrics\": [\n                \"Inventory Turnover Ratio\",\n                \"Product Performance\"\n            ]\n        }\n    ],\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"customers\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the customer.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the customer.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the customer.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the customer.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the customer.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the customer.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the customer.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"employees\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for employees table.\"\n                },\n                \"LastName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Last name of the employee.\"\n                },\n                \"FirstName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"First name of the employee.\"\n                },\n                \"Title\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the employee.\"\n                },\n                \"TitleOfCourtesy\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Courtesy title of the employee.\"\n                },\n                \"BirthDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Birth date of the employee.\"\n                },\n                \"HireDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Hire date of the employee.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the employee.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the employee.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the employee.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the employee.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the employee.\"\n                },\n                \"HomePhone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Home phone of the employee.\"\n                },\n                \"Extension\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Extension number of the employee.\"\n                },\n                \"Photo\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Photo of the employee.\"\n                },\n                \"Notes\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Notes about the employee.\"\n                },\n                \"ReportsTo\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Employee ID of the manager.\"\n                },\n                \"PhotoPath\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Path to the photo of the employee.\"\n                },\n                \"Salary\": {\n                    \"type\": \"FLOAT\",\n                    \"description\": \"Salary of the employee.\"\n                }\n            }\n        },\n        \"shippers\": {\n            \"columns\": {\n                \"ShipperID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for shippers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping company.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the shipping company.\"\n                }\n            }\n        },\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"categories\": {\n            \"columns\": {\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for categories table.\"\n                },\n                \"CategoryName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the category.\"\n                },\n                \"Description\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the category.\"\n                },\n                \"Picture\": {\n                    \"type\": \"LONGBLOB\",\n                    \"description\": \"Picture of the category.\"\n                }\n            }\n        },\n        \"territories\": {\n            \"columns\": {\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for territories table.\"\n                },\n                \"TerritoryDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the territory.\"\n                },\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to region table.\"\n                }\n            }\n        },\n        \"employeeTerritories\": {\n            \"columns\": {\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"TerritoryID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to territories table.\"\n                }\n            }\n        },\n        \"region\": {\n            \"columns\": {\n                \"RegionID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for region table.\"\n                },\n                \"RegionDescription\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Description of the region.\"\n                }\n            }\n        },\n        \"customerDemographics\": {\n            \"columns\": {\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Primary key for customer demographics table.\"\n                },\n                \"CustomerDesc\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Description of the customer type.\"\n                }\n            }\n        },\n        \"customerCustomerDemo\": {\n            \"columns\": {\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"CustomerTypeID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customer demographics table.\"\n                }\n            }\n        }\n    }\n}\n\n## Question: What is the average order fulfillment time in 2023?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) AS order_fulfillment_time FROM orders WHERE orders.OrderDate BETWEEN '2023-01-01' AND '2023-12-31'"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the difference between units in stock and reorder level for each product?"}, {"role": "assistant", "content": "SELECT ProductName, (UnitsInStock - ReorderLevel) AS Difference FROM products;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders include products from a specific supplier?"}, {"role": "assistant", "content": "SELECT products.SupplierID, COUNT(DISTINCT orders.OrderID) AS OrderCount FROM products JOIN [Order Details] ON products.ProductID = [Order Details].ProductID JOIN orders ON [Order Details].OrderID = orders.OrderID GROUP BY products.SupplierID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average shipping time for orders shipped to European countries?"}, {"role": "assistant", "content": "SELECT AVG(DATEDIFF(ShippedDate, OrderDate)) AS avg_shipping_time FROM orders WHERE ShipRegion = 'Europe';"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the total number of orders placed by each customer?"}, {"role": "assistant", "content": "SELECT CustomerID, COUNT(OrderID) AS TotalOrders FROM orders GROUP BY CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Calculate total sales revenue for each month."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(orders.OrderDate, '%Y-%m') AS Month, SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) AS TotalSales FROM orders JOIN [Order Details] ON orders.OrderID = [Order Details].OrderID GROUP BY Month;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the distribution of orders by shipping country?"}, {"role": "assistant", "content": "SELECT ShipCountry, COUNT(OrderID) AS OrderCount FROM orders GROUP BY ShipCountry;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Inventory Management\",\n        \"description\": \"Managing inventory levels, reorder points, and stock optimization.\"\n    },\n    \"tables\": {\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Inventory Turnover Ratio\",\n            \"description\": \"Ratio of cost of goods sold to average inventory.\",\n            \"formula\": \"SUM([Order Details].Quantity * [Order Details].UnitPrice) / AVG(products.UnitsInStock)\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Product Performance\",\n            \"description\": \"Performance of products based on sales and inventory levels.\",\n            \"formula\": \"SUM([Order Details].Quantity) GROUP BY products.ProductID\",\n            \"tables\": [\n                \"products\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Identify trends in sales for the top performing product over the past six months."}, {"role": "assistant", "content": "SELECT DATE_FORMAT(OrderDate, '%Y-%m') AS OrderMonth, SUM([Order Details].Quantity) AS TotalSales FROM [Order Details] JOIN orders ON [Order Details].OrderID = orders.OrderID WHERE ProductID = (SELECT ProductID FROM [Order Details] GROUP BY ProductID ORDER BY SUM(Quantity) DESC LIMIT 1) GROUP BY OrderMonth ORDER BY OrderMonth;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Shipping Analysis\",\n        \"description\": \"Analyzing shipping times, costs, and shipping company performance.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Shipping Cost per Order\",\n            \"description\": \"Average shipping cost per order.\",\n            \"formula\": \"AVG(orders.Freight)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Which orders have a freight cost above $100?"}, {"role": "assistant", "content": "SELECT * FROM orders WHERE Freight > 100;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: Find the total freight cost for each shipping method in 2023."}, {"role": "assistant", "content": "SELECT ShipVia, SUM(Freight) AS TotalFreight FROM orders WHERE YEAR(OrderDate) = 2023 GROUP BY ShipVia;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Order Analysis\",\n        \"description\": \"Analyzing orders placed by customers to understand sales trends, order fulfillment, and customer behavior.\"\n    },\n    \"tables\": {\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Average Order Value\",\n            \"description\": \"Average value of an order placed by customers.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount)) / COUNT(DISTINCT orders.OrderID)\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Order Fulfillment Time\",\n            \"description\": \"Average time taken to fulfill an order.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate))\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"On-time Delivery Rate\",\n            \"description\": \"Percentage of orders delivered on or before the required date.\",\n            \"formula\": \"COUNT(orders.OrderID WHERE orders.ShippedDate <= orders.RequiredDate) / COUNT(orders.OrderID)\",\n            \"tables\": [\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: How many orders were placed by each customer last quarter?"}, {"role": "assistant", "content": "SELECT O.CustomerID, COUNT(O.OrderID) AS OrderCount FROM orders O WHERE O.OrderDate >= DATE_SUB(CURRENT_DATE, INTERVAL 3 MONTH) AND O.OrderDate < CURRENT_DATE GROUP BY O.CustomerID;"}]}
{"messages": [{"role": "system", "content": "You are querying the MDDX database, what is the SQL query for the following question?"}, {"role": "user", "content": "## Database Schema and Business Metrics Definitions\n{\n    \"date_format\": \"YYYY-MM-DD\",\n    \"scenario\": {\n        \"scenario\": \"Supplier Analysis\",\n        \"description\": \"Evaluating supplier performance, delivery times, and quality of supplied products.\"\n    },\n    \"tables\": {\n        \"suppliers\": {\n            \"columns\": {\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for suppliers table.\"\n                },\n                \"CompanyName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the supplier company.\"\n                },\n                \"ContactName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the contact person.\"\n                },\n                \"ContactTitle\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Title of the contact person.\"\n                },\n                \"Address\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the supplier.\"\n                },\n                \"City\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the supplier.\"\n                },\n                \"Region\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the supplier.\"\n                },\n                \"PostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the supplier.\"\n                },\n                \"Country\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the supplier.\"\n                },\n                \"Phone\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Phone number of the supplier.\"\n                },\n                \"Fax\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Fax number of the supplier.\"\n                },\n                \"HomePage\": {\n                    \"type\": \"MEDIUMTEXT\",\n                    \"description\": \"Homepage of the supplier.\"\n                }\n            }\n        },\n        \"products\": {\n            \"columns\": {\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for products table.\"\n                },\n                \"ProductName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the product.\"\n                },\n                \"SupplierID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to suppliers table.\"\n                },\n                \"CategoryID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to categories table.\"\n                },\n                \"QuantityPerUnit\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Quantity per unit of the product.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"UnitsInStock\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product in stock.\"\n                },\n                \"UnitsOnOrder\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Units of the product on order.\"\n                },\n                \"ReorderLevel\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Reorder level for the product.\"\n                },\n                \"Discontinued\": {\n                    \"type\": \"BIT\",\n                    \"description\": \"Whether the product is discontinued.\"\n                }\n            }\n        },\n        \"orders\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Primary key for orders table.\"\n                },\n                \"CustomerID\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Foreign key to customers table.\"\n                },\n                \"EmployeeID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to employees table.\"\n                },\n                \"OrderDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was placed.\"\n                },\n                \"RequiredDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date by which the order is required.\"\n                },\n                \"ShippedDate\": {\n                    \"type\": \"DATE\",\n                    \"description\": \"Date when the order was shipped.\"\n                },\n                \"ShipVia\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Shipping method.\"\n                },\n                \"Freight\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Freight cost.\"\n                },\n                \"ShipName\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Name of the shipping recipient.\"\n                },\n                \"ShipAddress\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Address of the shipping recipient.\"\n                },\n                \"ShipCity\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"City of the shipping recipient.\"\n                },\n                \"ShipRegion\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Region of the shipping recipient.\"\n                },\n                \"ShipPostalCode\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Postal code of the shipping recipient.\"\n                },\n                \"ShipCountry\": {\n                    \"type\": \"VARCHAR\",\n                    \"description\": \"Country of the shipping recipient.\"\n                }\n            }\n        },\n        \"[Order Details]\": {\n            \"columns\": {\n                \"OrderID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to orders table.\"\n                },\n                \"ProductID\": {\n                    \"type\": \"INT\",\n                    \"description\": \"Foreign key to products table.\"\n                },\n                \"UnitPrice\": {\n                    \"type\": \"DECIMAL\",\n                    \"description\": \"Price per unit of the product.\"\n                },\n                \"Quantity\": {\n                    \"type\": \"SMALLINT\",\n                    \"description\": \"Quantity of the product ordered.\"\n                },\n                \"Discount\": {\n                    \"type\": \"DOUBLE\",\n                    \"description\": \"Discount applied to the product.\"\n                }\n            }\n        }\n    },\n    \"metrics\": [\n        {\n            \"name\": \"Supplier Lead Time\",\n            \"description\": \"Average time taken by suppliers to deliver products.\",\n            \"formula\": \"AVG(DATEDIFF(orders.ShippedDate, orders.OrderDate)) GROUP BY products.SupplierID\",\n            \"tables\": [\n                \"suppliers\",\n                \"products\",\n                \"orders\"\n            ],\n            \"granularity\": \"monthly\"\n        },\n        {\n            \"name\": \"Total Sales\",\n            \"description\": \"Total revenue generated from orders.\",\n            \"formula\": \"SUM([Order Details].UnitPrice * [Order Details].Quantity * (1 - [Order Details].Discount))\",\n            \"tables\": [\n                \"orders\",\n                \"[Order Details]\"\n            ],\n            \"granularity\": \"monthly\"\n        }\n    ]\n}\n\n## Question: What is the average number of units ordered per product?"}, {"role": "assistant", "content": "SELECT AVG(od.Quantity) FROM [Order Details] od;"}]}
